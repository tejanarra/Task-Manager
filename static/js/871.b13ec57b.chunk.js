"use strict";(self.webpackChunktask_manager_frontend=self.webpackChunktask_manager_frontend||[]).push([[871],{869:(e,t,s)=>{s.d(t,{A:()=>n});s(43),s(421);var a=s(579);const n=e=>{let{theme:t,show:s,title:n="Confirm Action",message:r="Are you sure you want to proceed?",onConfirm:i,onCancel:l}=e;return s?(0,a.jsx)("div",{className:"custom-modal-overlay d-flex align-items-center justify-content-center",tabIndex:"-1",role:"dialog",onClick:l,children:(0,a.jsxs)("div",{className:"custom-modal-content",role:"document",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"custom-modal-header",children:[(0,a.jsx)("h5",{className:"modal2-title fw-bold",children:n}),(0,a.jsx)("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:l})]}),(0,a.jsx)("div",{className:"custom-modal-body",children:(0,a.jsx)("p",{className:"text-".concat("dark"===t?"light":"muted"," mb-4"),children:r})}),(0,a.jsxs)("div",{className:"custom-modal-footer d-flex justify-content-end gap-2",children:[(0,a.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:l,children:"Cancel"}),(0,a.jsx)("button",{type:"button",className:"btn sign-in-btn",onClick:i,children:"Confirm"})]})]})}):null}},871:(e,t,s)=>{s.r(t),s.d(t,{default:()=>T});var a=s(555),n=s(43),r=s(505),i=s(729),l=(s(421),s(869)),o=s(579);const c=e=>{let{checked:t,onChange:s,label:a}=e;return(0,o.jsxs)("label",{className:"reminder-checkbox-label d-inline-flex align-items-center",children:[(0,o.jsx)("input",{type:"checkbox",className:"form-check-input me-2",checked:t,onChange:e=>s(e.target.checked)}),(0,o.jsx)("span",{children:a})]})};var d=s(291);const m=e=>"daily"===(null===e||void 0===e?void 0:e.type)||"DAILY"===(null===e||void 0===e?void 0:e.type),u=e=>"weekly"===(null===e||void 0===e?void 0:e.type)||"WEEKLY"===(null===e||void 0===e?void 0:e.type),h=e=>{if(e<1)return"".concat(Math.round(60*e)," min");if(e<24)return"".concat(e," hr").concat(1!==e?"s":"");const t=e/24;return t<7?"".concat(Math.round(t)," day").concat(1!==t?"s":""):"".concat(Math.round(t/7)," week").concat(t/7!==1?"s":"")},p=e=>{const[t]=e.split(":");return Math.min(Math.max(parseInt(t),0),23)},g=e=>{const t=new Date;return t.setHours(e,0,0,0),t.getUTCHours()},x=(e,t)=>{const s=new Date,a=(e-s.getDay()+7)%7,n=new Date(s);return n.setDate(s.getDate()+a),n.setHours(t,0,0,0),{utcDay:n.getUTCDay(),utcHour:n.getUTCHours()}},f=(e,t)=>{const s=new Date(Date.UTC(2e3,0,2+e,t));return{localDay:s.getDay(),localHour:s.getHours()}},b=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],j=e=>{let{tempDeadline:t,tempReminders:s,setTempReminders:r,theme:i,ALL_INTERVALS:l}=e;const j=t?new Date(t):null,v=new Date,y=j?(j-v)/36e5:0,k=Math.floor(y/24),N=Math.floor(y/168),C=(0,n.useMemo)((()=>s.find(m)),[s]),w=(0,n.useMemo)((()=>s.find(u)),[s]),D=!!C,T=!!w,[S,A]=(0,n.useState)(null!=(null===C||void 0===C?void 0:C.hourOfDayUTC)?(e=>{const t=new Date(Date.UTC(2e3,0,1,e,0,0)).getHours();return"".concat(String(t).padStart(2,"0"),":00")})(C.hourOfDayUTC):"09:00"),[O,U]=(0,n.useState)((()=>null!=(null===w||void 0===w?void 0:w.dayOfWeek)?f(w.dayOfWeek,w.hourOfDayUTC).localDay:1)),[I,E]=(0,n.useState)((()=>null!=(null===w||void 0===w?void 0:w.hourOfDayUTC)?"".concat(String(f(w.dayOfWeek,w.hourOfDayUTC).localHour).padStart(2,"0"),":00"):"09:00")),M=(e,t)=>{r((s=>{if(!t)return s.filter((t=>u(t)||m(t)||Math.abs(t.remindBefore-e)>=.01));return s.some((t=>!t.type&&Math.abs(t.remindBefore-e)<.01))?s:[...s,{remindBefore:e,sent:!1}]}))},[L,P]=(0,n.useState)(""),R=l.filter((e=>e.value<=y)),W=s.filter((e=>!m(e)&&!u(e)&&e.remindBefore<=y&&!l.some((t=>Math.abs(t.value-e.remindBefore)<.01)))).map((e=>({value:e.remindBefore,label:e.customDate?new Date(e.customDate).toLocaleString():h(e.remindBefore)}))),[B,q]=(0,n.useState)(!1);return(0,o.jsxs)("div",{className:"task-reminders-container",children:[(0,o.jsx)("div",{className:"reminders-dropdown",onClick:()=>q(!B),children:(0,o.jsxs)("div",{className:"reminders-dropdown-header",children:[(0,o.jsx)("h6",{children:"Reminders"}),(0,o.jsx)("i",{className:"bi ".concat(B?"bi-chevron-up":"bi-chevron-down")})]})}),B&&(0,o.jsxs)("div",{className:"reminders-dropdown-content",children:[(0,o.jsxs)("div",{className:"custom-reminder-section",children:[(0,o.jsx)("label",{className:"reminder-section-label",children:"Add Custom Reminder:"}),(0,o.jsxs)("div",{className:"custom-reminder-input-group",children:[(0,o.jsx)("input",{type:"datetime-local",value:L,onChange:e=>P(e.target.value),min:(0,d.wM)((new Date).toISOString()),max:t?(0,d.wM)(t):void 0}),(0,o.jsx)("button",{className:"btn btn-sm ".concat("dark"===i?"btn-outline-light":"btn-outline-dark"),onClick:()=>{if(!L||!j)return;const e=new Date(L);if(e>=j)return;const t=(j-e)/36e5;t<=0||t>y||(r((s=>[...s,{remindBefore:t,customDate:e.toISOString()}])),P(""))},children:"Add"})]})]}),(k>0||N>0)&&(0,o.jsxs)("div",{className:"recurring-reminders-section",children:[(0,o.jsx)("label",{className:"reminder-section-label",children:"Recurring Reminders:"}),(0,o.jsxs)("div",{className:"recurring-option",children:[(0,o.jsx)("input",{type:"checkbox",checked:D,onChange:e=>{return t=e.target.checked,void r((e=>{const s=e.filter((e=>!m(e)));if(!t)return s;const a=p(S);return[...s,{type:"daily",hourOfDayUTC:g(a)}]}));var t}}),(0,o.jsx)("span",{className:"ms-2",children:"Daily at"}),(0,o.jsx)("input",{type:"time",value:S,step:3600,disabled:!D,onChange:e=>(e=>{A(e);const t=p(e);r((e=>e.map((e=>m(e)?(0,a.A)((0,a.A)({},e),{},{hourOfDayUTC:g(t)}):e))))})(e.target.value),className:"ms-2"})]}),(0,o.jsxs)("div",{className:"recurring-option mt-2",children:[(0,o.jsx)("input",{type:"checkbox",checked:T,onChange:e=>{return t=e.target.checked,void r((e=>{const s=e.filter((e=>!u(e)));if(!t)return s;const a=p(I),{utcDay:n,utcHour:r}=x(O,a);return[...s,{type:"weekly",dayOfWeek:n,hourOfDayUTC:r}]}));var t}}),(0,o.jsx)("span",{className:"ms-2",children:"Weekly on"}),(0,o.jsx)("select",{value:O,disabled:!T,className:"mx-2",onChange:e=>(e=>{const t=Number(e);U(t),r((e=>e.map((e=>u(e)?(0,a.A)((0,a.A)({},e),x(t,p(I))):e))))})(e.target.value),children:b.map(((e,t)=>(0,o.jsx)("option",{value:t,children:e},t)))}),(0,o.jsx)("input",{type:"time",value:I,step:3600,disabled:!T,onChange:e=>{return t=e.target.value,E(t),void r((e=>e.map((e=>u(e)?(0,a.A)((0,a.A)({},e),x(O,p(t))):e))));var t}})]})]}),R.length>0&&(0,o.jsxs)("div",{className:"reminder-section",children:[(0,o.jsx)("label",{className:"reminder-section-label",children:"One-time Presets:"}),(0,o.jsx)("div",{className:"reminder-grid",children:R.map((e=>(0,o.jsx)(c,{checked:!!s.find((t=>!t.type&&Math.abs(t.remindBefore-e.value)<.01)),label:e.label,onChange:t=>M(e.value,t)},e.value)))})]}),W.length>0&&(0,o.jsxs)("div",{className:"reminder-section",children:[(0,o.jsx)("label",{className:"reminder-section-label",children:"Custom:"}),(0,o.jsx)("div",{className:"reminder-grid",children:W.map((e=>(0,o.jsx)(c,{checked:!0,label:e.label,onChange:t=>M(e.value,t)},e.value)))})]})]})]})},v=[{value:1,label:"1 hr"},{value:24,label:"1 day"},{value:168,label:"1 week"}],y=e=>{switch(e){case"in-progress":return"IN_PROGRESS";case"completed":return"COMPLETED";default:return"NOT_STARTED"}},k=e=>{let{theme:t,task:s,setTasks:i,isNewTask:c,onSave:m,onCancel:u}=e;const[h,p]=(0,n.useState)(c),[g,x]=(0,n.useState)(!1),[f,b]=(0,n.useState)(!1),[k,N]=(0,n.useState)(s.title),[C,w]=(0,n.useState)(s.description),[D,T]=(0,n.useState)(s.status||"not-started"),[S,A]=(0,n.useState)(s.deadlineUTC||null),[O,U]=(0,n.useState)(Array.isArray(s.reminders)?s.reminders:[]),I=(0,n.useRef)(null),E=(0,n.useCallback)((()=>{N(s.title),w(s.description),T(s.status||"not-started"),A(s.deadlineUTC||null),U(Array.isArray(s.reminders)?s.reminders:[]),c?u(s.id):p(!1)}),[s,c,u]);(0,n.useEffect)((()=>{const e=e=>{h&&!c&&I.current&&!I.current.contains(e.target)&&E()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[h,E,c]);const M="completed"===D?"#007a00":"in-progress"===D?"#daa520":"#a00000",L=S&&new Date(S)>new Date,P=(()=>{if(null===O||void 0===O||!O.length)return null;const e=O.filter((e=>"daily"===e.type)).length,t=O.filter((e=>"weekly"===e.type)).length,s=O.filter((e=>!e.type)).length;return[e>0?"Daily (".concat(e,")"):null,t>0?"Weekly (".concat(t,")"):null,s>0?"One-time (".concat(s,")"):null].filter(Boolean).join(", ")})(),R=async()=>{if(!k.trim()||!C.trim())return;x(!0);const e=S?new Date(S).toISOString():null,t={title:k.trim(),description:C.trim(),status:y(D),deadlineUTC:e},n=e?((e,t)=>{const s=t?new Date(t):null;if(!s)return[];const a=[];return e.forEach((e=>{if("daily"!==e.type)if("weekly"!==e.type)if("number"!==typeof e.remindBefore)e.customDate&&a.push({type:"ONE_TIME",triggerAtUTC:new Date(e.customDate).toISOString(),hourOfDayUTC:null,dayOfWeek:null});else{const t=s.getTime()-3600*e.remindBefore*1e3;a.push({type:"ONE_TIME",triggerAtUTC:new Date(t).toISOString(),hourOfDayUTC:null,dayOfWeek:null})}else a.push({type:"WEEKLY",triggerAtUTC:null,hourOfDayUTC:e.hourOfDayUTC,dayOfWeek:e.dayOfWeek});else a.push({type:"DAILY",triggerAtUTC:null,hourOfDayUTC:e.hourOfDayUTC,dayOfWeek:null})})),a})(O,e):[];try{if(c)m((0,a.A)((0,a.A)((0,a.A)({},s),t),{},{reminders:n})),p(!1);else{const e=await(0,r.lC)(s.id,t);await(0,r.eY)(s.id,n);const l=(0,a.A)((0,a.A)({},e.data),{},{reminders:n});i((e=>e.map((e=>e.id===s.id?l:e)))),p(!1)}}catch(l){console.error("Task update failed",l)}finally{x(!1)}};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{ref:I,className:"task-card ".concat("dark"===t?"dark-mode":""," ").concat(g?"loading":""," ").concat(c?"new-task":""),onClick:()=>!h&&p(!0),children:[(0,o.jsx)("div",{className:"task-strip",style:{backgroundColor:M}}),(0,o.jsxs)("div",{className:"task-card-content",children:[!h&&(0,o.jsx)("i",{className:"bi ".concat("completed"===D?"bi-check-circle":"in-progress"===D?"bi-hourglass":"bi-ban"," status-icon"),style:{color:M}}),h?(0,o.jsxs)("div",{className:"task-form-grid",children:[(0,o.jsxs)("div",{className:"task-form-group full-width",children:[(0,o.jsx)("label",{className:"form-label",children:"Title"}),(0,o.jsx)("input",{value:k,onChange:e=>N(e.target.value),className:"form-control"})]}),(0,o.jsxs)("div",{className:"task-form-group full-width",children:[(0,o.jsx)("label",{className:"form-label",children:"Description"}),(0,o.jsx)("textarea",{rows:3,value:C,onChange:e=>w(e.target.value),className:"form-control"})]}),(0,o.jsxs)("div",{className:"task-form-group",children:[(0,o.jsx)("label",{className:"form-label",children:"Status"}),(0,o.jsxs)("select",{className:"form-select",value:D,onChange:e=>T(e.target.value),children:[(0,o.jsx)("option",{value:"not-started",children:"Not Started"}),(0,o.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,o.jsx)("option",{value:"completed",children:"Completed"})]})]}),(0,o.jsxs)("div",{className:"task-form-group",children:[(0,o.jsx)("label",{className:"form-label",children:"Deadline"}),(0,o.jsx)("input",{type:"datetime-local",value:S?(0,d.wM)(S):"",onChange:e=>A(e.target.value),className:"form-control"})]}),L&&(0,o.jsx)("div",{className:"task-form-group full-width",children:(0,o.jsx)(j,{tempDeadline:S,tempReminders:O,setTempReminders:U,theme:t,ALL_INTERVALS:v})})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h5",{className:"task-title",style:{color:M},children:k}),(0,o.jsx)("p",{className:"task-description",children:C})]}),(0,o.jsxs)("div",{className:"task-metadata",children:[(0,o.jsxs)("div",{className:"task-metadata-item",children:[(0,o.jsx)("strong",{children:"Created"}),(0,o.jsx)("span",{children:(0,d.fw)(s.createdAt)})]}),(0,o.jsxs)("div",{className:"task-metadata-item",children:[(0,o.jsx)("strong",{children:"Deadline"}),(0,o.jsx)("span",{children:s.deadlineUTC?(0,d.fw)(s.deadlineUTC):"No deadline"})]})]}),h&&(0,o.jsxs)("div",{className:"task-actions",children:[!c&&(0,o.jsx)("button",{className:"btn btn-outline-danger",onClick:e=>{e.stopPropagation(),b(!0)},disabled:g,children:g?"Deleting...":"Delete"}),(0,o.jsx)("button",{className:"btn btn-dark",onClick:e=>{e.stopPropagation(),R()},disabled:g||!k.trim(),children:g?"Saving...":"Save"})]}),!h&&P&&(0,o.jsxs)("div",{className:"reminder-indicator",children:[(0,o.jsx)("i",{className:"bi bi-clock"})," ",(0,o.jsx)("small",{children:P})]})]})]}),(0,o.jsx)(l.A,{theme:t,show:f,title:"Delete Task",message:"Are you sure you want to delete this task?",onConfirm:async()=>{x(!0);try{await(0,r.vq)(s.id),i((e=>e.filter((e=>e.id!==s.id))))}catch(e){console.error("Delete failed",e)}finally{x(!1),b(!1)}},onCancel:()=>b(!1)})]})},N=e=>{let{show:t,onClose:s,onTaskGenerated:a,theme:i}=e;const[l,c]=(0,n.useState)("quick"),[d,m]=(0,n.useState)(""),[u,h]=(0,n.useState)([]),[p,g]=(0,n.useState)(""),[x,f]=(0,n.useState)(!1),[b,j]=(0,n.useState)(null),v=(0,n.useRef)(null),y=(0,n.useRef)(null);(0,n.useEffect)((()=>{t&&y.current&&y.current.focus()}),[t,l]),(0,n.useEffect)((()=>{var e;null===(e=v.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[u]);const k=async()=>{if(!d.trim())return;f(!0),j(null);const e=await(0,r.Pr)(d);if(e.success){const t=e.data,n={id:"temp-".concat(Date.now()),title:t.title,description:t.description,status:t.status||"not-started",deadline:t.deadline,reminders:t.reminders||[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),priority:1};a(n),m(""),s()}else j(e.error);f(!1)},N=async()=>{if(!p.trim())return;const e={role:"user",content:p.trim(),timestamp:(new Date).toISOString()};h((t=>[...t,e])),g(""),f(!0),j(null);const t=u.map((e=>({role:e.role,content:e.content}))),s=await(0,r.gQ)(e.content,t);if(s.success){const e={role:"assistant",content:s.data.reply,timestamp:(new Date).toISOString()};h((t=>[...t,e]))}else j(s.error);f(!1)},C=(e,t)=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),t())};return t?(0,o.jsx)("div",{className:"ai-modal-overlay",onClick:s,children:(0,o.jsxs)("div",{className:"ai-modal-content ".concat("dark"===i?"dark-mode":""),onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("div",{className:"ai-modal-header",children:[(0,o.jsxs)("h3",{children:[(0,o.jsx)("i",{className:"bi bi-robot"})," AI Task Assistant"]}),(0,o.jsx)("button",{className:"close-button",onClick:s,children:(0,o.jsx)("i",{className:"bi bi-x-lg"})})]}),(0,o.jsxs)("div",{className:"ai-mode-selector",children:[(0,o.jsxs)("button",{className:"mode-button ".concat("quick"===l?"active":""),onClick:()=>c("quick"),children:[(0,o.jsx)("i",{className:"bi bi-lightning-charge"}),"Quick Generate"]}),(0,o.jsxs)("button",{className:"mode-button ".concat("chat"===l?"active":""),onClick:()=>c("chat"),children:[(0,o.jsx)("i",{className:"bi bi-chat-dots"}),"Chat Mode"]})]}),b&&(0,o.jsxs)("div",{className:"error-banner",children:[(0,o.jsx)("i",{className:"bi bi-exclamation-triangle"}),b]}),"quick"===l?(0,o.jsxs)("div",{className:"quick-mode",children:[(0,o.jsxs)("div",{className:"quick-mode-content",children:[(0,o.jsx)("label",{className:"form-label",children:"Describe your task:"}),(0,o.jsx)("textarea",{ref:y,className:"form-control",rows:4,value:d,onChange:e=>m(e.target.value),onKeyDown:e=>C(e,k),placeholder:"E.g., 'Create a task to prepare for my presentation next Friday' or 'Remind me to buy groceries tomorrow at 5pm'",disabled:x}),(0,o.jsxs)("div",{className:"quick-mode-suggestions",children:[(0,o.jsx)("small",{children:"Try these examples:"}),(0,o.jsx)("button",{className:"suggestion-chip",onClick:()=>m("Schedule a dentist appointment for next week"),disabled:x,children:"Schedule appointment"}),(0,o.jsx)("button",{className:"suggestion-chip",onClick:()=>m("Plan weekend grocery shopping"),disabled:x,children:"Plan shopping"}),(0,o.jsx)("button",{className:"suggestion-chip",onClick:()=>m("Prepare project report due in 3 days"),disabled:x,children:"Project deadline"})]})]}),(0,o.jsxs)("div",{className:"modal-actions",children:[(0,o.jsx)("button",{className:"btn btn-secondary",onClick:s,disabled:x,children:"Cancel"}),(0,o.jsx)("button",{className:"btn btn-primary",onClick:k,disabled:!d.trim()||x,children:x?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"spinner-border spinner-border-sm me-2"}),"Generating..."]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("i",{className:"bi bi-magic me-2"}),"Generate Task"]})})]})]}):(0,o.jsxs)("div",{className:"chat-mode",children:[(0,o.jsxs)("div",{className:"chat-messages",children:[0===u.length?(0,o.jsxs)("div",{className:"chat-empty-state",children:[(0,o.jsx)("i",{className:"bi bi-chat-heart"}),(0,o.jsx)("p",{children:"Start a conversation with AI to create your task"}),(0,o.jsx)("small",{children:"Ask questions, get suggestions, and refine your task details"})]}):u.map(((e,t)=>(0,o.jsxs)("div",{className:"chat-message ".concat("user"===e.role?"user":"assistant"),children:[(0,o.jsx)("div",{className:"message-avatar",children:"user"===e.role?(0,o.jsx)("i",{className:"bi bi-person-circle"}):(0,o.jsx)("i",{className:"bi bi-robot"})}),(0,o.jsxs)("div",{className:"message-content",children:[(0,o.jsx)("div",{className:"message-text",children:e.content}),(0,o.jsx)("div",{className:"message-time",children:new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]},t))),x&&(0,o.jsxs)("div",{className:"chat-message assistant",children:[(0,o.jsx)("div",{className:"message-avatar",children:(0,o.jsx)("i",{className:"bi bi-robot"})}),(0,o.jsx)("div",{className:"message-content",children:(0,o.jsxs)("div",{className:"typing-indicator",children:[(0,o.jsx)("span",{}),(0,o.jsx)("span",{}),(0,o.jsx)("span",{})]})})]}),(0,o.jsx)("div",{ref:v})]}),(0,o.jsxs)("div",{className:"chat-input-container",children:[(0,o.jsx)("input",{ref:y,type:"text",className:"form-control",value:p,onChange:e=>g(e.target.value),onKeyDown:e=>C(e,N),placeholder:"Type your message...",disabled:x}),(0,o.jsx)("button",{className:"send-button",onClick:N,disabled:!p.trim()||x,children:(0,o.jsx)("i",{className:"bi bi-send-fill"})})]}),(0,o.jsxs)("div",{className:"chat-actions",children:[(0,o.jsxs)("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>{h([]),j(null)},disabled:x||0===u.length,children:[(0,o.jsx)("i",{className:"bi bi-arrow-clockwise me-1"}),"Reset"]}),(0,o.jsxs)("button",{className:"btn btn-sm btn-primary",onClick:async()=>{if(f(!0),j(null),0===u.length)return j("No conversation found to generate task from"),void f(!1);const e=u.map((e=>"".concat("user"===e.role?"User":"Assistant",": ").concat(e.content))).join("\n"),t="Based on this conversation, create a task:\n\n".concat(e,"\n\nCreate a detailed task with appropriate deadline and reminders based on the user's requirements discussed above."),n=await(0,r.Pr)(t);if(n.success){const e=n.data,t={id:"temp-".concat(Date.now()),title:e.title,description:e.description,status:e.status||"not-started",deadline:e.deadline,reminders:e.reminders||[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),priority:1};a(t),h([]),s()}else j(n.error);f(!1)},disabled:x||0===u.length,children:[(0,o.jsx)("i",{className:"bi bi-check2-circle me-1"}),"Create Task"]})]})]})]})}):null};var C=s(150);const w=e=>{switch(e){case"IN_PROGRESS":return"in-progress";case"COMPLETED":return"completed";default:return"not-started"}},D=e=>{var t;if(null===(t=e.reminders)||void 0===t||!t.length||!e.deadlineUTC)return e;const s=new Date(e.deadlineUTC),n=e.reminders.map((e=>"ONE_TIME"===e.type?{remindBefore:(s-new Date(e.triggerAtUTC))/36e5,sent:!1,customDate:e.triggerAtUTC}:"DAILY"===e.type?{type:"daily",hourOfDayUTC:e.hourOfDayUTC}:"WEEKLY"===e.type?{type:"weekly",hourOfDayUTC:e.hourOfDayUTC,dayOfWeek:e.dayOfWeek}:null));return(0,a.A)((0,a.A)({},e),{},{reminders:n.filter(Boolean)})},T=e=>{let{theme:t}=e;const{user:s,logout:l}=(0,i.A)(),[c,d]=(0,n.useState)(null),[m,u]=(0,n.useState)(null),[h,p]=(0,n.useState)(!1);(0,n.useEffect)((()=>{s&&(0,r.j)().then((e=>{const t=e.data.map((e=>(0,a.A)((0,a.A)({},D(e)),{},{status:w(e.status)})));d(t)})).catch((e=>{var t;console.error("Load tasks error:",e),403===(null===(t=e.response)||void 0===t?void 0:t.status)&&l()}))}),[s,l]);const g=async e=>{try{var t;const s=await(0,r.UT)(e),n=(0,a.A)((0,a.A)({},D(s.data)),{},{status:w(s.data.status)});null!==(t=e.reminders)&&void 0!==t&&t.length&&(await(0,r.eY)(n.id,e.reminders),n.reminders=e.reminders),d((t=>t.map((t=>t.id===e.id?n:t)))),u(null)}catch(s){console.error("Create failed:",s)}},x=e=>{d((t=>t.filter((t=>t.id!==e)))),u(null)};return c?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"container mt-5",children:(0,o.jsxs)("div",{className:"task-container card-body p-3",children:[(0,o.jsxs)("div",{className:"d-flex justify-content-between mb-3",children:[(0,o.jsx)("h2",{children:"Your Tasks"}),(0,o.jsxs)("div",{className:"d-flex gap-2",children:[(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===t?"light":"dark"),onClick:()=>p(!0),children:[(0,o.jsx)("i",{className:"bi bi-robot me-2"})," AI Assistant"]}),(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===t?"light":"dark"),onClick:()=>{const e={id:"temp-".concat(Date.now()),title:"",description:"",status:"not-started",deadlineUTC:null,reminders:[],createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),priority:(null===c||void 0===c?void 0:c.length)+1||1};u(e.id),d((t=>[e,...t||[]]))},children:[(0,o.jsx)("i",{className:"bi bi-plus-circle"})," New Task"]})]})]}),0===c.length?(0,o.jsx)("p",{children:"No tasks yet"}):(0,o.jsx)(C.JY,{onDragEnd:async e=>{let{destination:t,source:s}=e;if(!t||t.index===s.index)return;const a=Array.from(c),[n]=a.splice(s.index,1);a.splice(t.index,0,n),a.forEach(((e,t)=>e.priority=t+1)),d(a);try{await(0,r.vF)(n.id,t.index+1)}catch(i){console.error("Priority update failed:",i)}},children:(0,o.jsx)(C.gL,{droppableId:"taskList",children:e=>(0,o.jsxs)("div",(0,a.A)((0,a.A)({ref:e.innerRef},e.droppableProps),{},{children:[c.sort(((e,t)=>e.priority-t.priority)).map(((e,s)=>(0,o.jsx)(C.sx,{draggableId:String(e.id),index:s,children:s=>(0,o.jsx)("div",(0,a.A)((0,a.A)((0,a.A)({className:"mb-3",ref:s.innerRef},s.draggableProps),s.dragHandleProps),{},{children:(0,o.jsx)(k,{theme:t,task:e,setTasks:d,isNewTask:e.id===m,onSave:g,onCancel:x})}))},e.id))),e.placeholder]}))})})]})}),(0,o.jsx)(N,{show:h,onClose:()=>p(!1),onTaskGenerated:e=>{u(e.id),d((t=>[e,...t]))},theme:t})]}):(0,o.jsx)("p",{className:"text-center mt-5",children:"Loading..."})}},505:(e,t,s)=>{s.d(t,{A7:()=>p,DY:()=>h,E$:()=>j,J2:()=>g,Lx:()=>m,Pr:()=>y,U0:()=>x,UT:()=>i,XL:()=>u,eY:()=>d,ec:()=>b,gQ:()=>k,j:()=>r,lC:()=>l,r7:()=>v,vF:()=>c,vq:()=>o,xw:()=>f});var a=s(555);const n=s(722).A.create({baseURL:"http://localhost:5001/api",headers:{"ngrok-skip-browser-warning":"true"},timeout:3e4});n.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(e=>Promise.reject(e)));const r=()=>n.get("/tasks"),i=e=>n.post("/tasks",(0,a.A)((0,a.A)({},e),{},{deadlineUTC:e.deadlineUTC||null})),l=(e,t)=>{var s;return n.put("/tasks/".concat(e),(0,a.A)((0,a.A)({},t),{},{deadlineUTC:null!==(s=t.deadlineUTC)&&void 0!==s?s:null}))},o=e=>n.delete("/tasks/".concat(e)),c=(e,t)=>n.put("/tasks/".concat(e,"/priority"),{priority:t}),d=(e,t)=>n.patch("/tasks/".concat(e,"/reminders"),{action:"overwrite",reminders:t}),m=(e,t)=>n.post("/auth/login",{email:e,password:t}),u=e=>n.post("/auth/google",{code:e}),h=(e,t,s,a)=>n.post("/auth/register",{firstName:e,lastName:t,email:s,password:a}),p=(e,t)=>n.post("/auth/verify-registration",{email:e,verificationCode:t}),g=e=>n.post("/auth/resend-verification",{email:e}),x=e=>n.post("/auth/forgot-password",{email:e}),f=(e,t,s)=>n.post("/auth/verify-code",{email:e,verificationCode:t,newPassword:s}),b=(e,t)=>n.post("/auth/change-password",{currentPassword:e,newPassword:t}),j=()=>n.get("/profile").then((e=>e.data)),v=e=>n.put("/profile",e,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>e.data)),y=e=>n.post("/ai/chat",{prompt:e}).then((e=>({success:!0,data:e.data}))),k=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return n.post("/ai/chat-conversation",{message:e,conversationHistory:t})}},291:(e,t,s)=>{s.d(t,{Ic:()=>r,fw:()=>n,wM:()=>a});const a=e=>{if(!e)return"";const t=new Date(e),s=6e4*t.getTimezoneOffset();return new Date(t.getTime()-s).toISOString().slice(0,16)},n=e=>{if(!e)return"No date";const t=(new Date(e)-new Date)/864e5;return t>1?"".concat(Math.floor(t)," days left"):t>0?"Tomorrow":t>-1?"Today":"".concat(Math.abs(Math.ceil(t))," days ago")},r=e=>{if(!e)return"";return new Date(e).toLocaleString("en-US",{day:"numeric",month:"long",year:"numeric"})}}}]);
//# sourceMappingURL=871.b13ec57b.chunk.js.map