"use strict";(self.webpackChunktask_manager_frontend=self.webpackChunktask_manager_frontend||[]).push([[213],{869:(e,t,s)=>{s.d(t,{A:()=>r});s(43),s(421);var a=s(579);const r=e=>{let{theme:t,show:s,title:r="Confirm Action",message:n="Are you sure you want to proceed?",onConfirm:i,onCancel:c}=e;return s?(0,a.jsx)("div",{className:"custom-modal-overlay d-flex align-items-center justify-content-center",tabIndex:"-1",role:"dialog",onClick:c,children:(0,a.jsxs)("div",{className:"custom-modal-content",role:"document",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"custom-modal-header",children:[(0,a.jsx)("h5",{className:"modal2-title fw-bold",children:r}),(0,a.jsx)("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:c})]}),(0,a.jsx)("div",{className:"custom-modal-body",children:(0,a.jsx)("p",{className:"text-".concat("dark"===t?"light":"muted"," mb-4"),children:n})}),(0,a.jsxs)("div",{className:"custom-modal-footer d-flex justify-content-end gap-2",children:[(0,a.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:c,children:"Cancel"}),(0,a.jsx)("button",{type:"button",className:"btn sign-in-btn",onClick:i,children:"Confirm"})]})]})}):null}},213:(e,t,s)=>{s.r(t),s.d(t,{default:()=>A});var a=s(555),r=s(43),n=s(216),i=s(505),c=s(729),l=s(531),o=s(579);const d=e=>{let{setError:t,onClose:s}=e;const a=(0,n.Zp)(),[c,l]=(0,r.useState)(""),[d,m]=(0,r.useState)(!1),u=(0,r.useRef)(null);(0,r.useEffect)((()=>{u.current&&u.current.focus()}),[]);const h=async()=>{if(!c.trim())return;m(!0),t(null);const e=await(0,i.Pr)(c);if(m(!1),!e.success)return void t(e.error);const r=e.data,n={title:r.title,description:r.description,status:r.status||"not-started",deadline:r.deadline,reminders:r.reminders||[]};s(),a("/tasks/new/edit",{state:{task:n}})};return(0,o.jsxs)("div",{className:"quick-mode",children:[(0,o.jsxs)("div",{className:"quick-mode-content",children:[(0,o.jsx)("label",{className:"form-label",children:"Describe your task:"}),(0,o.jsx)("textarea",{ref:u,className:"form-control",rows:4,value:c,onChange:e=>l(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),h())},placeholder:"E.g., 'Prepare project report by Friday 5PM with reminders 1 day and 1 hour before'",disabled:d}),(0,o.jsxs)("div",{className:"quick-mode-suggestions",children:[(0,o.jsx)("small",{children:"Try these:"}),["Schedule dentist appointment next Tuesday at 3pm","Plan weekend shopping with 1 day reminder","Prepare presentation for Monday with daily reminders"].map((e=>(0,o.jsx)("button",{className:"suggestion-chip",onClick:()=>l(e),disabled:d,children:e},e)))]})]}),(0,o.jsxs)("div",{className:"modal-actions",children:[(0,o.jsx)("button",{className:"btn btn-secondary",onClick:s,disabled:d,children:"Cancel"}),(0,o.jsx)("button",{className:"btn btn-primary",onClick:h,disabled:!c.trim()||d,children:d?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"spinner-border spinner-border-sm me-2"})," ","Generating..."]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("i",{className:"bi bi-magic me-2"})," Generate Task"]})})]})]})},m=(e,t)=>{if(!Array.isArray(e)||!t)return e;const s=new Date(t);return e.map((e=>{if(e.remindBefore&&!e.customDate)return e;if(e.customDate){const t=new Date(e.customDate);if(!isNaN(t.getTime())&&t<s){const r=(s-t)/36e5;return(0,a.A)((0,a.A)({},e),{},{remindBefore:r})}}return e}))},u=e=>{var t,s,a,r;let{msg:n,user:i,theme:c}=e;const l=i.avatar,d=((null===(t=i.firstName)||void 0===t||null===(s=t[0])||void 0===s?void 0:s.toUpperCase())||"")+((null===(a=i.lastName)||void 0===a||null===(r=a[0])||void 0===r?void 0:r.toUpperCase())||"")||"?";return(0,o.jsxs)("div",{className:"chat-message ".concat(n.role),children:[(0,o.jsx)("div",{className:"message-avatar",children:"user"===n.role?l?(0,o.jsx)("img",{src:l,alt:"User",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"}}):(0,o.jsx)("div",{style:{width:"100%",height:"100%",borderRadius:"50%",backgroundColor:"dark"===c?"#ffffff":"#000000",color:"dark"===c?"#000000":"#ffffff",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.85rem"},children:d}):(0,o.jsx)("i",{className:"bi bi-robot"})}),(0,o.jsx)("div",{className:"message-content",children:(0,o.jsxs)("div",{className:"message-text",children:[(0,o.jsx)("div",{className:"message-text-content",children:(e=>{if(!e)return"";return e.split(/(\d+\.\s+[^\n]+)/g).map(((e,t)=>{if(/^\d+\.\s+/.test(e)){const s=e.match(/^(\d+)\.\s+(.+)/);if(s)return(0,o.jsxs)("div",{style:{marginLeft:"0.5rem",marginTop:"0.25rem"},children:[(0,o.jsxs)("strong",{children:[s[1],"."]})," ",s[2]]},t)}const s=e.split(/(\*\*[^*]+\*\*)/g).map(((e,t)=>e.startsWith("**")&&e.endsWith("**")?(0,o.jsx)("strong",{children:e.slice(2,-2)},t):e));return(0,o.jsx)("span",{children:s},t)}))})(n.content)}),(0,o.jsxs)("div",{className:"message-time",children:[(e=>{const t=new Date(e),s=new Date,a=(s-t)/36e5;return a<24&&t.getDate()===s.getDate()?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):a<48&&t.getDate()===s.getDate()-1?"Yesterday ".concat(t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})):t.toLocaleDateString([],{month:"short",day:"numeric"})+" "+t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})(n.timestamp),"user"===n.role&&(0,o.jsx)("i",{className:"bi bi-check-all",style:{fontSize:"0.75rem"}})]})]})})]})};s(421);var h=s(869),p=s(433),b=s(291);const g=[{value:1,label:"1 hr"},{value:24,label:"1 day"},{value:168,label:"1 week"}];function x(e){return e<1?"".concat(Math.round(60*e)," min"):Number.isInteger(e)?"".concat(e," hr").concat(e>1?"s":""):"".concat(e," hrs")}const f=e=>{let{theme:t,task:s,setTasks:n,isNewTask:c=!1,onSave:l=()=>{},onCancel:d=()=>{}}=e;const[m,u]=(0,r.useState)(c),[f,j]=(0,r.useState)(s.title),[v,k]=(0,r.useState)(s.description),[y,N]=(0,r.useState)(s.status),[w,C]=(0,r.useState)(s.deadline||null),[S,A]=(0,r.useState)(Array.isArray(s.reminders)?s.reminders:[]),[D,T]=(0,r.useState)(!1),[E,M]=(0,r.useState)(!1),I=(0,r.useRef)(null);(0,r.useEffect)((()=>{Array.isArray(s.reminders)&&s.reminders.length>0&&A(s.reminders)}),[s.reminders]);const B=(0,r.useCallback)((()=>{j(s.title),k(s.description),N(s.status),C(s.deadline||null),A(Array.isArray(s.reminders)?s.reminders:[]),c?d(s.id):u(!1)}),[s.title,s.description,s.status,s.deadline,s.reminders,c,d,s.id]);(0,r.useEffect)((()=>{const e=e=>{m&&I.current&&!I.current.contains(e.target)&&B()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[m,B]);const L=(e=>{switch(e){case"completed":return"#007a00";case"in-progress":return"#daa520";default:return"#a00000"}})(s.status),P=w&&new Date(w)>new Date,R=(()=>{if(!S||0===S.length)return null;const e=S.filter((e=>"daily"===e.type)).length,t=S.filter((e=>"weekly"===e.type)).length,s=S.filter((e=>"one-time"===e.type||!e.type)).length,a=[];return e>0&&a.push("Daily (".concat(e,")")),t>0&&a.push("Weekly (".concat(t,")")),s>0&&a.push("One-time (".concat(s,")")),a.length>0?a.join(", "):null})();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{ref:I,className:"task-card ".concat("dark"===t?"dark":""," ").concat(E?"loading":""," ").concat(c?"new-task":""),onClick:()=>!m&&u(!0),children:[(0,o.jsx)("div",{className:"task-strip",style:{backgroundColor:L}}),(0,o.jsxs)("div",{className:"task-card-content",children:[!m&&(0,o.jsx)("i",{className:"bi ".concat("completed"===s.status?"bi-check-circle":"in-progress"===s.status?"bi-hourglass":"bi-ban"," status-icon"),style:{color:L}}),m?(0,o.jsxs)("div",{className:"task-form-grid",children:[(0,o.jsxs)("div",{className:"task-form-group full-width",children:[(0,o.jsx)("label",{className:"form-label",children:"Title"}),(0,o.jsx)("input",{type:"text",className:"form-control",value:f,onChange:e=>j(e.target.value),placeholder:"Enter task title..."})]}),(0,o.jsxs)("div",{className:"task-form-group full-width",children:[(0,o.jsx)("label",{className:"form-label",children:"Description"}),(0,o.jsx)("textarea",{className:"form-control",rows:3,value:v,onChange:e=>k(e.target.value),placeholder:"Enter task description..."})]}),(0,o.jsxs)("div",{className:"task-form-group",children:[(0,o.jsx)("label",{className:"form-label",children:"Status"}),(0,o.jsxs)("select",{className:"form-select",value:y,onChange:e=>N(e.target.value),children:[(0,o.jsx)("option",{value:"not-started",children:"Not Started"}),(0,o.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,o.jsx)("option",{value:"completed",children:"Completed"})]})]}),(0,o.jsxs)("div",{className:"task-form-group",children:[(0,o.jsx)("label",{className:"form-label",children:"Deadline"}),(0,o.jsx)("input",{type:"datetime-local",className:"form-control",value:w?(0,b.wM)(w):"",onChange:e=>C(e.target.value)})]}),P&&(0,o.jsx)("div",{className:"task-form-group full-width",children:(0,o.jsx)(p.A,{tempDeadline:w,tempReminders:S,setTempReminders:A,theme:t,ALL_INTERVALS:g,formatHoursLabel:x})})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h5",{className:"task-title",style:{color:L},children:f}),(0,o.jsx)("p",{className:"task-description",children:v})]}),(0,o.jsxs)("div",{className:"task-metadata",children:[(0,o.jsxs)("div",{className:"task-metadata-item",children:[(0,o.jsx)("strong",{children:"Created"}),(0,o.jsx)("span",{children:(0,b.fw)(s.createdAt)})]}),(0,o.jsxs)("div",{className:"task-metadata-item",children:[(0,o.jsx)("strong",{children:"Deadline"}),(0,o.jsx)("span",{children:s.deadline?(0,b.fw)(s.deadline):"No deadline set"})]})]}),m&&(0,o.jsxs)("div",{className:"task-actions",children:[!c&&(0,o.jsx)("button",{className:"btn ".concat("dark"===t?"btn-outline-danger":"btn-secondary"),onClick:e=>{e.stopPropagation(),T(!0)},disabled:E,children:E?"Deleting...":"Delete"}),(0,o.jsx)("button",{className:"btn ".concat("dark"===t?"btn-outline-light":"btn-dark"),onClick:e=>{e.stopPropagation(),(async()=>{if(!f.trim()||!v.trim())return;if(M(!0),!(f!==s.title||v!==s.description||y!==s.status||w!==s.deadline||JSON.stringify(S)!==JSON.stringify(s.reminders))&&!c)return u(!1),void M(!1);const e=new Date,t=w?new Date(w):null,r=t&&t>e?(t-e)/36e5:0,o=r>0?(e=>{const t=e.some((e=>"daily"===e.type)),s=e.some((e=>"weekly"===e.type));let a=e.filter((e=>("one-time"===e.type||!e.type)&&e.remindBefore<=r));if(t&&r>0){const e=Math.floor(r/24);for(let t=1;t<=e;t++)a.push({remindBefore:24*t,sent:!1,type:"daily",dayNumber:t})}if(s&&r>0){const e=Math.floor(r/168);for(let t=1;t<=e;t++)a.push({remindBefore:24*t*7,sent:!1,type:"weekly",weekNumber:t})}return a})(S):[],d={title:f.trim(),description:v.trim(),status:y,deadline:w?t.toISOString():null,reminders:o};try{if(c)l((0,a.A)((0,a.A)({},s),d));else{const e=await(0,i.lC)(s.id,d);n((t=>t.map((t=>t.id===e.data.id?e.data:t)))),u(!1)}}catch(m){console.error("Error updating task:",m)}finally{M(!1)}})()},disabled:!f.trim()||!v.trim()||E,children:E?"Saving...":"Save"})]}),!m&&R&&(0,o.jsxs)("div",{className:"reminder-indicator",title:"Reminders: ".concat(R),children:[(0,o.jsx)("i",{className:"bi bi-clock"}),(0,o.jsx)("small",{children:R})]})]})]}),(0,o.jsx)(h.A,{theme:t,show:D,title:"Delete Task",message:"Are you sure you want to delete this task? This action cannot be undone.",onConfirm:async()=>{M(!0);try{await(0,i.vq)(s.id),n((e=>e.filter((e=>e.id!==s.id)))),T(!1)}catch(e){console.error("Error deleting task:",e)}finally{M(!1),T(!1)}},onCancel:()=>T(!1)})]})},j="ai_chat_history",v=e=>{let{setError:t,theme:s,refreshTasks:n}=e;const{user:l}=(0,c.A)(),[d,h]=(0,r.useState)((()=>{try{const e=localStorage.getItem(j);return e?JSON.parse(e):[]}catch(e){return console.error("Error loading chat history:",e),[]}})),[p,b]=(0,r.useState)(""),[g,x]=(0,r.useState)(!1),[v,k]=(0,r.useState)(null),y=(0,r.useRef)(null),N=(0,r.useRef)(null);(0,r.useEffect)((()=>{N.current&&N.current.focus()}),[]),(0,r.useEffect)((()=>{var e;null===(e=y.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[d,v]),(0,r.useEffect)((()=>{try{localStorage.setItem(j,JSON.stringify(d))}catch(e){console.error("Error saving chat history:",e)}}),[d]);const w=async()=>{if(!p.trim())return;const e={role:"user",content:p.trim(),timestamp:(new Date).toISOString()};h((t=>[...t,e])),b(""),x(!0),t(null);const s=d.map((e=>({role:e.role,content:e.content}))),r=await(0,i.gQ)(e.content,s);if(x(!1),!r.success)return void t(r.error);const{reply:n,previewUpdate:c}=r.data;c&&c.reminders&&(c.reminders=m(c.reminders,c.deadline)),h((e=>[...e,{role:"assistant",content:n,timestamp:(new Date).toISOString()}])),c&&k((0,a.A)((0,a.A)({},c),{},{_aiSuggested:!0,isUpdate:"update"===c.action||"delete"===c.action,isNewTask:"create"===c.action||c.isNewTask,createdAt:c.createdAt||(new Date).toISOString(),updatedAt:(new Date).toISOString()}))},C=async e=>{try{if(!e)return;x(!0),t(null);const s=m(e.reminders||[],e.deadline);let a="";"delete"===e.action?(await(0,i.vq)(e.id),a='\ud83d\uddd1\ufe0f Deleted task "'.concat(e.title,'".')):"create"===e.action?(await(0,i.UT)({title:e.title,description:e.description,status:e.status,deadline:e.deadline,reminders:s}),a='\u2728 Created new task "'.concat(e.title,'".')):(await(0,i.lC)(e.id,{title:e.title,description:e.description,status:e.status,deadline:e.deadline,reminders:s}),a='\u2705 Updated task "'.concat(e.title,'".')),await n(),k(null),h((e=>[...e,{role:"assistant",content:a,timestamp:(new Date).toISOString()}]))}catch(s){console.error("Error applying AI update:",s),t("Failed to apply update.")}finally{x(!1)}},S=()=>k(null);return(0,o.jsxs)("div",{className:"chat-mode",children:[(0,o.jsxs)("div",{className:"chat-messages",children:[0!==d.length||v?d.map(((e,t)=>(0,o.jsx)(u,{msg:e,user:l,theme:s},t))):(0,o.jsxs)("div",{className:"chat-empty-state",children:[(0,o.jsx)("i",{className:"bi bi-chat-heart"}),(0,o.jsx)("p",{children:"Start a conversation with AI"}),(0,o.jsx)("small",{children:"Ask questions or describe your task step by step"})]}),v&&(0,o.jsxs)("div",{className:"chat-message assistant",children:[(0,o.jsx)("div",{className:"message-avatar",children:(0,o.jsx)("i",{className:"bi bi-robot"})}),(0,o.jsx)("div",{className:"message-content w-100",children:"delete"===v.action?(0,o.jsxs)("div",{className:"ai-delete-preview p-3 rounded ".concat("dark"===s?"bg-dark text-light":"bg-light text-dark"),children:[(0,o.jsxs)("h6",{className:"mb-2",children:["\ud83d\uddd1\ufe0f Confirm delete: ",(0,o.jsx)("strong",{children:v.title}),"?"]}),(0,o.jsxs)("div",{className:"d-flex gap-2",children:[(0,o.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>C(v),disabled:g,children:g?"Deleting...":"Delete"}),(0,o.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:S,disabled:g,children:"Cancel"})]})]}):(0,o.jsx)(f,{theme:s,task:(0,a.A)((0,a.A)({},v),{},{title:v.title||"",description:v.description||"",reminders:Array.isArray(v.reminders)?v.reminders:[]}),isNewTask:!0,onSave:C,onCancel:S})})]}),g&&(0,o.jsxs)("div",{className:"chat-message assistant",children:[(0,o.jsx)("div",{className:"message-avatar",children:(0,o.jsx)("i",{className:"bi bi-robot"})}),(0,o.jsx)("div",{className:"message-content",children:(0,o.jsxs)("div",{className:"typing-indicator",children:[(0,o.jsx)("span",{}),(0,o.jsx)("span",{}),(0,o.jsx)("span",{})]})})]}),(0,o.jsx)("div",{ref:y})]}),(0,o.jsxs)("div",{className:"chat-input-container",children:[(0,o.jsx)("input",{ref:N,type:"text",className:"form-control",value:p,onChange:e=>b(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),w())},placeholder:"Type your message...",disabled:g}),(0,o.jsx)("button",{className:"send-button",onClick:w,disabled:!p.trim()||g,children:(0,o.jsx)("i",{className:"bi bi-send-fill"})})]}),(0,o.jsxs)("div",{className:"chat-actions",children:[(0,o.jsxs)("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>{h([]),t(null),k(null);try{localStorage.removeItem(j)}catch(e){console.error("Error clearing chat history:",e)}},disabled:g||0===d.length,children:[(0,o.jsx)("i",{className:"bi bi-arrow-clockwise me-1"})," Clear Chat"]}),(0,o.jsxs)("button",{className:"btn btn-sm btn-primary",onClick:async()=>{if(0===d.length)return void t("No conversation found to generate task from");x(!0),t(null);const e=d.map((e=>"".concat("user"===e.role?"User":"Assistant",": ").concat(e.content))).join("\n"),s="Based on this conversation, create a task:\n\n".concat(e,"\n\nCreate a detailed task with appropriate deadline and reminders."),r=await(0,i.Pr)(s);if(x(!1),!r.success)return void t(r.error);const n=r.data;k((0,a.A)((0,a.A)({},n),{},{id:"temp-".concat(Date.now()),status:n.status||"not-started",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),priority:1,_aiSuggested:!0,isNewTask:!0,action:"create"}))},disabled:g||0===d.length,children:[(0,o.jsx)("i",{className:"bi bi-magic me-1"})," Generate Task"]})]})]})},k=e=>{let{theme:t,task:s,onClose:a,onSave:r}=e;return(0,o.jsx)("div",{className:"ai-preview-overlay",onClick:a,children:(0,o.jsxs)("div",{className:"ai-preview-modal",onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("h5",{className:"mb-3",children:[(0,o.jsx)("i",{className:"bi bi-eye"})," Task Preview"]}),(0,o.jsx)(f,{theme:t,task:s,isNewTask:!0,onSave:r,onCancel:a}),(0,o.jsx)("div",{className:"text-end mt-2",children:(0,o.jsx)("button",{className:"btn btn-secondary",onClick:a,children:"Cancel"})})]})})},y=e=>{let{show:t,onClose:s,onTaskGenerated:a,theme:n,refreshTasks:i}=e;const[c,l]=(0,r.useState)("quick"),[m,u]=(0,r.useState)(null),[h,p]=(0,r.useState)(null),[b,g]=(0,r.useState)(!1);(0,r.useEffect)((()=>{try{const e=localStorage.getItem("ai_chat_mode");!e||"quick"!==e&&"chat"!==e||l(e)}catch(h){console.error("Error loading chat mode:",h)}}),[]),(0,r.useEffect)((()=>{try{localStorage.setItem("ai_chat_mode",c)}catch(h){console.error("Error saving chat mode:",h)}}),[c]),(0,r.useEffect)((()=>{const e=e=>{"Escape"===e.key&&t&&!m&&x()};return t&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}}),[t,m]);const x=()=>{g(!0),setTimeout((()=>{g(!1),p(null),s()}),250)};return t||b?(0,o.jsxs)("div",{className:"ai-modal-overlay ".concat(b?"closing":""),onClick:e=>{e.target!==e.currentTarget||m||x()},children:[(0,o.jsxs)("div",{className:"ai-modal-content ".concat("dark"===n?"dark-mode":""," ").concat(b?"closing":""),onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("div",{className:"ai-modal-header",children:[(0,o.jsxs)("h3",{children:[(0,o.jsx)("i",{className:"bi bi-robot"})," AI Task Assistant"]}),(0,o.jsx)("button",{className:"close-button",onClick:x,"aria-label":"Close AI Assistant",children:(0,o.jsx)("i",{className:"bi bi-x-lg"})})]}),(0,o.jsxs)("div",{className:"ai-mode-selector",children:[(0,o.jsxs)("button",{className:"mode-button ".concat("quick"===c?"active":""),onClick:()=>l("quick"),"aria-pressed":"quick"===c,children:[(0,o.jsx)("i",{className:"bi bi-lightning-charge"})," Quick"]}),(0,o.jsxs)("button",{className:"mode-button ".concat("chat"===c?"active":""),onClick:()=>l("chat"),"aria-pressed":"chat"===c,children:[(0,o.jsx)("i",{className:"bi bi-chat-dots"})," Chat"]})]}),h&&(0,o.jsxs)("div",{className:"error-banner",children:[(0,o.jsx)("i",{className:"bi bi-exclamation-triangle"})," ",h,(0,o.jsx)("button",{onClick:()=>p(null),style:{marginLeft:"auto",background:"none",border:"none",color:"inherit",cursor:"pointer",padding:"0 4px"},"aria-label":"Dismiss error",children:(0,o.jsx)("i",{className:"bi bi-x-lg"})})]}),"quick"===c?(0,o.jsx)(d,{setError:p,setPreviewTask:u,onTaskGenerated:a,onClose:x,theme:n}):(0,o.jsx)(v,{setError:p,theme:n,refreshTasks:i,onClose:x})]}),m&&(0,o.jsx)(k,{theme:n,task:m,onClose:()=>u(null),onSave:e=>{a(e),u(null),x()}})]}):null};var N=s(585),w=s(648),C=s(24);const S=e=>{let{task:t,theme:s}=e;const{attributes:r,listeners:n,setNodeRef:i,transform:c,transition:d,isDragging:m}=(0,w.gl)({id:t.id,transition:{duration:250,easing:"cubic-bezier(0.25, 0.8, 0.25, 1)"}}),u={transform:C.Ks.Transform.toString(c),transition:d||"transform 250ms cubic-bezier(0.25, 0.8, 0.25, 1)",opacity:m?0:1,cursor:"grab",touchAction:"manipulation"};return(0,o.jsx)("div",(0,a.A)((0,a.A)((0,a.A)({ref:i,style:u},r),n),{},{children:(0,o.jsx)(l.A,{theme:s,task:t})}))},A=e=>{let{theme:t}=e;const s=(0,n.Zp)(),{user:d,logout:m}=(0,c.A)(),[u,h]=(0,r.useState)(null),[p,b]=(0,r.useState)(!1),[g,x]=(0,r.useState)(null),f=(0,N.FR)((0,N.MS)(N.cA,{activationConstraint:{distance:10}}),(0,N.MS)(N.IG,{activationConstraint:{delay:200,tolerance:5}}),(0,N.MS)(N.AN,{activationConstraint:{distance:10}})),j=(0,r.useCallback)((async()=>{if(d)try{const e=await(0,i.j)();h(e.data)}catch(e){console.error("Error loading tasks:",e),e.response&&403===e.response.status&&m()}}),[d,m]);(0,r.useEffect)((()=>{j()}),[j]);if(!u)return(0,o.jsx)("div",{className:"container mt-5",children:(0,o.jsx)("div",{className:"task-container",children:(0,o.jsxs)("div",{className:"card-body p-3",children:[(0,o.jsxs)("div",{className:"d-flex flex-row justify-content-between align-items-center mb-3 header-container",children:[(0,o.jsx)("h2",{className:"card-title mb-0",children:"Your Tasks"}),(0,o.jsxs)("div",{className:"d-flex gap-2 button-group",children:[(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===t?"light":"dark"," ai-button"),disabled:!0,children:[(0,o.jsx)("i",{className:"bi bi-robot me-2"}),(0,o.jsx)("span",{className:"button-text",children:"AI Assistant"})]}),(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===t?"light":"dark"," d-flex align-items-center gap-2"),disabled:!0,children:[(0,o.jsx)("i",{className:"bi bi-plus-circle"}),(0,o.jsx)("span",{className:"button-text",children:"New Task"})]})]})]}),(0,o.jsx)("div",{className:"shimmer-list",children:Array.from({length:5}).map(((e,t)=>(0,o.jsxs)("div",{className:"shimmer-task-item",children:[(0,o.jsx)("div",{className:"shimmer-task-header"}),(0,o.jsx)("div",{className:"shimmer-task-body"})]},t)))})]})})});const v=[...u].sort(((e,t)=>e.priority-t.priority)),k=g?u.find((e=>e.id===g)):null;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"container mt-5",children:(0,o.jsx)("div",{className:"task-container",children:(0,o.jsxs)("div",{className:"card-body p-3",children:[(0,o.jsxs)("div",{className:"d-flex flex-row justify-content-between align-items-center mb-3 header-container",children:[(0,o.jsx)("h2",{className:"card-title mb-0",children:"Your Tasks"}),(0,o.jsxs)("div",{className:"d-flex gap-2 button-group",children:[(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===t?"light":"dark"," ai-button"),onClick:()=>b(!0),children:[(0,o.jsx)("i",{className:"bi bi-robot me-2"}),(0,o.jsx)("span",{className:"button-text",children:"AI Assistant"})]}),(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===t?"light":"dark"," d-flex align-items-center gap-2"),onClick:()=>{s("/tasks/new/edit")},children:[(0,o.jsx)("i",{className:"bi bi-plus-circle"}),(0,o.jsx)("span",{className:"button-text",children:"New Task"})]})]})]}),0===u.length?(0,o.jsxs)("div",{className:"empty-state",children:[(0,o.jsx)("i",{className:"bi bi-clipboard-check empty-state-icon"}),(0,o.jsx)("p",{className:"text-".concat("dark"===t?"light":"muted"," mb-2"),children:"No tasks yet"}),(0,o.jsx)("small",{className:"text-muted",children:"Create your first task or use AI Assistant to get started"})]}):(0,o.jsxs)(N.Mp,{sensors:f,collisionDetection:N.fp,onDragStart:e=>{x(e.active.id)},onDragEnd:async e=>{const{active:t,over:s}=e;x(null),s&&t.id!==s.id&&h((e=>{const r=e.findIndex((e=>e.id===t.id)),n=e.findIndex((e=>e.id===s.id));if(-1===r||-1===n)return e;const c=(0,w.be)(e,r,n),l=c.map(((e,t)=>{const s=t+1;return e.priority!==s?(0,i.vF)(e.id,s).catch((t=>{console.error("Error updating priority for task ".concat(e.id,":"),t)})):Promise.resolve()}));return Promise.all(l),c.map(((e,t)=>(0,a.A)((0,a.A)({},e),{},{priority:t+1})))}))},onDragCancel:()=>{x(null)},children:[(0,o.jsx)(w.gB,{items:v.map((e=>e.id)),strategy:w.kL,children:(0,o.jsx)("div",{className:"task-list",children:v.map((e=>(0,o.jsx)(S,{task:e,theme:t},e.id)))})}),(0,o.jsx)(N.Hd,{adjustScale:!1,dropAnimation:{duration:300,easing:"cubic-bezier(0.25, 0.8, 0.25, 1)"},style:{cursor:"grabbing"},children:k?(0,o.jsx)("div",{style:{transform:"scale(1.03) rotate(2deg)",cursor:"grabbing",boxShadow:"0 12px 24px rgba(0, 0, 0, 0.25), 0 4px 8px rgba(0, 0, 0, 0.15)",borderRadius:"10px",transition:"all 150ms cubic-bezier(0.25, 0.8, 0.25, 1)"},children:(0,o.jsx)(l.A,{theme:t,task:k})}):null})]})]})})}),(0,o.jsx)(y,{show:p,onClose:()=>b(!1),onTaskGenerated:e=>{s("/tasks/new/edit",{state:{task:e}})},theme:t,refreshTasks:async()=>{try{const e=await(0,i.j)();return h(e.data),e.data}catch(e){console.error("Error refreshing tasks:",e)}}})]})}},531:(e,t,s)=>{s.d(t,{A:()=>i});s(43);var a=s(216),r=s(291),n=s(579);const i=e=>{let{theme:t,task:s}=e;const i=(0,a.Zp)(),c=(e=>{switch(e){case"completed":return"#007a00";case"in-progress":return"#daa520";default:return"#a00000"}})(s.status),l=(()=>{if(!s.reminders||0===s.reminders.length)return null;const e=s.reminders.filter((e=>"daily"===e.type)).length,t=s.reminders.filter((e=>"weekly"===e.type)).length,a=s.reminders.filter((e=>"one-time"===e.type||!e.type)).length,r=[];return e>0&&r.push("Daily (".concat(e,")")),t>0&&r.push("Weekly (".concat(t,")")),a>0&&r.push("One-time (".concat(a,")")),r.length>0?r.join(", "):null})();return(0,n.jsxs)("div",{className:"task-card ".concat("dark"===t?"dark":""),onClick:()=>{i("/tasks/".concat(s.id,"/edit"))},children:[(0,n.jsx)("div",{className:"task-strip",style:{backgroundColor:c}}),(0,n.jsxs)("div",{className:"task-card-content",children:[(0,n.jsx)("i",{className:"bi ".concat("completed"===s.status?"bi-check-circle":"in-progress"===s.status?"bi-hourglass":"bi-ban"," status-icon"),style:{color:c}}),(0,n.jsx)("h5",{className:"task-title",style:{color:c},children:s.title}),(0,n.jsx)("p",{className:"task-description",children:s.description}),(0,n.jsxs)("div",{className:"task-metadata",children:[(0,n.jsxs)("div",{className:"task-metadata-item",children:[(0,n.jsx)("strong",{children:"Created"}),(0,n.jsx)("span",{children:(0,r.fw)(s.createdAt)})]}),(0,n.jsxs)("div",{className:"task-metadata-item",children:[(0,n.jsx)("strong",{children:"Deadline"}),(0,n.jsx)("span",{children:s.deadline?(0,r.fw)(s.deadline):"No deadline set"})]})]}),l&&(0,n.jsxs)("div",{className:"reminder-indicator",title:"Reminders: ".concat(l),children:[(0,n.jsx)("i",{className:"bi bi-clock"}),(0,n.jsx)("small",{children:l})]})]})]})}},433:(e,t,s)=>{s.d(t,{A:()=>l});var a=s(43),r=s(579);const n=e=>{let{value:t,label:s,checked:a,onChange:n,className:i="",disabled:c=!1}=e;return(0,r.jsx)("div",{className:"d-inline-block ".concat(i),children:(0,r.jsxs)("label",{className:"reminder-checkbox-label d-inline-flex align-items-center ".concat(c?"disabled":""),children:[(0,r.jsx)("input",{type:"checkbox",className:"form-check-input me-2",checked:a,onChange:e=>!c&&n(e.target.checked),disabled:c,"aria-label":"Set reminder for ".concat(s),"aria-describedby":"reminder-".concat(t,"-desc")}),(0,r.jsx)("span",{id:"reminder-".concat(t,"-desc"),children:s})]})})};var i=s(291);const c=e=>{if(e<1)return"".concat(Math.round(60*e)," min");if(e<24)return"".concat(e%1===0?e:e.toFixed(1)," hr").concat(1!==e?"s":"");const t=e/24;if(t<7)return"".concat(t%1===0?t:t.toFixed(1)," day").concat(1!==t?"s":"");const s=t/7;return"".concat(s%1===0?s:s.toFixed(1)," week").concat(1!==s?"s":"")},l=e=>{let{tempDeadline:t,tempReminders:s,setTempReminders:l,theme:o,ALL_INTERVALS:d}=e;const[m,u]=(0,a.useState)(""),[h,p]=(0,a.useState)(!1),b=new Date,g=t?new Date(t):null,x=g&&g>b?(g-b)/36e5:0,f=e=>!e.type||"one-time"===e.type,j=s.some((e=>"daily"===e.type)),v=s.some((e=>"weekly"===e.type)),k=d.filter((e=>e.value<=x)),y=s.filter((e=>{if(!f(e))return!1;if(e.remindBefore>x)return!1;return!d.some((t=>Math.abs(t.value-e.remindBefore)<.01))})).map((e=>{if(e.customDate)try{const t=new Date(e.customDate);return{value:e.remindBefore,label:t.toLocaleString(),customDate:e.customDate}}catch(t){console.warn("Error formatting customDate:",t)}if(g){const t=new Date(g.getTime()-36e5*e.remindBefore);return{value:e.remindBefore,label:t.toLocaleString()}}return{value:e.remindBefore,label:c(e.remindBefore)}})),N=(e,t)=>{l((s=>{if(t){return s.find((t=>f(t)&&Math.abs(t.remindBefore-e)<.01))?s:[...s,{remindBefore:e,sent:!1,type:"one-time"}]}return s.filter((t=>!f(t)||Math.abs(t.remindBefore-e)>=.01))}))},w=Math.floor(x/24),C=Math.floor(x/168);return(0,r.jsxs)("div",{className:"task-reminders-container",children:[(0,r.jsx)("div",{className:"reminders-dropdown",onClick:()=>p(!h),children:(0,r.jsxs)("div",{className:"reminders-dropdown-header",children:[(0,r.jsxs)("h6",{children:[(0,r.jsx)("i",{className:"bi bi-clock"})," Reminders",s.length>0&&(0,r.jsx)("span",{className:"reminder-count-badge",children:s.length})]}),h?(0,r.jsx)("i",{className:"bi bi-chevron-up"}):(0,r.jsx)("i",{className:"bi bi-chevron-down"})]})}),h&&(0,r.jsxs)("div",{className:"reminders-dropdown-content",children:[(w>0||C>0)&&(0,r.jsxs)("div",{className:"recurring-reminders-section",children:[(0,r.jsxs)("label",{className:"reminder-section-label",children:[(0,r.jsx)("i",{className:"bi bi-arrow-repeat"})," Recurring Reminders:"]}),(0,r.jsxs)("div",{className:"recurring-options",children:[w>0&&(0,r.jsxs)("div",{className:"recurring-option",children:[(0,r.jsx)("input",{type:"checkbox",checked:j,onChange:e=>{return t=e.target.checked,void l((e=>t?[...e.filter((e=>"daily"!==e.type)),{remindBefore:24,sent:!1,type:"daily"}]:e.filter((e=>"daily"!==e.type))));var t},id:"daily-reminders"}),(0,r.jsxs)("label",{htmlFor:"daily-reminders",children:["Every Day (up to ",w," reminder",1!==w?"s":"",")"]})]}),C>0&&(0,r.jsxs)("div",{className:"recurring-option",children:[(0,r.jsx)("input",{type:"checkbox",checked:v,onChange:e=>{return t=e.target.checked,void l((e=>t?[...e.filter((e=>"weekly"!==e.type)),{remindBefore:168,sent:!1,type:"weekly"}]:e.filter((e=>"weekly"!==e.type))));var t},id:"weekly-reminders"}),(0,r.jsxs)("label",{htmlFor:"weekly-reminders",children:["Every Week (up to ",C," reminder",1!==C?"s":"",")"]})]})]})]}),k.length>0&&(0,r.jsxs)("div",{className:"reminder-section",children:[(0,r.jsxs)("label",{className:"reminder-section-label",children:[(0,r.jsx)("i",{className:"bi bi-bell"})," One-time Reminders:"]}),(0,r.jsx)("div",{className:"reminder-grid",children:k.map((e=>{const t=!!s.find((t=>f(t)&&Math.abs(t.remindBefore-e.value)<.01));return(0,r.jsx)(n,{value:e.value,label:e.label,checked:t,onChange:t=>N(e.value,t)},e.value)}))})]}),(0,r.jsxs)("div",{className:"custom-reminder-section",children:[(0,r.jsxs)("label",{className:"reminder-section-label",children:[(0,r.jsx)("i",{className:"bi bi-calendar-plus"})," Add Custom Reminder:"]}),(0,r.jsxs)("div",{className:"custom-reminder-input-group",children:[(0,r.jsx)("input",{type:"datetime-local",value:m,onChange:e=>u(e.target.value),min:(0,i.wM)(b.toISOString()),max:t?(0,i.wM)(t):void 0}),(0,r.jsxs)("button",{className:"btn btn-sm ".concat("dark"===o?"btn-outline-light":"btn-outline-dark"),onClick:()=>{if(!m)return;const e=new Date(m);if(isNaN(e.getTime()))return void console.warn("Invalid date selected");if(!g||e>=g)return void console.warn("Custom reminder must be before deadline");if(e<=b)return void console.warn("Custom reminder must be in the future");const t=(g-e)/36e5;t>0&&t<=x&&(l((s=>s.some((e=>f(e)&&Math.abs(e.remindBefore-t)<.01))?s:[...s,{remindBefore:t,sent:!1,type:"one-time",customDate:e.toISOString()}])),u(""))},disabled:!m,children:[(0,r.jsx)("i",{className:"bi bi-plus-lg"})," Add"]})]})]}),y.length>0&&(0,r.jsxs)("div",{className:"reminder-section",children:[(0,r.jsxs)("label",{className:"reminder-section-label",children:[(0,r.jsx)("i",{className:"bi bi-calendar-check"})," Custom One-time Reminders:"]}),(0,r.jsx)("div",{className:"reminder-grid",children:y.map(((e,t)=>{const a=!!s.find((t=>f(t)&&Math.abs(t.remindBefore-e.value)<.01));return(0,r.jsx)(n,{value:e.value,label:e.label,checked:a,onChange:t=>N(e.value,t)},e.customDate||"".concat(e.value,"-").concat(t))}))})]}),s.length>0&&(0,r.jsx)("div",{className:"active-reminders-summary",children:(0,r.jsxs)("small",{children:[(0,r.jsx)("i",{className:"bi bi-info-circle"})," ",(0,r.jsx)("strong",{children:"Active:"}),j&&" Daily",j&&v&&",",v&&" Weekly",(j||v)&&s.filter(f).length>0&&",",s.filter(f).length>0&&" ".concat(s.filter(f).length," one-time")]})})]})]})}},505:(e,t,s)=>{s.d(t,{A7:()=>p,DY:()=>h,E$:()=>j,J2:()=>b,Lx:()=>m,Pr:()=>k,U0:()=>g,UT:()=>c,XL:()=>u,ec:()=>f,gQ:()=>y,iV:()=>i,j:()=>n,lC:()=>l,r7:()=>v,vF:()=>d,vq:()=>o,xw:()=>x});const a=s(722).A.create({baseURL:"https://task-manager-sigma-ashen.vercel.app/api",headers:{"ngrok-skip-browser-warning":"true"},timeout:3e4});a.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(e=>Promise.reject(e)));const r=e=>{var t;return e.response?{message:(null===(t=e.response.data)||void 0===t?void 0:t.error)||"An error occurred",status:e.response.status}:e.request?{message:"No response from server. Please check your connection.",status:0}:{message:e.message||"An unexpected error occurred",status:-1}},n=()=>a.get("/tasks"),i=e=>a.get("/tasks/".concat(e)),c=e=>a.post("/tasks",e),l=(e,t)=>a.put("/tasks/".concat(e),t),o=e=>a.delete("/tasks/".concat(e)),d=(e,t)=>a.put("/tasks/".concat(e,"/priority"),{priority:t}),m=(e,t)=>a.post("/auth/login",{email:e,password:t}),u=async e=>a.post("/auth/google",{code:e}),h=(e,t,s,r)=>a.post("/auth/register",{firstName:e,lastName:t,email:s,password:r}),p=(e,t)=>a.post("/auth/verify-registration",{email:e,verificationCode:t}),b=e=>a.post("/auth/resend-verification",{email:e}),g=e=>a.post("/auth/forgot-password",{email:e}),x=(e,t,s)=>a.post("/auth/verify-code",{email:e,verificationCode:t,newPassword:s}),f=(e,t)=>a.post("/auth/change-password",{currentPassword:e,newPassword:t}),j=async()=>{try{return(await a.get("/profile")).data}catch(e){throw console.error("Error fetching profile:",e),e}},v=async e=>{try{return(await a.put("/profile",e,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(t){throw console.error("Error updating profile:",t),t}},k=async e=>{try{const t=Intl.DateTimeFormat().resolvedOptions().timeZone;return{success:!0,data:(await a.post("/ai/chat",{prompt:e},{headers:{"x-user-timezone":t}})).data}}catch(t){return{success:!1,error:r(t).message}}},y=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{const s=Intl.DateTimeFormat().resolvedOptions().timeZone;return{success:!0,data:(await a.post("/ai/chat-conversation",{message:e,conversationHistory:t},{headers:{"x-user-timezone":s}})).data}}catch(s){return{success:!1,error:r(s).message}}}},291:(e,t,s)=>{s.d(t,{Ic:()=>n,fw:()=>r,wM:()=>i});var a=s(535);const r=e=>{const t=new Date(e),s=new Date,r=Math.floor((s-t)/1e3);if(r<0){const e=Math.abs(r);return e<60?"Just now":e<60?"in ".concat(e," second").concat(1!==e?"s":""):e<3600?"in ".concat(Math.ceil(e/60)," minute").concat(1!==Math.ceil(e/60)?"s":""):e<86400?"in ".concat(Math.ceil(e/3600)," hour").concat(1!==Math.ceil(e/3600)?"s":""):e<604800?"in ".concat(Math.ceil(e/86400)," day").concat(1!==Math.ceil(e/86400)?"s":""):(0,a.GP)(t,"MMM dd, yyyy")}if(r<60)return"Just now";if(r<60)return"".concat(r," second").concat(1!==r?"s":""," ago");if(r<3600)return"".concat(Math.floor(r/60)," minute").concat(1!==Math.floor(r/60)?"s":""," ago");if(r<86400)return"".concat(Math.floor(r/3600)," hour").concat(1!==Math.floor(r/3600)?"s":""," ago");if(r<604800){const e=Math.floor(r/86400);return 1===e?"Yesterday":"".concat(e," days ago")}return(0,a.GP)(t,"MMM dd, yyyy")},n=e=>{const[t,s,a]=e.split("-").map(Number),r=new Date(t,s-1,a);if(isNaN(r))return"Invalid Date";return r.toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric"})},i=e=>{const t=new Date(e),s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),n=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0");return"".concat(s,"-").concat(a,"-").concat(r,"T").concat(n,":").concat(i)}}}]);
//# sourceMappingURL=213.f53940ce.chunk.js.map