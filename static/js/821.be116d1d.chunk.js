"use strict";(self.webpackChunktask_manager_frontend=self.webpackChunktask_manager_frontend||[]).push([[821],{869:(e,s,t)=>{t.d(s,{A:()=>n});t(43),t(421);var a=t(579);const n=e=>{let{theme:s,show:t,title:n="Confirm Action",message:r="Are you sure you want to proceed?",onConfirm:i,onCancel:c}=e;return t?(0,a.jsx)("div",{className:"custom-modal-overlay d-flex align-items-center justify-content-center",tabIndex:"-1",role:"dialog",onClick:c,children:(0,a.jsxs)("div",{className:"custom-modal-content",role:"document",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"custom-modal-header",children:[(0,a.jsx)("h5",{className:"modal2-title fw-bold",children:n}),(0,a.jsx)("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:c})]}),(0,a.jsx)("div",{className:"custom-modal-body",children:(0,a.jsx)("p",{className:"text-".concat("dark"===s?"light":"muted"," mb-4"),children:r})}),(0,a.jsxs)("div",{className:"custom-modal-footer d-flex justify-content-end gap-2",children:[(0,a.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:c,children:"Cancel"}),(0,a.jsx)("button",{type:"button",className:"btn sign-in-btn",onClick:i,children:"Confirm"})]})]})}):null}},821:(e,s,t)=>{t.r(s),t.d(s,{default:()=>S});var a=t(555),n=t(43),r=t(216),i=t(505),c=t(729),l=t(291),o=t(579);const d=e=>{let{theme:s,task:t}=e;const a=(0,r.Zp)(),n=(e=>{switch(e){case"completed":return"#007a00";case"in-progress":return"#daa520";default:return"#a00000"}})(t.status),i=(()=>{if(!t.reminders||0===t.reminders.length)return null;const e=t.reminders.filter((e=>"daily"===e.type)).length,s=t.reminders.filter((e=>"weekly"===e.type)).length,a=t.reminders.filter((e=>"one-time"===e.type||!e.type)).length,n=[];return e>0&&n.push("Daily (".concat(e,")")),s>0&&n.push("Weekly (".concat(s,")")),a>0&&n.push("One-time (".concat(a,")")),n.length>0?n.join(", "):null})();return(0,o.jsxs)("div",{className:"task-card ".concat("dark"===s?"dark":""),onClick:()=>{a("/tasks/".concat(t.id,"/edit"))},children:[(0,o.jsx)("div",{className:"task-strip",style:{backgroundColor:n}}),(0,o.jsxs)("div",{className:"task-card-content",children:[(0,o.jsx)("i",{className:"bi ".concat("completed"===t.status?"bi-check-circle":"in-progress"===t.status?"bi-hourglass":"bi-ban"," status-icon"),style:{color:n}}),(0,o.jsx)("h5",{className:"task-title",style:{color:n},children:t.title}),(0,o.jsx)("p",{className:"task-description",children:t.description}),(0,o.jsxs)("div",{className:"task-metadata",children:[(0,o.jsxs)("div",{className:"task-metadata-item",children:[(0,o.jsx)("strong",{children:"Created"}),(0,o.jsx)("span",{children:(0,l.fw)(t.createdAt)})]}),(0,o.jsxs)("div",{className:"task-metadata-item",children:[(0,o.jsx)("strong",{children:"Deadline"}),(0,o.jsx)("span",{children:t.deadline?(0,l.fw)(t.deadline):"No deadline set"})]})]}),i&&(0,o.jsxs)("div",{className:"reminder-indicator",title:"Reminders: ".concat(i),children:[(0,o.jsx)("i",{className:"bi bi-clock"}),(0,o.jsx)("small",{children:i})]})]})]})},m=e=>{let{setError:s,onClose:t}=e;const a=(0,r.Zp)(),[c,l]=(0,n.useState)(""),[d,m]=(0,n.useState)(!1),u=(0,n.useRef)(null);(0,n.useEffect)((()=>{u.current&&u.current.focus()}),[]);const h=async()=>{if(!c.trim())return;m(!0),s(null);const e=await(0,i.Pr)(c);if(m(!1),!e.success)return void s(e.error);const n=e.data,r={title:n.title,description:n.description,status:n.status||"not-started",deadline:n.deadline,reminders:n.reminders||[]};t(),a("/tasks/new/edit",{state:{task:r}})};return(0,o.jsxs)("div",{className:"quick-mode",children:[(0,o.jsxs)("div",{className:"quick-mode-content",children:[(0,o.jsx)("label",{className:"form-label",children:"Describe your task:"}),(0,o.jsx)("textarea",{ref:u,className:"form-control",rows:4,value:c,onChange:e=>l(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),h())},placeholder:"E.g., 'Prepare project report by Friday 5PM with reminders 1 day and 1 hour before'",disabled:d}),(0,o.jsxs)("div",{className:"quick-mode-suggestions",children:[(0,o.jsx)("small",{children:"Try these:"}),["Schedule dentist appointment next Tuesday at 3pm","Plan weekend shopping with 1 day reminder","Prepare presentation for Monday with daily reminders"].map((e=>(0,o.jsx)("button",{className:"suggestion-chip",onClick:()=>l(e),disabled:d,children:e},e)))]})]}),(0,o.jsxs)("div",{className:"modal-actions",children:[(0,o.jsx)("button",{className:"btn btn-secondary",onClick:t,disabled:d,children:"Cancel"}),(0,o.jsx)("button",{className:"btn btn-primary",onClick:h,disabled:!c.trim()||d,children:d?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"spinner-border spinner-border-sm me-2"})," ","Generating..."]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("i",{className:"bi bi-magic me-2"})," Generate Task"]})})]})]})},u=(e,s)=>{if(!Array.isArray(e)||!s)return e;const t=new Date(s);return e.map((e=>{if(e.remindBefore&&!e.customDate)return e;if(e.customDate){const s=new Date(e.customDate);if(!isNaN(s.getTime())&&s<t){const n=(t-s)/36e5;return(0,a.A)((0,a.A)({},e),{},{remindBefore:n})}}return e}))},h=e=>{var s,t,a,n;let{msg:r,user:i,theme:c}=e;const l=i.avatar,d=((null===(s=i.firstName)||void 0===s||null===(t=s[0])||void 0===t?void 0:t.toUpperCase())||"")+((null===(a=i.lastName)||void 0===a||null===(n=a[0])||void 0===n?void 0:n.toUpperCase())||"")||"?";return(0,o.jsxs)("div",{className:"chat-message ".concat(r.role),children:[(0,o.jsx)("div",{className:"message-avatar",children:"user"===r.role?l?(0,o.jsx)("img",{src:l,alt:"User",style:{width:"32px",height:"32px",borderRadius:"50%",objectFit:"cover",border:"dark"===c?"1px solid #fff":"1px solid #000"}}):(0,o.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"50%",backgroundColor:"#6c757d",color:"#fff",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.9rem",border:"dark"===c?"1px solid #fff":"1px solid #000"},children:d}):(0,o.jsx)("i",{className:"bi bi-robot"})}),(0,o.jsxs)("div",{className:"message-content",children:[(0,o.jsx)("div",{className:"message-text",children:r.content}),(0,o.jsx)("div",{className:"message-time",children:new Date(r.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})};t(421);var p=t(869),b=t(433);const x=[{value:1,label:"1 hr"},{value:24,label:"1 day"},{value:168,label:"1 week"}];function g(e){return e<1?"".concat(Math.round(60*e)," min"):Number.isInteger(e)?"".concat(e," hr").concat(e>1?"s":""):"".concat(e," hrs")}const j=e=>{let{theme:s,task:t,setTasks:r,isNewTask:c=!1,onSave:d=()=>{},onCancel:m=()=>{}}=e;const[u,h]=(0,n.useState)(c),[j,v]=(0,n.useState)(t.title),[f,k]=(0,n.useState)(t.description),[N,y]=(0,n.useState)(t.status),[w,C]=(0,n.useState)(t.deadline||null),[S,A]=(0,n.useState)(Array.isArray(t.reminders)?t.reminders:[]),[D,M]=(0,n.useState)(!1),[T,E]=(0,n.useState)(!1),I=(0,n.useRef)(null);(0,n.useEffect)((()=>{Array.isArray(t.reminders)&&t.reminders.length>0&&A(t.reminders)}),[t.reminders]);const P=(0,n.useCallback)((()=>{v(t.title),k(t.description),y(t.status),C(t.deadline||null),A(Array.isArray(t.reminders)?t.reminders:[]),c?m(t.id):h(!1)}),[t.title,t.description,t.status,t.deadline,t.reminders,c,m,t.id]);(0,n.useEffect)((()=>{const e=e=>{u&&I.current&&!I.current.contains(e.target)&&P()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[u,P]);const B=(e=>{switch(e){case"completed":return"#007a00";case"in-progress":return"#daa520";default:return"#a00000"}})(t.status),R=w&&new Date(w)>new Date,L=(()=>{if(!S||0===S.length)return null;const e=S.filter((e=>"daily"===e.type)).length,s=S.filter((e=>"weekly"===e.type)).length,t=S.filter((e=>"one-time"===e.type||!e.type)).length,a=[];return e>0&&a.push("Daily (".concat(e,")")),s>0&&a.push("Weekly (".concat(s,")")),t>0&&a.push("One-time (".concat(t,")")),a.length>0?a.join(", "):null})();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{ref:I,className:"task-card ".concat("dark"===s?"dark":""," ").concat(T?"loading":""," ").concat(c?"new-task":""),onClick:()=>!u&&h(!0),children:[(0,o.jsx)("div",{className:"task-strip",style:{backgroundColor:B}}),(0,o.jsxs)("div",{className:"task-card-content",children:[!u&&(0,o.jsx)("i",{className:"bi ".concat("completed"===t.status?"bi-check-circle":"in-progress"===t.status?"bi-hourglass":"bi-ban"," status-icon"),style:{color:B}}),u?(0,o.jsxs)("div",{className:"task-form-grid",children:[(0,o.jsxs)("div",{className:"task-form-group full-width",children:[(0,o.jsx)("label",{className:"form-label",children:"Title"}),(0,o.jsx)("input",{type:"text",className:"form-control",value:j,onChange:e=>v(e.target.value),placeholder:"Enter task title..."})]}),(0,o.jsxs)("div",{className:"task-form-group full-width",children:[(0,o.jsx)("label",{className:"form-label",children:"Description"}),(0,o.jsx)("textarea",{className:"form-control",rows:3,value:f,onChange:e=>k(e.target.value),placeholder:"Enter task description..."})]}),(0,o.jsxs)("div",{className:"task-form-group",children:[(0,o.jsx)("label",{className:"form-label",children:"Status"}),(0,o.jsxs)("select",{className:"form-select",value:N,onChange:e=>y(e.target.value),children:[(0,o.jsx)("option",{value:"not-started",children:"Not Started"}),(0,o.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,o.jsx)("option",{value:"completed",children:"Completed"})]})]}),(0,o.jsxs)("div",{className:"task-form-group",children:[(0,o.jsx)("label",{className:"form-label",children:"Deadline"}),(0,o.jsx)("input",{type:"datetime-local",className:"form-control",value:w?(0,l.wM)(w):"",onChange:e=>C(e.target.value)})]}),R&&(0,o.jsx)("div",{className:"task-form-group full-width",children:(0,o.jsx)(b.A,{tempDeadline:w,tempReminders:S,setTempReminders:A,theme:s,ALL_INTERVALS:x,formatHoursLabel:g})})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h5",{className:"task-title",style:{color:B},children:j}),(0,o.jsx)("p",{className:"task-description",children:f})]}),(0,o.jsxs)("div",{className:"task-metadata",children:[(0,o.jsxs)("div",{className:"task-metadata-item",children:[(0,o.jsx)("strong",{children:"Created"}),(0,o.jsx)("span",{children:(0,l.fw)(t.createdAt)})]}),(0,o.jsxs)("div",{className:"task-metadata-item",children:[(0,o.jsx)("strong",{children:"Deadline"}),(0,o.jsx)("span",{children:t.deadline?(0,l.fw)(t.deadline):"No deadline set"})]})]}),u&&(0,o.jsxs)("div",{className:"task-actions",children:[!c&&(0,o.jsx)("button",{className:"btn ".concat("dark"===s?"btn-outline-danger":"btn-secondary"),onClick:e=>{e.stopPropagation(),M(!0)},disabled:T,children:T?"Deleting...":"Delete"}),(0,o.jsx)("button",{className:"btn ".concat("dark"===s?"btn-outline-light":"btn-dark"),onClick:e=>{e.stopPropagation(),(async()=>{if(!j.trim()||!f.trim())return;if(E(!0),!(j!==t.title||f!==t.description||N!==t.status||w!==t.deadline||JSON.stringify(S)!==JSON.stringify(t.reminders))&&!c)return h(!1),void E(!1);const e=new Date,s=w?new Date(w):null,n=s&&s>e?(s-e)/36e5:0,l=n>0?(e=>{const s=e.some((e=>"daily"===e.type)),t=e.some((e=>"weekly"===e.type));let a=e.filter((e=>("one-time"===e.type||!e.type)&&e.remindBefore<=n));if(s&&n>0){const e=Math.floor(n/24);for(let s=1;s<=e;s++)a.push({remindBefore:24*s,sent:!1,type:"daily",dayNumber:s})}if(t&&n>0){const e=Math.floor(n/168);for(let s=1;s<=e;s++)a.push({remindBefore:24*s*7,sent:!1,type:"weekly",weekNumber:s})}return a})(S):[],o={title:j.trim(),description:f.trim(),status:N,deadline:w?s.toISOString():null,reminders:l};try{if(c)d((0,a.A)((0,a.A)({},t),o));else{const e=await(0,i.lC)(t.id,o);r((s=>s.map((s=>s.id===e.data.id?e.data:s)))),h(!1)}}catch(m){console.error("Error updating task:",m)}finally{E(!1)}})()},disabled:!j.trim()||!f.trim()||T,children:T?"Saving...":"Save"})]}),!u&&L&&(0,o.jsxs)("div",{className:"reminder-indicator",title:"Reminders: ".concat(L),children:[(0,o.jsx)("i",{className:"bi bi-clock"}),(0,o.jsx)("small",{children:L})]})]})]}),(0,o.jsx)(p.A,{theme:s,show:D,title:"Delete Task",message:"Are you sure you want to delete this task? This action cannot be undone.",onConfirm:async()=>{E(!0);try{await(0,i.vq)(t.id),r((e=>e.filter((e=>e.id!==t.id)))),M(!1)}catch(e){console.error("Error deleting task:",e)}finally{E(!1),M(!1)}},onCancel:()=>M(!1)})]})},v=e=>{let{setError:s,theme:t,refreshTasks:r}=e;const{user:l}=(0,c.A)(),[d,m]=(0,n.useState)([]),[p,b]=(0,n.useState)(""),[x,g]=(0,n.useState)(!1),[v,f]=(0,n.useState)(null),k=(0,n.useRef)(null),N=(0,n.useRef)(null);(0,n.useEffect)((()=>{N.current&&N.current.focus()}),[]),(0,n.useEffect)((()=>{var e;null===(e=k.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[d,v]);const y=async()=>{if(!p.trim())return;const e={role:"user",content:p.trim(),timestamp:(new Date).toISOString()};m((s=>[...s,e])),b(""),g(!0),s(null);const t=d.map((e=>({role:e.role,content:e.content}))),n=await(0,i.gQ)(e.content,t);if(g(!1),!n.success)return void s(n.error);const{reply:r,previewUpdate:c}=n.data;c&&c.reminders&&(c.reminders=u(c.reminders,c.deadline)),m((e=>[...e,{role:"assistant",content:r,timestamp:(new Date).toISOString()}])),c&&f((0,a.A)((0,a.A)({},c),{},{_aiSuggested:!0,isUpdate:"update"===c.action||"delete"===c.action,isNewTask:"create"===c.action||c.isNewTask,createdAt:c.createdAt||(new Date).toISOString(),updatedAt:(new Date).toISOString()}))},w=async e=>{try{if(!e)return;g(!0),s(null);const t=u(e.reminders||[],e.deadline);let a="";"delete"===e.action?(await(0,i.vq)(e.id),a='\ud83d\uddd1\ufe0f Deleted task "'.concat(e.title,'".')):"create"===e.action?(await(0,i.UT)({title:e.title,description:e.description,status:e.status,deadline:e.deadline,reminders:t}),a='\u2728 Created new task "'.concat(e.title,'".')):(await(0,i.lC)(e.id,{title:e.title,description:e.description,status:e.status,deadline:e.deadline,reminders:t}),a='\u2705 Updated task "'.concat(e.title,'".')),await r(),f(null),m((e=>[...e,{role:"assistant",content:a,timestamp:(new Date).toISOString()}]))}catch(t){console.error("Error applying AI update:",t),s("Failed to apply update.")}finally{g(!1)}},C=()=>f(null);return(0,o.jsxs)("div",{className:"chat-mode",children:[(0,o.jsxs)("div",{className:"chat-messages",children:[0!==d.length||v?d.map(((e,s)=>(0,o.jsx)(h,{msg:e,user:l,theme:t},s))):(0,o.jsxs)("div",{className:"chat-empty-state",children:[(0,o.jsx)("i",{className:"bi bi-chat-heart"}),(0,o.jsx)("p",{children:"Start a conversation with AI"}),(0,o.jsx)("small",{children:"Ask questions or describe your task step by step"})]}),v&&(0,o.jsxs)("div",{className:"chat-message assistant",children:[(0,o.jsx)("div",{className:"message-avatar",children:(0,o.jsx)("i",{className:"bi bi-robot"})}),(0,o.jsx)("div",{className:"message-content w-100",children:"delete"===v.action?(0,o.jsxs)("div",{className:"ai-delete-preview p-3 rounded ".concat("dark"===t?"bg-dark text-light":"bg-light text-dark"),children:[(0,o.jsxs)("h6",{className:"mb-2",children:["\ud83d\uddd1\ufe0f Confirm delete: ",(0,o.jsx)("strong",{children:v.title}),"?"]}),(0,o.jsxs)("div",{className:"d-flex gap-2",children:[(0,o.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>w(v),disabled:x,children:x?"Deleting...":"Delete"}),(0,o.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:C,disabled:x,children:"Cancel"})]})]}):(0,o.jsx)(j,{theme:t,task:(0,a.A)((0,a.A)({},v),{},{title:v.title||"",description:v.description||"",reminders:Array.isArray(v.reminders)?v.reminders:[]}),isNewTask:!0,onSave:w,onCancel:C})})]}),x&&(0,o.jsxs)("div",{className:"chat-message assistant",children:[(0,o.jsx)("div",{className:"message-avatar",children:(0,o.jsx)("i",{className:"bi bi-robot"})}),(0,o.jsx)("div",{className:"message-content",children:(0,o.jsxs)("div",{className:"typing-indicator",children:[(0,o.jsx)("span",{}),(0,o.jsx)("span",{}),(0,o.jsx)("span",{})]})})]}),(0,o.jsx)("div",{ref:k})]}),(0,o.jsxs)("div",{className:"chat-input-container",children:[(0,o.jsx)("input",{ref:N,type:"text",className:"form-control",value:p,onChange:e=>b(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),y())},placeholder:"Type your message...",disabled:x}),(0,o.jsx)("button",{className:"send-button",onClick:y,disabled:!p.trim()||x,children:(0,o.jsx)("i",{className:"bi bi-send-fill"})})]}),(0,o.jsxs)("div",{className:"chat-actions",children:[(0,o.jsxs)("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>{m([]),s(null),f(null)},disabled:x||0===d.length,children:[(0,o.jsx)("i",{className:"bi bi-arrow-clockwise me-1"})," Reset"]}),(0,o.jsxs)("button",{className:"btn btn-sm btn-primary",onClick:async()=>{if(0===d.length)return void s("No conversation found to generate task from");g(!0),s(null);const e=d.map((e=>"".concat("user"===e.role?"User":"Assistant",": ").concat(e.content))).join("\n"),t="Based on this conversation, create a task:\n\n".concat(e,"\n\nCreate a detailed task with appropriate deadline and reminders."),n=await(0,i.Pr)(t);if(g(!1),!n.success)return void s(n.error);const r=n.data;f((0,a.A)((0,a.A)({},r),{},{id:"temp-".concat(Date.now()),status:r.status||"not-started",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),priority:1,_aiSuggested:!0,isNewTask:!0,action:"create"}))},disabled:x||0===d.length,children:[(0,o.jsx)("i",{className:"bi bi-eye me-1"})," Preview"]})]})]})},f=e=>{let{theme:s,task:t,onClose:a,onSave:n}=e;return(0,o.jsx)("div",{className:"ai-preview-overlay",onClick:a,children:(0,o.jsxs)("div",{className:"ai-preview-modal",onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("h5",{className:"mb-3",children:[(0,o.jsx)("i",{className:"bi bi-eye"})," Task Preview"]}),(0,o.jsx)(j,{theme:s,task:t,isNewTask:!0,onSave:n,onCancel:a}),(0,o.jsx)("div",{className:"text-end mt-2",children:(0,o.jsx)("button",{className:"btn btn-secondary",onClick:a,children:"Cancel"})})]})})},k=e=>{let{show:s,onClose:t,onTaskGenerated:a,theme:r,refreshTasks:i}=e;const[c,l]=(0,n.useState)("quick"),[d,u]=(0,n.useState)(null),[h,p]=(0,n.useState)(null);return s?(0,o.jsxs)("div",{className:"ai-modal-overlay",onClick:t,children:[(0,o.jsxs)("div",{className:"ai-modal-content ".concat("dark"===r?"dark-mode":""),onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("div",{className:"ai-modal-header",children:[(0,o.jsxs)("h3",{children:[(0,o.jsx)("i",{className:"bi bi-robot"})," AI Task Assistant"]}),(0,o.jsx)("button",{className:"close-button",onClick:t,children:(0,o.jsx)("i",{className:"bi bi-x-lg"})})]}),(0,o.jsxs)("div",{className:"ai-mode-selector",children:[(0,o.jsxs)("button",{className:"mode-button ".concat("quick"===c?"active":""),onClick:()=>l("quick"),children:[(0,o.jsx)("i",{className:"bi bi-lightning-charge"})," Quick Generate"]}),(0,o.jsxs)("button",{className:"mode-button ".concat("chat"===c?"active":""),onClick:()=>l("chat"),children:[(0,o.jsx)("i",{className:"bi bi-chat-dots"})," Chat Mode"]})]}),h&&(0,o.jsxs)("div",{className:"error-banner",children:[(0,o.jsx)("i",{className:"bi bi-exclamation-triangle"})," ",h]}),"quick"===c?(0,o.jsx)(m,{setError:p,setPreviewTask:u,onTaskGenerated:a,onClose:t,theme:r}):(0,o.jsx)(v,{setError:p,theme:r,refreshTasks:i,onClose:t})]}),d&&(0,o.jsx)(f,{theme:r,task:d,onClose:()=>u(null),onSave:e=>{a(e),u(null),t()}})]}):null};var N=t(585),y=t(648),w=t(24);const C=e=>{let{task:s,theme:t,isDraggingAny:n}=e;const{attributes:r,listeners:i,setNodeRef:c,transform:l,transition:m,isDragging:u}=(0,y.gl)({id:s.id,transition:{duration:250,easing:"cubic-bezier(0.25, 0.8, 0.25, 1)"}}),h={transform:w.Ks.Transform.toString(l),transition:m||"transform 250ms cubic-bezier(0.25, 0.8, 0.25, 1)",opacity:u?0:1};return(0,o.jsxs)("div",{ref:c,style:h,className:"sortable-task-wrapper",children:[(0,o.jsx)("div",(0,a.A)((0,a.A)((0,a.A)({},r),i),{},{className:"drag-handle",children:(0,o.jsx)("i",{className:"bi bi-grip-vertical"})})),(0,o.jsx)("div",{className:"task-content-wrapper",children:(0,o.jsx)(d,{theme:t,task:s})})]})},S=e=>{let{theme:s}=e;const t=(0,r.Zp)(),{user:l,logout:m}=(0,c.A)(),[u,h]=(0,n.useState)(null),[p,b]=(0,n.useState)(!1),[x,g]=(0,n.useState)(null),[j,v]=(0,n.useState)(!1);(0,n.useEffect)((()=>{const e=()=>{v(window.innerWidth<=768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]);const f=(0,N.FR)((0,N.MS)(N.cA,{activationConstraint:{distance:8}}),(0,N.MS)(N.IG,{activationConstraint:{delay:300,tolerance:8}}),(0,N.MS)(N.AN,{activationConstraint:{distance:8}})),w=(0,n.useCallback)((async()=>{if(l)try{const e=await(0,i.j)();h(e.data)}catch(e){console.error("Error loading tasks:",e),e.response&&403===e.response.status&&m()}}),[l,m]);(0,n.useEffect)((()=>{w()}),[w]);if(!u)return(0,o.jsx)("div",{className:"container mt-5",children:(0,o.jsx)("div",{className:"task-container",children:(0,o.jsxs)("div",{className:"card-body p-3",children:[(0,o.jsxs)("div",{className:"header-container",children:[(0,o.jsx)("h2",{className:"card-title mb-0",children:"Your Tasks"}),(0,o.jsxs)("div",{className:"button-group",children:[(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===s?"light":"dark"," ai-button"),disabled:!0,children:[(0,o.jsx)("i",{className:"bi bi-robot"}),(0,o.jsx)("span",{className:"button-text",children:"AI Assistant"})]}),(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===s?"light":"dark"),disabled:!0,children:[(0,o.jsx)("i",{className:"bi bi-plus-circle"}),(0,o.jsx)("span",{className:"button-text",children:"New Task"})]})]})]}),(0,o.jsx)("div",{className:"shimmer-list",children:Array.from({length:5}).map(((e,s)=>(0,o.jsxs)("div",{className:"shimmer-task-item",children:[(0,o.jsx)("div",{className:"shimmer-task-header"}),(0,o.jsx)("div",{className:"shimmer-task-body"}),(0,o.jsx)("div",{className:"shimmer-task-body"})]},s)))})]})})});const S=[...u].sort(((e,s)=>e.priority-s.priority)),A=x?u.find((e=>e.id===x)):null;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"container mt-5",children:(0,o.jsx)("div",{className:"task-container",children:(0,o.jsxs)("div",{className:"card-body p-3",children:[(0,o.jsxs)("div",{className:"header-container",children:[(0,o.jsx)("h2",{className:"card-title mb-0",children:"Your Tasks"}),(0,o.jsxs)("div",{className:"button-group",children:[(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===s?"light":"dark"," ai-button"),onClick:()=>b(!0),children:[(0,o.jsx)("i",{className:"bi bi-robot"}),(0,o.jsx)("span",{className:"button-text",children:"AI Assistant"})]}),(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===s?"light":"dark"),onClick:()=>{t("/tasks/new/edit")},children:[(0,o.jsx)("i",{className:"bi bi-plus-circle"}),(0,o.jsx)("span",{className:"button-text",children:"New Task"})]})]})]}),0===u.length?(0,o.jsxs)("div",{className:"empty-state",children:[(0,o.jsx)("i",{className:"bi bi-clipboard-check empty-state-icon"}),(0,o.jsx)("p",{className:"text-".concat("dark"===s?"light":"muted"," mb-2"),children:"No tasks yet"}),(0,o.jsx)("small",{className:"text-muted",children:"Create your first task or use AI Assistant to get started"})]}):(0,o.jsxs)(N.Mp,{sensors:f,collisionDetection:N.fp,onDragStart:e=>{g(e.active.id),document.body.classList.add("dragging-active")},onDragEnd:async e=>{const{active:s,over:t}=e;g(null),document.body.classList.remove("dragging-active"),t&&s.id!==t.id&&h((e=>{const n=e.findIndex((e=>e.id===s.id)),r=e.findIndex((e=>e.id===t.id));if(-1===n||-1===r)return e;const c=(0,y.be)(e,n,r),l=c.map(((e,s)=>{const t=s+1;return e.priority!==t?(0,i.vF)(e.id,t).catch((s=>{console.error("Error updating priority for task ".concat(e.id,":"),s)})):Promise.resolve()}));return Promise.all(l),c.map(((e,s)=>(0,a.A)((0,a.A)({},e),{},{priority:s+1})))}))},onDragCancel:()=>{g(null),document.body.classList.remove("dragging-active")},children:[(0,o.jsx)(y.gB,{items:S.map((e=>e.id)),strategy:y.kL,children:(0,o.jsx)("div",{className:"task-list ".concat(x?"is-dragging":""),children:S.map((e=>(0,o.jsx)(C,{task:e,theme:s,isDraggingAny:!!x},e.id)))})}),(0,o.jsx)(N.Hd,{adjustScale:!1,dropAnimation:{duration:300,easing:"cubic-bezier(0.25, 0.8, 0.25, 1)"},children:A?(0,o.jsx)("div",{className:"drag-overlay-card",children:(0,o.jsx)(d,{theme:s,task:A})}):null})]})]})})}),(0,o.jsx)(k,{show:p,onClose:()=>b(!1),onTaskGenerated:e=>{t("/tasks/new/edit",{state:{task:e}})},theme:s,refreshTasks:async()=>{try{const e=await(0,i.j)();return h(e.data),e.data}catch(e){console.error("Error refreshing tasks:",e)}}})]})}},433:(e,s,t)=>{t.d(s,{A:()=>l});var a=t(43),n=t(579);const r=e=>{let{value:s,label:t,checked:a,onChange:r,className:i="",disabled:c=!1}=e;return(0,n.jsx)("div",{className:"d-inline-block ".concat(i),children:(0,n.jsxs)("label",{className:"reminder-checkbox-label d-inline-flex align-items-center ".concat(c?"disabled":""),children:[(0,n.jsx)("input",{type:"checkbox",className:"form-check-input me-2",checked:a,onChange:e=>!c&&r(e.target.checked),disabled:c,"aria-label":"Set reminder for ".concat(t),"aria-describedby":"reminder-".concat(s,"-desc")}),(0,n.jsx)("span",{id:"reminder-".concat(s,"-desc"),children:t})]})})};var i=t(291);const c=e=>{if(e<1)return"".concat(Math.round(60*e)," min");if(e<24)return"".concat(e%1===0?e:e.toFixed(1)," hr").concat(1!==e?"s":"");const s=e/24;if(s<7)return"".concat(s%1===0?s:s.toFixed(1)," day").concat(1!==s?"s":"");const t=s/7;return"".concat(t%1===0?t:t.toFixed(1)," week").concat(1!==t?"s":"")},l=e=>{let{tempDeadline:s,tempReminders:t,setTempReminders:l,theme:o,ALL_INTERVALS:d}=e;const[m,u]=(0,a.useState)(""),[h,p]=(0,a.useState)(!1),b=new Date,x=s?new Date(s):null,g=x&&x>b?(x-b)/36e5:0,j=e=>!e.type||"one-time"===e.type,v=t.some((e=>"daily"===e.type)),f=t.some((e=>"weekly"===e.type)),k=d.filter((e=>e.value<=g)),N=t.filter((e=>{if(!j(e))return!1;if(e.remindBefore>g)return!1;return!d.some((s=>Math.abs(s.value-e.remindBefore)<.01))})).map((e=>{if(e.customDate)try{const s=new Date(e.customDate);return{value:e.remindBefore,label:s.toLocaleString(),customDate:e.customDate}}catch(s){console.warn("Error formatting customDate:",s)}if(x){const s=new Date(x.getTime()-36e5*e.remindBefore);return{value:e.remindBefore,label:s.toLocaleString()}}return{value:e.remindBefore,label:c(e.remindBefore)}})),y=(e,s)=>{l((t=>{if(s){return t.find((s=>j(s)&&Math.abs(s.remindBefore-e)<.01))?t:[...t,{remindBefore:e,sent:!1,type:"one-time"}]}return t.filter((s=>!j(s)||Math.abs(s.remindBefore-e)>=.01))}))},w=Math.floor(g/24),C=Math.floor(g/168);return(0,n.jsxs)("div",{className:"task-reminders-container",children:[(0,n.jsx)("div",{className:"reminders-dropdown",onClick:()=>p(!h),children:(0,n.jsxs)("div",{className:"reminders-dropdown-header",children:[(0,n.jsxs)("h6",{children:[(0,n.jsx)("i",{className:"bi bi-clock"})," Reminders",t.length>0&&(0,n.jsx)("span",{className:"reminder-count-badge",children:t.length})]}),h?(0,n.jsx)("i",{className:"bi bi-chevron-up"}):(0,n.jsx)("i",{className:"bi bi-chevron-down"})]})}),h&&(0,n.jsxs)("div",{className:"reminders-dropdown-content",children:[(w>0||C>0)&&(0,n.jsxs)("div",{className:"recurring-reminders-section",children:[(0,n.jsxs)("label",{className:"reminder-section-label",children:[(0,n.jsx)("i",{className:"bi bi-arrow-repeat"})," Recurring Reminders:"]}),(0,n.jsxs)("div",{className:"recurring-options",children:[w>0&&(0,n.jsxs)("div",{className:"recurring-option",children:[(0,n.jsx)("input",{type:"checkbox",checked:v,onChange:e=>{return s=e.target.checked,void l((e=>s?[...e.filter((e=>"daily"!==e.type)),{remindBefore:24,sent:!1,type:"daily"}]:e.filter((e=>"daily"!==e.type))));var s},id:"daily-reminders"}),(0,n.jsxs)("label",{htmlFor:"daily-reminders",children:["Every Day (up to ",w," reminder",1!==w?"s":"",")"]})]}),C>0&&(0,n.jsxs)("div",{className:"recurring-option",children:[(0,n.jsx)("input",{type:"checkbox",checked:f,onChange:e=>{return s=e.target.checked,void l((e=>s?[...e.filter((e=>"weekly"!==e.type)),{remindBefore:168,sent:!1,type:"weekly"}]:e.filter((e=>"weekly"!==e.type))));var s},id:"weekly-reminders"}),(0,n.jsxs)("label",{htmlFor:"weekly-reminders",children:["Every Week (up to ",C," reminder",1!==C?"s":"",")"]})]})]})]}),k.length>0&&(0,n.jsxs)("div",{className:"reminder-section",children:[(0,n.jsxs)("label",{className:"reminder-section-label",children:[(0,n.jsx)("i",{className:"bi bi-bell"})," One-time Reminders:"]}),(0,n.jsx)("div",{className:"reminder-grid",children:k.map((e=>{const s=!!t.find((s=>j(s)&&Math.abs(s.remindBefore-e.value)<.01));return(0,n.jsx)(r,{value:e.value,label:e.label,checked:s,onChange:s=>y(e.value,s)},e.value)}))})]}),(0,n.jsxs)("div",{className:"custom-reminder-section",children:[(0,n.jsxs)("label",{className:"reminder-section-label",children:[(0,n.jsx)("i",{className:"bi bi-calendar-plus"})," Add Custom Reminder:"]}),(0,n.jsxs)("div",{className:"custom-reminder-input-group",children:[(0,n.jsx)("input",{type:"datetime-local",value:m,onChange:e=>u(e.target.value),min:(0,i.wM)(b.toISOString()),max:s?(0,i.wM)(s):void 0}),(0,n.jsxs)("button",{className:"btn btn-sm ".concat("dark"===o?"btn-outline-light":"btn-outline-dark"),onClick:()=>{if(!m)return;const e=new Date(m);if(isNaN(e.getTime()))return void console.warn("Invalid date selected");if(!x||e>=x)return void console.warn("Custom reminder must be before deadline");if(e<=b)return void console.warn("Custom reminder must be in the future");const s=(x-e)/36e5;s>0&&s<=g&&(l((t=>t.some((e=>j(e)&&Math.abs(e.remindBefore-s)<.01))?t:[...t,{remindBefore:s,sent:!1,type:"one-time",customDate:e.toISOString()}])),u(""))},disabled:!m,children:[(0,n.jsx)("i",{className:"bi bi-plus-lg"})," Add"]})]})]}),N.length>0&&(0,n.jsxs)("div",{className:"reminder-section",children:[(0,n.jsxs)("label",{className:"reminder-section-label",children:[(0,n.jsx)("i",{className:"bi bi-calendar-check"})," Custom One-time Reminders:"]}),(0,n.jsx)("div",{className:"reminder-grid",children:N.map(((e,s)=>{const a=!!t.find((s=>j(s)&&Math.abs(s.remindBefore-e.value)<.01));return(0,n.jsx)(r,{value:e.value,label:e.label,checked:a,onChange:s=>y(e.value,s)},e.customDate||"".concat(e.value,"-").concat(s))}))})]}),t.length>0&&(0,n.jsx)("div",{className:"active-reminders-summary",children:(0,n.jsxs)("small",{children:[(0,n.jsx)("i",{className:"bi bi-info-circle"})," ",(0,n.jsx)("strong",{children:"Active:"}),v&&" Daily",v&&f&&",",f&&" Weekly",(v||f)&&t.filter(j).length>0&&",",t.filter(j).length>0&&" ".concat(t.filter(j).length," one-time")]})})]})]})}},505:(e,s,t)=>{t.d(s,{A7:()=>p,DY:()=>h,E$:()=>v,J2:()=>b,Lx:()=>m,Pr:()=>k,U0:()=>x,UT:()=>c,XL:()=>u,ec:()=>j,gQ:()=>N,iV:()=>i,j:()=>r,lC:()=>l,r7:()=>f,vF:()=>d,vq:()=>o,xw:()=>g});const a=t(722).A.create({baseURL:"https://task-manager-sigma-ashen.vercel.app/api",headers:{"ngrok-skip-browser-warning":"true"},timeout:3e4});a.interceptors.request.use((e=>{const s=localStorage.getItem("token");return s&&(e.headers.Authorization="Bearer ".concat(s)),e}),(e=>Promise.reject(e)));const n=e=>{var s;return e.response?{message:(null===(s=e.response.data)||void 0===s?void 0:s.error)||"An error occurred",status:e.response.status}:e.request?{message:"No response from server. Please check your connection.",status:0}:{message:e.message||"An unexpected error occurred",status:-1}},r=()=>a.get("/tasks"),i=e=>a.get("/tasks/".concat(e)),c=e=>a.post("/tasks",e),l=(e,s)=>a.put("/tasks/".concat(e),s),o=e=>a.delete("/tasks/".concat(e)),d=(e,s)=>a.put("/tasks/".concat(e,"/priority"),{priority:s}),m=(e,s)=>a.post("/auth/login",{email:e,password:s}),u=async e=>a.post("/auth/google",{code:e}),h=(e,s,t,n)=>a.post("/auth/register",{firstName:e,lastName:s,email:t,password:n}),p=(e,s)=>a.post("/auth/verify-registration",{email:e,verificationCode:s}),b=e=>a.post("/auth/resend-verification",{email:e}),x=e=>a.post("/auth/forgot-password",{email:e}),g=(e,s,t)=>a.post("/auth/verify-code",{email:e,verificationCode:s,newPassword:t}),j=(e,s)=>a.post("/auth/change-password",{currentPassword:e,newPassword:s}),v=async()=>{try{return(await a.get("/profile")).data}catch(e){throw console.error("Error fetching profile:",e),e}},f=async e=>{try{return(await a.put("/profile",e,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(s){throw console.error("Error updating profile:",s),s}},k=async e=>{try{const s=Intl.DateTimeFormat().resolvedOptions().timeZone;return{success:!0,data:(await a.post("/ai/chat",{prompt:e},{headers:{"x-user-timezone":s}})).data}}catch(s){return{success:!1,error:n(s).message}}},N=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{const t=Intl.DateTimeFormat().resolvedOptions().timeZone;return{success:!0,data:(await a.post("/ai/chat-conversation",{message:e,conversationHistory:s},{headers:{"x-user-timezone":t}})).data}}catch(t){return{success:!1,error:n(t).message}}}},291:(e,s,t)=>{t.d(s,{Ic:()=>r,fw:()=>n,wM:()=>i});var a=t(535);const n=e=>{const s=new Date(e),t=new Date,n=Math.floor((t-s)/1e3);if(n<0){const e=Math.abs(n);return e<60?"Just now":e<60?"in ".concat(e," second").concat(1!==e?"s":""):e<3600?"in ".concat(Math.ceil(e/60)," minute").concat(1!==Math.ceil(e/60)?"s":""):e<86400?"in ".concat(Math.ceil(e/3600)," hour").concat(1!==Math.ceil(e/3600)?"s":""):e<604800?"in ".concat(Math.ceil(e/86400)," day").concat(1!==Math.ceil(e/86400)?"s":""):(0,a.GP)(s,"MMM dd, yyyy")}if(n<60)return"Just now";if(n<60)return"".concat(n," second").concat(1!==n?"s":""," ago");if(n<3600)return"".concat(Math.floor(n/60)," minute").concat(1!==Math.floor(n/60)?"s":""," ago");if(n<86400)return"".concat(Math.floor(n/3600)," hour").concat(1!==Math.floor(n/3600)?"s":""," ago");if(n<604800){const e=Math.floor(n/86400);return 1===e?"Yesterday":"".concat(e," days ago")}return(0,a.GP)(s,"MMM dd, yyyy")},r=e=>{const[s,t,a]=e.split("-").map(Number),n=new Date(s,t-1,a);if(isNaN(n))return"Invalid Date";return n.toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric"})},i=e=>{const s=new Date(e),t=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),n=String(s.getDate()).padStart(2,"0"),r=String(s.getHours()).padStart(2,"0"),i=String(s.getMinutes()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(n,"T").concat(r,":").concat(i)}}}]);
//# sourceMappingURL=821.be116d1d.chunk.js.map