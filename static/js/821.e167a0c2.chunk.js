"use strict";(self.webpackChunktask_manager_frontend=self.webpackChunktask_manager_frontend||[]).push([[821],{869:(e,t,s)=>{s.d(t,{A:()=>n});s(43),s(421);var a=s(579);const n=e=>{let{theme:t,show:s,title:n="Confirm Action",message:r="Are you sure you want to proceed?",onConfirm:i,onCancel:c}=e;return s?(0,a.jsx)("div",{className:"custom-modal-overlay d-flex align-items-center justify-content-center",tabIndex:"-1",role:"dialog",onClick:c,children:(0,a.jsxs)("div",{className:"custom-modal-content",role:"document",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"custom-modal-header",children:[(0,a.jsx)("h5",{className:"modal2-title fw-bold",children:n}),(0,a.jsx)("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:c})]}),(0,a.jsx)("div",{className:"custom-modal-body",children:(0,a.jsx)("p",{className:"text-".concat("dark"===t?"light":"muted"," mb-4"),children:r})}),(0,a.jsxs)("div",{className:"custom-modal-footer d-flex justify-content-end gap-2",children:[(0,a.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:c,children:"Cancel"}),(0,a.jsx)("button",{type:"button",className:"btn sign-in-btn",onClick:i,children:"Confirm"})]})]})}):null}},821:(e,t,s)=>{s.r(t),s.d(t,{default:()=>S});var a=s(555),n=s(43),r=s(216),i=s(505),c=s(729),l=s(291),o=s(579);const d=e=>{let{theme:t,task:s}=e;const a=(0,r.Zp)(),n=(e=>{switch(e){case"completed":return"#007a00";case"in-progress":return"#daa520";default:return"#a00000"}})(s.status),i=(()=>{if(!s.reminders||0===s.reminders.length)return null;const e=s.reminders.filter((e=>"daily"===e.type)).length,t=s.reminders.filter((e=>"weekly"===e.type)).length,a=s.reminders.filter((e=>"one-time"===e.type||!e.type)).length,n=[];return e>0&&n.push("Daily (".concat(e,")")),t>0&&n.push("Weekly (".concat(t,")")),a>0&&n.push("One-time (".concat(a,")")),n.length>0?n.join(", "):null})();return(0,o.jsxs)("div",{className:"task-card ".concat("dark"===t?"dark":""),onClick:()=>{a("/tasks/".concat(s.id,"/edit"))},children:[(0,o.jsx)("div",{className:"task-strip",style:{backgroundColor:n}}),(0,o.jsxs)("div",{className:"task-card-content",children:[(0,o.jsx)("i",{className:"bi ".concat("completed"===s.status?"bi-check-circle":"in-progress"===s.status?"bi-hourglass":"bi-ban"," status-icon"),style:{color:n}}),(0,o.jsx)("h5",{className:"task-title",style:{color:n},children:s.title}),(0,o.jsx)("p",{className:"task-description",children:s.description}),(0,o.jsxs)("div",{className:"task-metadata",children:[(0,o.jsxs)("div",{className:"task-metadata-item",children:[(0,o.jsx)("strong",{children:"Created"}),(0,o.jsx)("span",{children:(0,l.fw)(s.createdAt)})]}),(0,o.jsxs)("div",{className:"task-metadata-item",children:[(0,o.jsx)("strong",{children:"Deadline"}),(0,o.jsx)("span",{children:s.deadline?(0,l.fw)(s.deadline):"No deadline set"})]})]}),i&&(0,o.jsxs)("div",{className:"reminder-indicator",title:"Reminders: ".concat(i),children:[(0,o.jsx)("i",{className:"bi bi-clock"}),(0,o.jsx)("small",{children:i})]})]})]})},m=e=>{let{setError:t,onClose:s}=e;const a=(0,r.Zp)(),[c,l]=(0,n.useState)(""),[d,m]=(0,n.useState)(!1),u=(0,n.useRef)(null);(0,n.useEffect)((()=>{u.current&&u.current.focus()}),[]);const h=async()=>{if(!c.trim())return;m(!0),t(null);const e=await(0,i.Pr)(c);if(m(!1),!e.success)return void t(e.error);const n=e.data,r={title:n.title,description:n.description,status:n.status||"not-started",deadline:n.deadline,reminders:n.reminders||[]};s(),a("/tasks/new/edit",{state:{task:r}})};return(0,o.jsxs)("div",{className:"quick-mode",children:[(0,o.jsxs)("div",{className:"quick-mode-content",children:[(0,o.jsx)("label",{className:"form-label",children:"Describe your task:"}),(0,o.jsx)("textarea",{ref:u,className:"form-control",rows:4,value:c,onChange:e=>l(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),h())},placeholder:"E.g., 'Prepare project report by Friday 5PM with reminders 1 day and 1 hour before'",disabled:d}),(0,o.jsxs)("div",{className:"quick-mode-suggestions",children:[(0,o.jsx)("small",{children:"Try these:"}),["Schedule dentist appointment next Tuesday at 3pm","Plan weekend shopping with 1 day reminder","Prepare presentation for Monday with daily reminders"].map((e=>(0,o.jsx)("button",{className:"suggestion-chip",onClick:()=>l(e),disabled:d,children:e},e)))]})]}),(0,o.jsxs)("div",{className:"modal-actions",children:[(0,o.jsx)("button",{className:"btn btn-secondary",onClick:s,disabled:d,children:"Cancel"}),(0,o.jsx)("button",{className:"btn btn-primary",onClick:h,disabled:!c.trim()||d,children:d?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"spinner-border spinner-border-sm me-2"})," ","Generating..."]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("i",{className:"bi bi-magic me-2"})," Generate Task"]})})]})]})},u=(e,t)=>{if(!Array.isArray(e)||!t)return e;const s=new Date(t);return e.map((e=>{if(e.remindBefore&&!e.customDate)return e;if(e.customDate){const t=new Date(e.customDate);if(!isNaN(t.getTime())&&t<s){const n=(s-t)/36e5;return(0,a.A)((0,a.A)({},e),{},{remindBefore:n})}}return e}))},h=e=>{var t,s,a,n;let{msg:r,user:i,theme:c}=e;const l=i.avatar,d=((null===(t=i.firstName)||void 0===t||null===(s=t[0])||void 0===s?void 0:s.toUpperCase())||"")+((null===(a=i.lastName)||void 0===a||null===(n=a[0])||void 0===n?void 0:n.toUpperCase())||"")||"?";return(0,o.jsxs)("div",{className:"chat-message ".concat(r.role),children:[(0,o.jsx)("div",{className:"message-avatar",children:"user"===r.role?l?(0,o.jsx)("img",{src:l,alt:"User",style:{width:"32px",height:"32px",borderRadius:"50%",objectFit:"cover",border:"dark"===c?"1px solid #fff":"1px solid #000"}}):(0,o.jsx)("div",{style:{width:"32px",height:"32px",borderRadius:"50%",backgroundColor:"#6c757d",color:"#fff",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.9rem",border:"dark"===c?"1px solid #fff":"1px solid #000"},children:d}):(0,o.jsx)("i",{className:"bi bi-robot"})}),(0,o.jsxs)("div",{className:"message-content",children:[(0,o.jsx)("div",{className:"message-text",children:r.content}),(0,o.jsx)("div",{className:"message-time",children:new Date(r.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})};s(421);var p=s(869),x=s(433);const b=[{value:1,label:"1 hr"},{value:24,label:"1 day"},{value:168,label:"1 week"}];function g(e){return e<1?"".concat(Math.round(60*e)," min"):Number.isInteger(e)?"".concat(e," hr").concat(e>1?"s":""):"".concat(e," hrs")}const j=e=>{let{theme:t,task:s,setTasks:r,isNewTask:c=!1,onSave:d=()=>{},onCancel:m=()=>{}}=e;const[u,h]=(0,n.useState)(c),[j,f]=(0,n.useState)(s.title),[v,k]=(0,n.useState)(s.description),[N,y]=(0,n.useState)(s.status),[w,C]=(0,n.useState)(s.deadline||null),[S,A]=(0,n.useState)(Array.isArray(s.reminders)?s.reminders:[]),[D,M]=(0,n.useState)(!1),[T,E]=(0,n.useState)(!1),I=(0,n.useRef)(null);(0,n.useEffect)((()=>{Array.isArray(s.reminders)&&s.reminders.length>0&&A(s.reminders)}),[s.reminders]);const P=(0,n.useCallback)((()=>{f(s.title),k(s.description),y(s.status),C(s.deadline||null),A(Array.isArray(s.reminders)?s.reminders:[]),c?m(s.id):h(!1)}),[s.title,s.description,s.status,s.deadline,s.reminders,c,m,s.id]);(0,n.useEffect)((()=>{const e=e=>{u&&I.current&&!I.current.contains(e.target)&&P()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[u,P]);const R=(e=>{switch(e){case"completed":return"#007a00";case"in-progress":return"#daa520";default:return"#a00000"}})(s.status),B=w&&new Date(w)>new Date,F=(()=>{if(!S||0===S.length)return null;const e=S.filter((e=>"daily"===e.type)).length,t=S.filter((e=>"weekly"===e.type)).length,s=S.filter((e=>"one-time"===e.type||!e.type)).length,a=[];return e>0&&a.push("Daily (".concat(e,")")),t>0&&a.push("Weekly (".concat(t,")")),s>0&&a.push("One-time (".concat(s,")")),a.length>0?a.join(", "):null})();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{ref:I,className:"task-card ".concat("dark"===t?"dark":""," ").concat(T?"loading":""," ").concat(c?"new-task":""),onClick:()=>!u&&h(!0),children:[(0,o.jsx)("div",{className:"task-strip",style:{backgroundColor:R}}),(0,o.jsxs)("div",{className:"task-card-content",children:[!u&&(0,o.jsx)("i",{className:"bi ".concat("completed"===s.status?"bi-check-circle":"in-progress"===s.status?"bi-hourglass":"bi-ban"," status-icon"),style:{color:R}}),u?(0,o.jsxs)("div",{className:"task-form-grid",children:[(0,o.jsxs)("div",{className:"task-form-group full-width",children:[(0,o.jsx)("label",{className:"form-label",children:"Title"}),(0,o.jsx)("input",{type:"text",className:"form-control",value:j,onChange:e=>f(e.target.value),placeholder:"Enter task title..."})]}),(0,o.jsxs)("div",{className:"task-form-group full-width",children:[(0,o.jsx)("label",{className:"form-label",children:"Description"}),(0,o.jsx)("textarea",{className:"form-control",rows:3,value:v,onChange:e=>k(e.target.value),placeholder:"Enter task description..."})]}),(0,o.jsxs)("div",{className:"task-form-group",children:[(0,o.jsx)("label",{className:"form-label",children:"Status"}),(0,o.jsxs)("select",{className:"form-select",value:N,onChange:e=>y(e.target.value),children:[(0,o.jsx)("option",{value:"not-started",children:"Not Started"}),(0,o.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,o.jsx)("option",{value:"completed",children:"Completed"})]})]}),(0,o.jsxs)("div",{className:"task-form-group",children:[(0,o.jsx)("label",{className:"form-label",children:"Deadline"}),(0,o.jsx)("input",{type:"datetime-local",className:"form-control",value:w?(0,l.wM)(w):"",onChange:e=>C(e.target.value)})]}),B&&(0,o.jsx)("div",{className:"task-form-group full-width",children:(0,o.jsx)(x.A,{tempDeadline:w,tempReminders:S,setTempReminders:A,theme:t,ALL_INTERVALS:b,formatHoursLabel:g})})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h5",{className:"task-title",style:{color:R},children:j}),(0,o.jsx)("p",{className:"task-description",children:v})]}),(0,o.jsxs)("div",{className:"task-metadata",children:[(0,o.jsxs)("div",{className:"task-metadata-item",children:[(0,o.jsx)("strong",{children:"Created"}),(0,o.jsx)("span",{children:(0,l.fw)(s.createdAt)})]}),(0,o.jsxs)("div",{className:"task-metadata-item",children:[(0,o.jsx)("strong",{children:"Deadline"}),(0,o.jsx)("span",{children:s.deadline?(0,l.fw)(s.deadline):"No deadline set"})]})]}),u&&(0,o.jsxs)("div",{className:"task-actions",children:[!c&&(0,o.jsx)("button",{className:"btn ".concat("dark"===t?"btn-outline-danger":"btn-secondary"),onClick:e=>{e.stopPropagation(),M(!0)},disabled:T,children:T?"Deleting...":"Delete"}),(0,o.jsx)("button",{className:"btn ".concat("dark"===t?"btn-outline-light":"btn-dark"),onClick:e=>{e.stopPropagation(),(async()=>{if(!j.trim()||!v.trim())return;if(E(!0),!(j!==s.title||v!==s.description||N!==s.status||w!==s.deadline||JSON.stringify(S)!==JSON.stringify(s.reminders))&&!c)return h(!1),void E(!1);const e=new Date,t=w?new Date(w):null,n=t&&t>e?(t-e)/36e5:0,l=n>0?(e=>{const t=e.some((e=>"daily"===e.type)),s=e.some((e=>"weekly"===e.type));let a=e.filter((e=>("one-time"===e.type||!e.type)&&e.remindBefore<=n));if(t&&n>0){const e=Math.floor(n/24);for(let t=1;t<=e;t++)a.push({remindBefore:24*t,sent:!1,type:"daily",dayNumber:t})}if(s&&n>0){const e=Math.floor(n/168);for(let t=1;t<=e;t++)a.push({remindBefore:24*t*7,sent:!1,type:"weekly",weekNumber:t})}return a})(S):[],o={title:j.trim(),description:v.trim(),status:N,deadline:w?t.toISOString():null,reminders:l};try{if(c)d((0,a.A)((0,a.A)({},s),o));else{const e=await(0,i.lC)(s.id,o);r((t=>t.map((t=>t.id===e.data.id?e.data:t)))),h(!1)}}catch(m){console.error("Error updating task:",m)}finally{E(!1)}})()},disabled:!j.trim()||!v.trim()||T,children:T?"Saving...":"Save"})]}),!u&&F&&(0,o.jsxs)("div",{className:"reminder-indicator",title:"Reminders: ".concat(F),children:[(0,o.jsx)("i",{className:"bi bi-clock"}),(0,o.jsx)("small",{children:F})]})]})]}),(0,o.jsx)(p.A,{theme:t,show:D,title:"Delete Task",message:"Are you sure you want to delete this task? This action cannot be undone.",onConfirm:async()=>{E(!0);try{await(0,i.vq)(s.id),r((e=>e.filter((e=>e.id!==s.id)))),M(!1)}catch(e){console.error("Error deleting task:",e)}finally{E(!1),M(!1)}},onCancel:()=>M(!1)})]})},f=e=>{let{setError:t,theme:s,refreshTasks:r}=e;const{user:l}=(0,c.A)(),[d,m]=(0,n.useState)([]),[p,x]=(0,n.useState)(""),[b,g]=(0,n.useState)(!1),[f,v]=(0,n.useState)(null),k=(0,n.useRef)(null),N=(0,n.useRef)(null);(0,n.useEffect)((()=>{N.current&&N.current.focus()}),[]),(0,n.useEffect)((()=>{var e;null===(e=k.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[d,f]);const y=async()=>{if(!p.trim())return;const e={role:"user",content:p.trim(),timestamp:(new Date).toISOString()};m((t=>[...t,e])),x(""),g(!0),t(null);const s=d.map((e=>({role:e.role,content:e.content}))),n=await(0,i.gQ)(e.content,s);if(g(!1),!n.success)return void t(n.error);const{reply:r,previewUpdate:c}=n.data;c&&c.reminders&&(c.reminders=u(c.reminders,c.deadline)),m((e=>[...e,{role:"assistant",content:r,timestamp:(new Date).toISOString()}])),c&&v((0,a.A)((0,a.A)({},c),{},{_aiSuggested:!0,isUpdate:"update"===c.action||"delete"===c.action,isNewTask:"create"===c.action||c.isNewTask,createdAt:c.createdAt||(new Date).toISOString(),updatedAt:(new Date).toISOString()}))},w=async e=>{try{if(!e)return;g(!0),t(null);const s=u(e.reminders||[],e.deadline);let a="";"delete"===e.action?(await(0,i.vq)(e.id),a='\ud83d\uddd1\ufe0f Deleted task "'.concat(e.title,'".')):"create"===e.action?(await(0,i.UT)({title:e.title,description:e.description,status:e.status,deadline:e.deadline,reminders:s}),a='\u2728 Created new task "'.concat(e.title,'".')):(await(0,i.lC)(e.id,{title:e.title,description:e.description,status:e.status,deadline:e.deadline,reminders:s}),a='\u2705 Updated task "'.concat(e.title,'".')),await r(),v(null),m((e=>[...e,{role:"assistant",content:a,timestamp:(new Date).toISOString()}]))}catch(s){console.error("Error applying AI update:",s),t("Failed to apply update.")}finally{g(!1)}},C=()=>v(null);return(0,o.jsxs)("div",{className:"chat-mode",children:[(0,o.jsxs)("div",{className:"chat-messages",children:[0!==d.length||f?d.map(((e,t)=>(0,o.jsx)(h,{msg:e,user:l,theme:s},t))):(0,o.jsxs)("div",{className:"chat-empty-state",children:[(0,o.jsx)("i",{className:"bi bi-chat-heart"}),(0,o.jsx)("p",{children:"Start a conversation with AI"}),(0,o.jsx)("small",{children:"Ask questions or describe your task step by step"})]}),f&&(0,o.jsxs)("div",{className:"chat-message assistant",children:[(0,o.jsx)("div",{className:"message-avatar",children:(0,o.jsx)("i",{className:"bi bi-robot"})}),(0,o.jsx)("div",{className:"message-content w-100",children:"delete"===f.action?(0,o.jsxs)("div",{className:"ai-delete-preview p-3 rounded ".concat("dark"===s?"bg-dark text-light":"bg-light text-dark"),children:[(0,o.jsxs)("h6",{className:"mb-2",children:["\ud83d\uddd1\ufe0f Confirm delete: ",(0,o.jsx)("strong",{children:f.title}),"?"]}),(0,o.jsxs)("div",{className:"d-flex gap-2",children:[(0,o.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>w(f),disabled:b,children:b?"Deleting...":"Delete"}),(0,o.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:C,disabled:b,children:"Cancel"})]})]}):(0,o.jsx)(j,{theme:s,task:(0,a.A)((0,a.A)({},f),{},{title:f.title||"",description:f.description||"",reminders:Array.isArray(f.reminders)?f.reminders:[]}),isNewTask:!0,onSave:w,onCancel:C})})]}),b&&(0,o.jsxs)("div",{className:"chat-message assistant",children:[(0,o.jsx)("div",{className:"message-avatar",children:(0,o.jsx)("i",{className:"bi bi-robot"})}),(0,o.jsx)("div",{className:"message-content",children:(0,o.jsxs)("div",{className:"typing-indicator",children:[(0,o.jsx)("span",{}),(0,o.jsx)("span",{}),(0,o.jsx)("span",{})]})})]}),(0,o.jsx)("div",{ref:k})]}),(0,o.jsxs)("div",{className:"chat-input-container",children:[(0,o.jsx)("input",{ref:N,type:"text",className:"form-control",value:p,onChange:e=>x(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),y())},placeholder:"Type your message...",disabled:b}),(0,o.jsx)("button",{className:"send-button",onClick:y,disabled:!p.trim()||b,children:(0,o.jsx)("i",{className:"bi bi-send-fill"})})]}),(0,o.jsxs)("div",{className:"chat-actions",children:[(0,o.jsxs)("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>{m([]),t(null),v(null)},disabled:b||0===d.length,children:[(0,o.jsx)("i",{className:"bi bi-arrow-clockwise me-1"})," Reset"]}),(0,o.jsxs)("button",{className:"btn btn-sm btn-primary",onClick:async()=>{if(0===d.length)return void t("No conversation found to generate task from");g(!0),t(null);const e=d.map((e=>"".concat("user"===e.role?"User":"Assistant",": ").concat(e.content))).join("\n"),s="Based on this conversation, create a task:\n\n".concat(e,"\n\nCreate a detailed task with appropriate deadline and reminders."),n=await(0,i.Pr)(s);if(g(!1),!n.success)return void t(n.error);const r=n.data;v((0,a.A)((0,a.A)({},r),{},{id:"temp-".concat(Date.now()),status:r.status||"not-started",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),priority:1,_aiSuggested:!0,isNewTask:!0,action:"create"}))},disabled:b||0===d.length,children:[(0,o.jsx)("i",{className:"bi bi-eye me-1"})," Preview"]})]})]})},v=e=>{let{theme:t,task:s,onClose:a,onSave:n}=e;return(0,o.jsx)("div",{className:"ai-preview-overlay",onClick:a,children:(0,o.jsxs)("div",{className:"ai-preview-modal",onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("h5",{className:"mb-3",children:[(0,o.jsx)("i",{className:"bi bi-eye"})," Task Preview"]}),(0,o.jsx)(j,{theme:t,task:s,isNewTask:!0,onSave:n,onCancel:a}),(0,o.jsx)("div",{className:"text-end mt-2",children:(0,o.jsx)("button",{className:"btn btn-secondary",onClick:a,children:"Cancel"})})]})})},k=e=>{let{show:t,onClose:s,onTaskGenerated:a,theme:r,refreshTasks:i}=e;const[c,l]=(0,n.useState)("quick"),[d,u]=(0,n.useState)(null),[h,p]=(0,n.useState)(null);return t?(0,o.jsxs)("div",{className:"ai-modal-overlay",onClick:s,children:[(0,o.jsxs)("div",{className:"ai-modal-content ".concat("dark"===r?"dark-mode":""),onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("div",{className:"ai-modal-header",children:[(0,o.jsxs)("h3",{children:[(0,o.jsx)("i",{className:"bi bi-robot"})," AI Task Assistant"]}),(0,o.jsx)("button",{className:"close-button",onClick:s,children:(0,o.jsx)("i",{className:"bi bi-x-lg"})})]}),(0,o.jsxs)("div",{className:"ai-mode-selector",children:[(0,o.jsxs)("button",{className:"mode-button ".concat("quick"===c?"active":""),onClick:()=>l("quick"),children:[(0,o.jsx)("i",{className:"bi bi-lightning-charge"})," Quick Generate"]}),(0,o.jsxs)("button",{className:"mode-button ".concat("chat"===c?"active":""),onClick:()=>l("chat"),children:[(0,o.jsx)("i",{className:"bi bi-chat-dots"})," Chat Mode"]})]}),h&&(0,o.jsxs)("div",{className:"error-banner",children:[(0,o.jsx)("i",{className:"bi bi-exclamation-triangle"})," ",h]}),"quick"===c?(0,o.jsx)(m,{setError:p,setPreviewTask:u,onTaskGenerated:a,onClose:s,theme:r}):(0,o.jsx)(f,{setError:p,theme:r,refreshTasks:i,onClose:s})]}),d&&(0,o.jsx)(v,{theme:r,task:d,onClose:()=>u(null),onSave:e=>{a(e),u(null),s()}})]}):null};var N=s(585),y=s(648),w=s(24);const C=e=>{let{task:t,theme:s}=e;const{attributes:n,listeners:r,setNodeRef:i,transform:c,transition:l,isDragging:m}=(0,y.gl)({id:t.id,transition:{duration:250,easing:"cubic-bezier(0.25, 0.8, 0.25, 1)"}}),u={transform:w.Ks.Transform.toString(c),transition:l||"transform 250ms cubic-bezier(0.25, 0.8, 0.25, 1)",opacity:m?0:1,cursor:"grab",touchAction:"manipulation"};return(0,o.jsx)("div",(0,a.A)((0,a.A)((0,a.A)({ref:i,style:u},n),r),{},{children:(0,o.jsx)(d,{theme:s,task:t})}))},S=e=>{let{theme:t}=e;const s=(0,r.Zp)(),{user:l,logout:m}=(0,c.A)(),[u,h]=(0,n.useState)(null),[p,x]=(0,n.useState)(!1),[b,g]=(0,n.useState)(null),j=(0,N.FR)((0,N.MS)(N.cA,{activationConstraint:{distance:10}}),(0,N.MS)(N.IG,{activationConstraint:{delay:200,tolerance:5}}),(0,N.MS)(N.AN,{activationConstraint:{distance:10}})),f=(0,n.useCallback)((async()=>{if(l)try{const e=await(0,i.j)();h(e.data)}catch(e){console.error("Error loading tasks:",e),e.response&&403===e.response.status&&m()}}),[l,m]);(0,n.useEffect)((()=>{f()}),[f]);if(!u)return(0,o.jsx)("div",{className:"container mt-5",children:(0,o.jsx)("div",{className:"task-container",children:(0,o.jsxs)("div",{className:"card-body p-3",children:[(0,o.jsxs)("div",{className:"d-flex flex-row justify-content-between align-items-center mb-3 header-container",children:[(0,o.jsx)("h2",{className:"card-title mb-0",children:"Your Tasks"}),(0,o.jsxs)("div",{className:"d-flex gap-2 button-group",children:[(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===t?"light":"dark"," ai-button"),disabled:!0,children:[(0,o.jsx)("i",{className:"bi bi-robot me-2"}),(0,o.jsx)("span",{className:"button-text",children:"AI Assistant"})]}),(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===t?"light":"dark"," d-flex align-items-center gap-2"),disabled:!0,children:[(0,o.jsx)("i",{className:"bi bi-plus-circle"}),(0,o.jsx)("span",{className:"button-text",children:"New Task"})]})]})]}),(0,o.jsx)("div",{className:"shimmer-list",children:Array.from({length:5}).map(((e,t)=>(0,o.jsxs)("div",{className:"shimmer-task-item",children:[(0,o.jsx)("div",{className:"shimmer-task-header"}),(0,o.jsx)("div",{className:"shimmer-task-body"})]},t)))})]})})});const v=[...u].sort(((e,t)=>e.priority-t.priority)),w=b?u.find((e=>e.id===b)):null;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"container mt-5",children:(0,o.jsx)("div",{className:"task-container",children:(0,o.jsxs)("div",{className:"card-body p-3",children:[(0,o.jsxs)("div",{className:"d-flex flex-row justify-content-between align-items-center mb-3 header-container",children:[(0,o.jsx)("h2",{className:"card-title mb-0",children:"Your Tasks"}),(0,o.jsxs)("div",{className:"d-flex gap-2 button-group",children:[(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===t?"light":"dark"," ai-button"),onClick:()=>x(!0),children:[(0,o.jsx)("i",{className:"bi bi-robot me-2"}),(0,o.jsx)("span",{className:"button-text",children:"AI Assistant"})]}),(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===t?"light":"dark"," d-flex align-items-center gap-2"),onClick:()=>{s("/tasks/new/edit")},children:[(0,o.jsx)("i",{className:"bi bi-plus-circle"}),(0,o.jsx)("span",{className:"button-text",children:"New Task"})]})]})]}),0===u.length?(0,o.jsxs)("div",{className:"empty-state",children:[(0,o.jsx)("i",{className:"bi bi-clipboard-check empty-state-icon"}),(0,o.jsx)("p",{className:"text-".concat("dark"===t?"light":"muted"," mb-2"),children:"No tasks yet"}),(0,o.jsx)("small",{className:"text-muted",children:"Create your first task or use AI Assistant to get started"})]}):(0,o.jsxs)(N.Mp,{sensors:j,collisionDetection:N.fp,onDragStart:e=>{g(e.active.id)},onDragEnd:async e=>{const{active:t,over:s}=e;g(null),s&&t.id!==s.id&&h((e=>{const n=e.findIndex((e=>e.id===t.id)),r=e.findIndex((e=>e.id===s.id));if(-1===n||-1===r)return e;const c=(0,y.be)(e,n,r),l=c.map(((e,t)=>{const s=t+1;return e.priority!==s?(0,i.vF)(e.id,s).catch((t=>{console.error("Error updating priority for task ".concat(e.id,":"),t)})):Promise.resolve()}));return Promise.all(l),c.map(((e,t)=>(0,a.A)((0,a.A)({},e),{},{priority:t+1})))}))},onDragCancel:()=>{g(null)},children:[(0,o.jsx)(y.gB,{items:v.map((e=>e.id)),strategy:y.kL,children:(0,o.jsx)("div",{className:"task-list",children:v.map((e=>(0,o.jsx)(C,{task:e,theme:t},e.id)))})}),(0,o.jsx)(N.Hd,{adjustScale:!1,dropAnimation:{duration:300,easing:"cubic-bezier(0.25, 0.8, 0.25, 1)"},style:{cursor:"grabbing"},children:w?(0,o.jsx)("div",{style:{transform:"scale(1.03) rotate(2deg)",cursor:"grabbing",boxShadow:"0 12px 24px rgba(0, 0, 0, 0.25), 0 4px 8px rgba(0, 0, 0, 0.15)",borderRadius:"10px",transition:"all 150ms cubic-bezier(0.25, 0.8, 0.25, 1)"},children:(0,o.jsx)(d,{theme:t,task:w})}):null})]})]})})}),(0,o.jsx)(k,{show:p,onClose:()=>x(!1),onTaskGenerated:e=>{s("/tasks/new/edit",{state:{task:e}})},theme:t,refreshTasks:async()=>{try{const e=await(0,i.j)();return h(e.data),e.data}catch(e){console.error("Error refreshing tasks:",e)}}})]})}},433:(e,t,s)=>{s.d(t,{A:()=>l});var a=s(43),n=s(579);const r=e=>{let{value:t,label:s,checked:a,onChange:r,className:i="",disabled:c=!1}=e;return(0,n.jsx)("div",{className:"d-inline-block ".concat(i),children:(0,n.jsxs)("label",{className:"reminder-checkbox-label d-inline-flex align-items-center ".concat(c?"disabled":""),children:[(0,n.jsx)("input",{type:"checkbox",className:"form-check-input me-2",checked:a,onChange:e=>!c&&r(e.target.checked),disabled:c,"aria-label":"Set reminder for ".concat(s),"aria-describedby":"reminder-".concat(t,"-desc")}),(0,n.jsx)("span",{id:"reminder-".concat(t,"-desc"),children:s})]})})};var i=s(291);const c=e=>{if(e<1)return"".concat(Math.round(60*e)," min");if(e<24)return"".concat(e%1===0?e:e.toFixed(1)," hr").concat(1!==e?"s":"");const t=e/24;if(t<7)return"".concat(t%1===0?t:t.toFixed(1)," day").concat(1!==t?"s":"");const s=t/7;return"".concat(s%1===0?s:s.toFixed(1)," week").concat(1!==s?"s":"")},l=e=>{let{tempDeadline:t,tempReminders:s,setTempReminders:l,theme:o,ALL_INTERVALS:d}=e;const[m,u]=(0,a.useState)(""),[h,p]=(0,a.useState)(!1),x=new Date,b=t?new Date(t):null,g=b&&b>x?(b-x)/36e5:0,j=e=>!e.type||"one-time"===e.type,f=s.some((e=>"daily"===e.type)),v=s.some((e=>"weekly"===e.type)),k=d.filter((e=>e.value<=g)),N=s.filter((e=>{if(!j(e))return!1;if(e.remindBefore>g)return!1;return!d.some((t=>Math.abs(t.value-e.remindBefore)<.01))})).map((e=>{if(e.customDate)try{const t=new Date(e.customDate);return{value:e.remindBefore,label:t.toLocaleString(),customDate:e.customDate}}catch(t){console.warn("Error formatting customDate:",t)}if(b){const t=new Date(b.getTime()-36e5*e.remindBefore);return{value:e.remindBefore,label:t.toLocaleString()}}return{value:e.remindBefore,label:c(e.remindBefore)}})),y=(e,t)=>{l((s=>{if(t){return s.find((t=>j(t)&&Math.abs(t.remindBefore-e)<.01))?s:[...s,{remindBefore:e,sent:!1,type:"one-time"}]}return s.filter((t=>!j(t)||Math.abs(t.remindBefore-e)>=.01))}))},w=Math.floor(g/24),C=Math.floor(g/168);return(0,n.jsxs)("div",{className:"task-reminders-container",children:[(0,n.jsx)("div",{className:"reminders-dropdown",onClick:()=>p(!h),children:(0,n.jsxs)("div",{className:"reminders-dropdown-header",children:[(0,n.jsxs)("h6",{children:[(0,n.jsx)("i",{className:"bi bi-clock"})," Reminders",s.length>0&&(0,n.jsx)("span",{className:"reminder-count-badge",children:s.length})]}),h?(0,n.jsx)("i",{className:"bi bi-chevron-up"}):(0,n.jsx)("i",{className:"bi bi-chevron-down"})]})}),h&&(0,n.jsxs)("div",{className:"reminders-dropdown-content",children:[(w>0||C>0)&&(0,n.jsxs)("div",{className:"recurring-reminders-section",children:[(0,n.jsxs)("label",{className:"reminder-section-label",children:[(0,n.jsx)("i",{className:"bi bi-arrow-repeat"})," Recurring Reminders:"]}),(0,n.jsxs)("div",{className:"recurring-options",children:[w>0&&(0,n.jsxs)("div",{className:"recurring-option",children:[(0,n.jsx)("input",{type:"checkbox",checked:f,onChange:e=>{return t=e.target.checked,void l((e=>t?[...e.filter((e=>"daily"!==e.type)),{remindBefore:24,sent:!1,type:"daily"}]:e.filter((e=>"daily"!==e.type))));var t},id:"daily-reminders"}),(0,n.jsxs)("label",{htmlFor:"daily-reminders",children:["Every Day (up to ",w," reminder",1!==w?"s":"",")"]})]}),C>0&&(0,n.jsxs)("div",{className:"recurring-option",children:[(0,n.jsx)("input",{type:"checkbox",checked:v,onChange:e=>{return t=e.target.checked,void l((e=>t?[...e.filter((e=>"weekly"!==e.type)),{remindBefore:168,sent:!1,type:"weekly"}]:e.filter((e=>"weekly"!==e.type))));var t},id:"weekly-reminders"}),(0,n.jsxs)("label",{htmlFor:"weekly-reminders",children:["Every Week (up to ",C," reminder",1!==C?"s":"",")"]})]})]})]}),k.length>0&&(0,n.jsxs)("div",{className:"reminder-section",children:[(0,n.jsxs)("label",{className:"reminder-section-label",children:[(0,n.jsx)("i",{className:"bi bi-bell"})," One-time Reminders:"]}),(0,n.jsx)("div",{className:"reminder-grid",children:k.map((e=>{const t=!!s.find((t=>j(t)&&Math.abs(t.remindBefore-e.value)<.01));return(0,n.jsx)(r,{value:e.value,label:e.label,checked:t,onChange:t=>y(e.value,t)},e.value)}))})]}),(0,n.jsxs)("div",{className:"custom-reminder-section",children:[(0,n.jsxs)("label",{className:"reminder-section-label",children:[(0,n.jsx)("i",{className:"bi bi-calendar-plus"})," Add Custom Reminder:"]}),(0,n.jsxs)("div",{className:"custom-reminder-input-group",children:[(0,n.jsx)("input",{type:"datetime-local",value:m,onChange:e=>u(e.target.value),min:(0,i.wM)(x.toISOString()),max:t?(0,i.wM)(t):void 0}),(0,n.jsxs)("button",{className:"btn btn-sm ".concat("dark"===o?"btn-outline-light":"btn-outline-dark"),onClick:()=>{if(!m)return;const e=new Date(m);if(isNaN(e.getTime()))return void console.warn("Invalid date selected");if(!b||e>=b)return void console.warn("Custom reminder must be before deadline");if(e<=x)return void console.warn("Custom reminder must be in the future");const t=(b-e)/36e5;t>0&&t<=g&&(l((s=>s.some((e=>j(e)&&Math.abs(e.remindBefore-t)<.01))?s:[...s,{remindBefore:t,sent:!1,type:"one-time",customDate:e.toISOString()}])),u(""))},disabled:!m,children:[(0,n.jsx)("i",{className:"bi bi-plus-lg"})," Add"]})]})]}),N.length>0&&(0,n.jsxs)("div",{className:"reminder-section",children:[(0,n.jsxs)("label",{className:"reminder-section-label",children:[(0,n.jsx)("i",{className:"bi bi-calendar-check"})," Custom One-time Reminders:"]}),(0,n.jsx)("div",{className:"reminder-grid",children:N.map(((e,t)=>{const a=!!s.find((t=>j(t)&&Math.abs(t.remindBefore-e.value)<.01));return(0,n.jsx)(r,{value:e.value,label:e.label,checked:a,onChange:t=>y(e.value,t)},e.customDate||"".concat(e.value,"-").concat(t))}))})]}),s.length>0&&(0,n.jsx)("div",{className:"active-reminders-summary",children:(0,n.jsxs)("small",{children:[(0,n.jsx)("i",{className:"bi bi-info-circle"})," ",(0,n.jsx)("strong",{children:"Active:"}),f&&" Daily",f&&v&&",",v&&" Weekly",(f||v)&&s.filter(j).length>0&&",",s.filter(j).length>0&&" ".concat(s.filter(j).length," one-time")]})})]})]})}},505:(e,t,s)=>{s.d(t,{A7:()=>p,DY:()=>h,E$:()=>f,J2:()=>x,Lx:()=>m,Pr:()=>k,U0:()=>b,UT:()=>c,XL:()=>u,ec:()=>j,gQ:()=>N,iV:()=>i,j:()=>r,lC:()=>l,r7:()=>v,vF:()=>d,vq:()=>o,xw:()=>g});const a=s(722).A.create({baseURL:"https://task-manager-sigma-ashen.vercel.app/api",headers:{"ngrok-skip-browser-warning":"true"},timeout:3e4});a.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(e=>Promise.reject(e)));const n=e=>{var t;return e.response?{message:(null===(t=e.response.data)||void 0===t?void 0:t.error)||"An error occurred",status:e.response.status}:e.request?{message:"No response from server. Please check your connection.",status:0}:{message:e.message||"An unexpected error occurred",status:-1}},r=()=>a.get("/tasks"),i=e=>a.get("/tasks/".concat(e)),c=e=>a.post("/tasks",e),l=(e,t)=>a.put("/tasks/".concat(e),t),o=e=>a.delete("/tasks/".concat(e)),d=(e,t)=>a.put("/tasks/".concat(e,"/priority"),{priority:t}),m=(e,t)=>a.post("/auth/login",{email:e,password:t}),u=async e=>a.post("/auth/google",{code:e}),h=(e,t,s,n)=>a.post("/auth/register",{firstName:e,lastName:t,email:s,password:n}),p=(e,t)=>a.post("/auth/verify-registration",{email:e,verificationCode:t}),x=e=>a.post("/auth/resend-verification",{email:e}),b=e=>a.post("/auth/forgot-password",{email:e}),g=(e,t,s)=>a.post("/auth/verify-code",{email:e,verificationCode:t,newPassword:s}),j=(e,t)=>a.post("/auth/change-password",{currentPassword:e,newPassword:t}),f=async()=>{try{return(await a.get("/profile")).data}catch(e){throw console.error("Error fetching profile:",e),e}},v=async e=>{try{return(await a.put("/profile",e,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(t){throw console.error("Error updating profile:",t),t}},k=async e=>{try{const t=Intl.DateTimeFormat().resolvedOptions().timeZone;return{success:!0,data:(await a.post("/ai/chat",{prompt:e},{headers:{"x-user-timezone":t}})).data}}catch(t){return{success:!1,error:n(t).message}}},N=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{const s=Intl.DateTimeFormat().resolvedOptions().timeZone;return{success:!0,data:(await a.post("/ai/chat-conversation",{message:e,conversationHistory:t},{headers:{"x-user-timezone":s}})).data}}catch(s){return{success:!1,error:n(s).message}}}},291:(e,t,s)=>{s.d(t,{Ic:()=>r,fw:()=>n,wM:()=>i});var a=s(535);const n=e=>{const t=new Date(e),s=new Date,n=Math.floor((s-t)/1e3);if(n<0){const e=Math.abs(n);return e<60?"Just now":e<60?"in ".concat(e," second").concat(1!==e?"s":""):e<3600?"in ".concat(Math.ceil(e/60)," minute").concat(1!==Math.ceil(e/60)?"s":""):e<86400?"in ".concat(Math.ceil(e/3600)," hour").concat(1!==Math.ceil(e/3600)?"s":""):e<604800?"in ".concat(Math.ceil(e/86400)," day").concat(1!==Math.ceil(e/86400)?"s":""):(0,a.GP)(t,"MMM dd, yyyy")}if(n<60)return"Just now";if(n<60)return"".concat(n," second").concat(1!==n?"s":""," ago");if(n<3600)return"".concat(Math.floor(n/60)," minute").concat(1!==Math.floor(n/60)?"s":""," ago");if(n<86400)return"".concat(Math.floor(n/3600)," hour").concat(1!==Math.floor(n/3600)?"s":""," ago");if(n<604800){const e=Math.floor(n/86400);return 1===e?"Yesterday":"".concat(e," days ago")}return(0,a.GP)(t,"MMM dd, yyyy")},r=e=>{const[t,s,a]=e.split("-").map(Number),n=new Date(t,s-1,a);if(isNaN(n))return"Invalid Date";return n.toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric"})},i=e=>{const t=new Date(e),s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0"),r=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0");return"".concat(s,"-").concat(a,"-").concat(n,"T").concat(r,":").concat(i)}}}]);
//# sourceMappingURL=821.e167a0c2.chunk.js.map