"use strict";(self.webpackChunktask_manager_frontend=self.webpackChunktask_manager_frontend||[]).push([[694],{2891:()=>{},4505:(e,a,t)=>{t.d(a,{A7:()=>h,DY:()=>p,E$:()=>f,J2:()=>g,Lx:()=>m,Pr:()=>N,U0:()=>v,UT:()=>i,XL:()=>u,ec:()=>j,gQ:()=>w,iV:()=>n,j:()=>s,lC:()=>l,r7:()=>b,vF:()=>d,vq:()=>c,xw:()=>x});const o=t(9722).A.create({baseURL:"https://task-manager-sigma-ashen.vercel.app/api",headers:{"ngrok-skip-browser-warning":"true"},timeout:3e4});o.interceptors.request.use(e=>{const a=localStorage.getItem("token");a&&(e.headers.Authorization="Bearer ".concat(a));try{const a=Intl.DateTimeFormat().resolvedOptions().timeZone;a&&(e.headers["x-user-timezone"]=a)}catch(t){console.warn("Could not detect user timezone:",t)}return e},e=>Promise.reject(e));const r=e=>{var a;return e.response?{message:(null===(a=e.response.data)||void 0===a?void 0:a.error)||"An error occurred",status:e.response.status}:e.request?{message:"No response from server. Please check your connection.",status:0}:{message:e.message||"An unexpected error occurred",status:-1}},s=()=>o.get("/tasks"),n=e=>o.get("/tasks/".concat(e)),i=e=>o.post("/tasks",e),l=(e,a)=>o.put("/tasks/".concat(e),a),c=e=>o.delete("/tasks/".concat(e)),d=(e,a)=>o.put("/tasks/".concat(e,"/priority"),{priority:a}),m=(e,a)=>o.post("/auth/login",{email:e,password:a}),u=async e=>o.post("/auth/google",{code:e}),p=(e,a,t,r)=>o.post("/auth/register",{firstName:e,lastName:a,email:t,password:r}),h=(e,a)=>o.post("/auth/verify-registration",{email:e,verificationCode:a}),g=e=>o.post("/auth/resend-verification",{email:e}),v=e=>o.post("/auth/forgot-password",{email:e}),x=(e,a,t)=>o.post("/auth/verify-code",{email:e,verificationCode:a,newPassword:t}),j=(e,a)=>o.post("/auth/change-password",{currentPassword:e,newPassword:a}),f=async()=>{try{return(await o.get("/profile")).data}catch(e){throw console.error("Error fetching profile:",e),e}},b=async e=>{try{return(await o.put("/profile",e,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(a){throw console.error("Error updating profile:",a),a}},N=async e=>{try{const a=Intl.DateTimeFormat().resolvedOptions().timeZone;return{success:!0,data:(await o.post("/ai/chat",{prompt:e},{headers:{"x-user-timezone":a}})).data}}catch(a){return{success:!1,error:r(a).message}}},w=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];try{const t=Intl.DateTimeFormat().resolvedOptions().timeZone;return{success:!0,data:(await o.post("/ai/chat-conversation",{message:e,conversationHistory:a},{headers:{"x-user-timezone":t}})).data}}catch(t){return{success:!1,error:r(t).message}}}},8694:(e,a,t)=>{t.r(a),t.d(a,{default:()=>d});var o=t(2555),r=t(5043),s=t(3216),n=t(4505),i=t(2205),l=t(8729),c=(t(2891),t(579));const d=()=>{const[e,a]=(0,r.useState)(null),[t,d]=(0,r.useState)(null),[m,u]=(0,r.useState)(null),[p,h]=(0,r.useState)(""),[g,v]=(0,r.useState)(""),[x,j]=(0,r.useState)({x:0,y:0}),[f,b]=(0,r.useState)(1),[N,w]=(0,r.useState)(0),[y,C]=(0,r.useState)(null),[A,k]=(0,r.useState)(!1),S=(0,s.Zp)(),{logout:P}=(0,l.A)();(0,r.useEffect)(()=>{(async()=>{try{const e=await(0,n.E$)();if(!e)throw new Error("Received no data");a(e)}catch(e){h("Failed to fetch profile data: ".concat(e.message||e.toString())),e&&403===e.status&&(P(),S("/login"))}})()},[P,S]);const T=(0,r.useCallback)((e,a)=>{C(a)},[]),E=async function(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=await(r=e,new Promise((e,a)=>{const t=new Image;t.addEventListener("load",()=>e(t)),t.addEventListener("error",e=>a(e)),t.setAttribute("crossOrigin","anonymous"),t.src=r}));var r;const s=document.createElement("canvas"),n=s.getContext("2d"),i=Math.max(o.width,o.height)/2*Math.sqrt(2)*2;s.width=i,s.height=i,n.translate(i/2,i/2),n.rotate(t*Math.PI/180),n.translate(-i/2,-i/2),n.drawImage(o,i/2-.5*o.width,i/2-.5*o.height);const l=n.getImageData(0,0,i,i);return s.width=a.width,s.height=a.height,n.putImageData(l,Math.round(0-i/2+.5*o.width-a.x),Math.round(0-i/2+.5*o.height-a.y)),new Promise(e=>{s.toBlob(a=>{e(a)},"image/jpeg")})},U=t=>{const{name:r,value:s}=t.target;e&&a((0,o.A)((0,o.A)({},e),{},{[r]:s}))},z=async t=>{t.append("firstName",e.firstName),t.append("lastName",e.lastName),t.append("phoneNumber",e.phoneNumber),t.append("dob",e.dob),t.append("bio",e.bio||""),t.append("timezone",e.timezone||"UTC");try{const e=await(0,n.r7)(t);a(e.user),v("Profile updated successfully!");const o=JSON.parse(localStorage.getItem("userInfo"));o.avatar=e.user.avatar,localStorage.setItem("userInfo",JSON.stringify(o)),setTimeout(()=>S("/profile-overview"),2e3)}catch(o){h(o.message),setTimeout(()=>S("/profile-overview"),2e3)}finally{k(!1)}};return e||p?p?(0,c.jsxs)("div",{className:"profile-container flex-column",children:[(0,c.jsx)("h2",{className:"profile-title",children:"Edit Profile"}),p&&(0,c.jsx)("div",{className:"alert alert-danger",children:p})]}):(0,c.jsx)("div",{className:"profile-container",children:(0,c.jsxs)("div",{className:"profile-card shadow rounded",children:[(0,c.jsx)("h2",{className:"profile-title text-center mb-4",children:"Edit Profile"}),A&&(0,c.jsx)("div",{className:"loading-overlay",children:"Updating..."}),(0,c.jsxs)("form",{onSubmit:async a=>{if(a.preventDefault(),!e)return void h("No profile data available.");k(!0);const o=new FormData;if(t&&y)try{const e=await E(m,y,N),a=new File([e],t.name,{type:"image/jpeg",lastModified:Date.now()});o.append("avatar",a),await z(o)}catch(p){h("Failed to crop image: "+p.message),k(!1)}else await z(o)},children:[t?(0,c.jsxs)("div",{className:"crop-container mb-4",children:[(0,c.jsx)("div",{className:"crop-area",style:{position:"relative",height:"400px"},children:(0,c.jsx)(i.Ay,{image:m,crop:x,zoom:f,rotation:N,aspect:1,cropShape:"round",showGrid:!1,onCropChange:j,onZoomChange:b,onRotationChange:w,onCropComplete:T})}),(0,c.jsxs)("div",{className:"image-controls mb-4 mt-3",children:[(0,c.jsxs)("div",{className:"control-group",children:[(0,c.jsx)("label",{htmlFor:"zoomRange",children:"Zoom:"}),(0,c.jsx)("input",{type:"range",id:"zoomRange",min:"1",max:"3",step:"0.1",value:f,onChange:e=>b(parseFloat(e.target.value))})]}),(0,c.jsxs)("div",{className:"control-group",children:[(0,c.jsx)("label",{htmlFor:"rotateRange",children:"Rotate:"}),(0,c.jsx)("input",{type:"range",id:"rotateRange",min:"0",max:"360",step:"1",value:N,onChange:e=>w(parseInt(e.target.value,10))})]}),(0,c.jsx)("button",{type:"button",className:"btn btn-secondary mt-2",onClick:()=>{d(null),u(null),j({x:0,y:0}),b(1),w(0)},children:"Cancel Crop"})]})]}):(0,c.jsxs)("div",{className:"text-center mb-4",children:[(0,c.jsx)("label",{htmlFor:"avatarUpload",className:"profile-image-preview",children:e.avatar?(0,c.jsx)("img",{src:e.avatar,alt:"Profile",className:"rounded-circle profile-image"}):(0,c.jsx)("div",{className:"placeholder-avatar",children:e?(0,c.jsxs)(c.Fragment,{children:[e.firstName&&e.firstName[0]?e.firstName[0].toUpperCase():"",e.lastName&&e.lastName[0]?e.lastName[0].toUpperCase():""]}):null})}),(0,c.jsx)("input",{type:"file",id:"avatarUpload",accept:"image/*",onChange:e=>{const a=e.target.files[0];if(a){d(a);const e=URL.createObjectURL(a);u(e),j({x:0,y:0}),b(1),w(0)}},className:"d-none"})]}),Object.entries({firstName:"First Name",lastName:"Last Name",phoneNumber:"Phone Number",dob:"Date of Birth",bio:"Bio"}).map(a=>{let[t,o]=a;return(0,c.jsxs)("div",{className:"form-group mb-3",children:[(0,c.jsx)("label",{htmlFor:t,className:"form-label",children:o}),"bio"===t?(0,c.jsx)("textarea",{className:"form-control",id:t,name:t,value:e[t]||"",onChange:U,placeholder:"Enter your ".concat(o.toLowerCase(),"..."),rows:"4"}):(0,c.jsx)("input",{type:"dob"===t?"date":"text",className:"form-control",id:t,name:t,value:e[t]||"",onChange:U,placeholder:"Enter your ".concat(o.toLowerCase(),"..."),required:"bio"!==t&&"phoneNumber"!==t})]},t)}),(0,c.jsxs)("div",{className:"form-group mb-3",children:[(0,c.jsxs)("label",{htmlFor:"timezone",className:"form-label",children:[(0,c.jsx)("i",{className:"bi bi-globe me-2"}),"Timezone"]}),(0,c.jsxs)("select",{className:"form-control",id:"timezone",name:"timezone",value:e.timezone||"UTC",onChange:U,children:[(0,c.jsxs)("optgroup",{label:"Common Timezones",children:[(0,c.jsx)("option",{value:"UTC",children:"UTC (Coordinated Universal Time)"}),(0,c.jsx)("option",{value:"America/New_York",children:"Eastern Time (US & Canada)"}),(0,c.jsx)("option",{value:"America/Chicago",children:"Central Time (US & Canada)"}),(0,c.jsx)("option",{value:"America/Denver",children:"Mountain Time (US & Canada)"}),(0,c.jsx)("option",{value:"America/Los_Angeles",children:"Pacific Time (US & Canada)"})]}),(0,c.jsxs)("optgroup",{label:"Americas",children:[(0,c.jsx)("option",{value:"America/Anchorage",children:"Alaska"}),(0,c.jsx)("option",{value:"America/Phoenix",children:"Arizona"}),(0,c.jsx)("option",{value:"America/Toronto",children:"Toronto"}),(0,c.jsx)("option",{value:"America/Vancouver",children:"Vancouver"}),(0,c.jsx)("option",{value:"America/Sao_Paulo",children:"S\xe3o Paulo"}),(0,c.jsx)("option",{value:"America/Buenos_Aires",children:"Buenos Aires"}),(0,c.jsx)("option",{value:"America/Mexico_City",children:"Mexico City"})]}),(0,c.jsxs)("optgroup",{label:"Europe & Africa",children:[(0,c.jsx)("option",{value:"Europe/London",children:"London"}),(0,c.jsx)("option",{value:"Europe/Paris",children:"Paris"}),(0,c.jsx)("option",{value:"Europe/Berlin",children:"Berlin"}),(0,c.jsx)("option",{value:"Europe/Rome",children:"Rome"}),(0,c.jsx)("option",{value:"Europe/Madrid",children:"Madrid"}),(0,c.jsx)("option",{value:"Europe/Moscow",children:"Moscow"}),(0,c.jsx)("option",{value:"Africa/Cairo",children:"Cairo"}),(0,c.jsx)("option",{value:"Africa/Johannesburg",children:"Johannesburg"})]}),(0,c.jsxs)("optgroup",{label:"Asia",children:[(0,c.jsx)("option",{value:"Asia/Dubai",children:"Dubai"}),(0,c.jsx)("option",{value:"Asia/Kolkata",children:"India (Kolkata)"}),(0,c.jsx)("option",{value:"Asia/Bangkok",children:"Bangkok"}),(0,c.jsx)("option",{value:"Asia/Singapore",children:"Singapore"}),(0,c.jsx)("option",{value:"Asia/Shanghai",children:"China (Shanghai)"}),(0,c.jsx)("option",{value:"Asia/Tokyo",children:"Tokyo"}),(0,c.jsx)("option",{value:"Asia/Seoul",children:"Seoul"}),(0,c.jsx)("option",{value:"Asia/Hong_Kong",children:"Hong Kong"})]}),(0,c.jsxs)("optgroup",{label:"Australia & Pacific",children:[(0,c.jsx)("option",{value:"Australia/Sydney",children:"Sydney"}),(0,c.jsx)("option",{value:"Australia/Melbourne",children:"Melbourne"}),(0,c.jsx)("option",{value:"Australia/Perth",children:"Perth"}),(0,c.jsx)("option",{value:"Pacific/Auckland",children:"Auckland"}),(0,c.jsx)("option",{value:"Pacific/Fiji",children:"Fiji"})]})]}),(0,c.jsx)("small",{className:"form-text text-muted",children:"Your timezone is used for task deadline reminders via email"})]}),g&&(0,c.jsx)("div",{className:"alert alert-success",children:g}),(0,c.jsxs)("div",{className:"row mt-4",children:[(0,c.jsx)("div",{className:"col-12 col-md-6 mb-2 mb-md-0",children:(0,c.jsx)("button",{type:"button",className:"btn btn-secondary w-100",onClick:()=>S("/profile-overview"),disabled:A,children:"Cancel"})}),(0,c.jsx)("div",{className:"col-12 col-md-6",children:(0,c.jsx)("button",{type:"submit",className:"btn sign-in-btn w-100",disabled:A,children:"Save Changes"})})]})]})]})}):(0,c.jsxs)("div",{className:"profile-container",children:[(0,c.jsx)("div",{className:"loading-spinner",children:"Loading profile..."}),S("/login")]})}}}]);
//# sourceMappingURL=694.66ef6c3b.chunk.js.map