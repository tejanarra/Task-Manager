"use strict";(self.webpackChunktask_manager_frontend=self.webpackChunktask_manager_frontend||[]).push([[793],{2857:(e,s,t)=>{t.r(s),t.d(s,{default:()=>C});var a=t(2555),n=t(5043),r=t(3216),i=t(4505),l=t(8729),c=t(774),o=t(579);const d=e=>{let{setError:s,onClose:t}=e;const a=(0,r.Zp)(),[l,c]=(0,n.useState)(""),[d,m]=(0,n.useState)(!1),u=(0,n.useRef)(null);(0,n.useEffect)((()=>{u.current&&u.current.focus()}),[]);const h=async()=>{if(!l.trim())return;m(!0),s(null);const e=await(0,i.Pr)(l);if(m(!1),!e.success)return void s(e.error);const n=e.data,r={title:n.title,description:n.description,status:n.status||"not-started",deadline:n.deadline,reminders:n.reminders||[]};t(),a("/tasks/new/edit",{state:{task:r}})};return(0,o.jsxs)("div",{className:"quick-mode",children:[(0,o.jsxs)("div",{className:"quick-mode-content",children:[(0,o.jsx)("label",{className:"form-label",children:"Describe your task:"}),(0,o.jsx)("textarea",{ref:u,className:"form-control",rows:4,value:l,onChange:e=>c(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),h())},placeholder:"E.g., 'Prepare project report by Friday 5PM with reminders 1 day and 1 hour before'",disabled:d}),(0,o.jsxs)("div",{className:"quick-mode-suggestions",children:[(0,o.jsx)("small",{children:"Try these:"}),["Schedule dentist appointment next Tuesday at 3pm","Plan weekend shopping with 1 day reminder","Prepare presentation for Monday with daily reminders"].map((e=>(0,o.jsx)("button",{className:"suggestion-chip",onClick:()=>c(e),disabled:d,children:e},e)))]})]}),(0,o.jsxs)("div",{className:"modal-actions",children:[(0,o.jsx)("button",{className:"btn btn-secondary",onClick:t,disabled:d,children:"Cancel"}),(0,o.jsx)("button",{className:"btn btn-primary",onClick:h,disabled:!l.trim()||d,children:d?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"spinner-border spinner-border-sm me-2"})," ","Generating..."]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("i",{className:"bi bi-magic me-2"})," Generate Task"]})})]})]})};var m=t(7081);const u=e=>{var s,t,a,n;let{msg:r,user:i,theme:l}=e;const c=i.avatar,d=((null===(s=i.firstName)||void 0===s||null===(t=s[0])||void 0===t?void 0:t.toUpperCase())||"")+((null===(a=i.lastName)||void 0===a||null===(n=a[0])||void 0===n?void 0:n.toUpperCase())||"")||"?";return(0,o.jsxs)("div",{className:"chat-message ".concat(r.role),children:[(0,o.jsx)("div",{className:"message-avatar",children:"user"===r.role?c?(0,o.jsx)("img",{src:c,alt:"User",style:{width:"100%",height:"100%",borderRadius:"50%",objectFit:"cover"}}):(0,o.jsx)("div",{style:{width:"100%",height:"100%",borderRadius:"50%",backgroundColor:"dark"===l?"#ffffff":"#000000",color:"dark"===l?"#000000":"#ffffff",fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.85rem"},children:d}):(0,o.jsx)("i",{className:"bi bi-robot"})}),(0,o.jsx)("div",{className:"message-content",children:(0,o.jsxs)("div",{className:"message-text",children:[(0,o.jsx)("div",{className:"message-text-content",children:(e=>{if(!e)return"";return e.split(/(\d+\.\s+[^\n]+)/g).map(((e,s)=>{if(/^\d+\.\s+/.test(e)){const t=e.match(/^(\d+)\.\s+(.+)/);if(t)return(0,o.jsxs)("div",{style:{marginLeft:"0.5rem",marginTop:"0.25rem"},children:[(0,o.jsxs)("strong",{children:[t[1],"."]})," ",t[2]]},s)}const t=e.split(/(\*\*[^*]+\*\*)/g).map(((e,s)=>e.startsWith("**")&&e.endsWith("**")?(0,o.jsx)("strong",{children:e.slice(2,-2)},s):e));return(0,o.jsx)("span",{children:t},s)}))})(r.content)}),(0,o.jsxs)("div",{className:"message-time",children:[(e=>{const s=new Date(e),t=new Date,a=(t-s)/36e5;return a<24&&s.getDate()===t.getDate()?s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):a<48&&s.getDate()===t.getDate()-1?"Yesterday ".concat(s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})):s.toLocaleDateString([],{month:"short",day:"numeric"})+" "+s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})(r.timestamp),"user"===r.role&&(0,o.jsx)("i",{className:"bi bi-check-all",style:{fontSize:"0.75rem"}})]})]})})]})};t(8421);var h=t(5090),x=t(6196),b=t(1291),g=(t(2437),t(2532));const p=e=>{let{theme:s,task:t,setTasks:r,isNewTask:l=!1,onSave:c=()=>{},onCancel:d=()=>{}}=e;const[m,u]=(0,n.useState)(l),[p,j]=(0,n.useState)(t.title),[k,N]=(0,n.useState)(t.description),[f,v]=(0,n.useState)(t.status),[y,w]=(0,n.useState)(t.deadline||null),[S,C]=(0,n.useState)(Array.isArray(t.reminders)?t.reminders:[]),[A,D]=(0,n.useState)(!1),[T,E]=(0,n.useState)(!1),I=(0,n.useRef)(null);(0,n.useEffect)((()=>{Array.isArray(t.reminders)&&t.reminders.length>0&&C(t.reminders)}),[t.reminders]);const P=(0,n.useCallback)((()=>{j(t.title),N(t.description),v(t.status),w(t.deadline||null),C(Array.isArray(t.reminders)?t.reminders:[]),l?d(t.id):u(!1)}),[t.title,t.description,t.status,t.deadline,t.reminders,l,d,t.id]);(0,n.useEffect)((()=>{const e=e=>{m&&I.current&&!I.current.contains(e.target)&&P()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[m,P]);const R=(e=>{switch(e){case"completed":return"#007a00";case"in-progress":return"#daa520";default:return"#a00000"}})(t.status),L=y&&new Date(y)>new Date,O=(()=>{if(!S||0===S.length)return null;const e=S.filter((e=>"daily"===e.type)).length,s=S.filter((e=>"weekly"===e.type)).length,t=S.filter((e=>"one-time"===e.type||!e.type)).length,a=[];return e>0&&a.push("Daily (".concat(e,")")),s>0&&a.push("Weekly (".concat(s,")")),t>0&&a.push("One-time (".concat(t,")")),a.length>0?a.join(", "):null})();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{ref:I,className:"task-card ".concat("dark"===s?"dark":""," ").concat(T?"loading":""," ").concat(l?"new-task":""),onClick:()=>!m&&u(!0),children:[(0,o.jsx)("div",{className:"task-strip",style:{backgroundColor:R}}),(0,o.jsxs)("div",{className:"task-card-content",children:[!m&&(0,o.jsx)("i",{className:"bi ".concat("completed"===t.status?"bi-check-circle":"in-progress"===t.status?"bi-hourglass":"bi-ban"," status-icon"),style:{color:R}}),m?(0,o.jsxs)("div",{className:"task-form-grid",children:[(0,o.jsxs)("div",{className:"task-form-group full-width",children:[(0,o.jsx)("label",{className:"form-label",children:"Title"}),(0,o.jsx)("input",{type:"text",className:"form-control",value:p,onChange:e=>j(e.target.value),placeholder:"Enter task title..."})]}),(0,o.jsxs)("div",{className:"task-form-group full-width",children:[(0,o.jsx)("label",{className:"form-label",children:"Description"}),(0,o.jsx)("textarea",{className:"form-control",rows:3,value:k,onChange:e=>N(e.target.value),placeholder:"Enter task description..."})]}),(0,o.jsxs)("div",{className:"task-form-group",children:[(0,o.jsx)("label",{className:"form-label",children:"Status"}),(0,o.jsxs)("select",{className:"form-select",value:f,onChange:e=>v(e.target.value),children:[(0,o.jsx)("option",{value:"not-started",children:"Not Started"}),(0,o.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,o.jsx)("option",{value:"completed",children:"Completed"})]})]}),(0,o.jsxs)("div",{className:"task-form-group",children:[(0,o.jsx)("label",{className:"form-label",children:"Deadline"}),(0,o.jsx)("input",{type:"datetime-local",className:"form-control",value:y?(0,b.wM)(y):"",onChange:e=>w(e.target.value)})]}),L&&(0,o.jsx)("div",{className:"task-form-group full-width",children:(0,o.jsx)(x.A,{tempDeadline:y,tempReminders:S,setTempReminders:C,theme:s,ALL_INTERVALS:g.Ym})})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h5",{className:"task-title",style:{color:R},children:p}),(0,o.jsx)("p",{className:"task-description",children:k})]}),(0,o.jsxs)("div",{className:"task-metadata",children:[(0,o.jsxs)("div",{className:"task-metadata-item",children:[(0,o.jsx)("strong",{children:"Created"}),(0,o.jsx)("span",{children:(0,b.fw)(t.createdAt)})]}),(0,o.jsxs)("div",{className:"task-metadata-item",children:[(0,o.jsx)("strong",{children:"Deadline"}),(0,o.jsx)("span",{children:t.deadline?(0,b.fw)(t.deadline):"No deadline set"})]})]}),m&&(0,o.jsxs)("div",{className:"task-actions",children:[!l&&(0,o.jsx)("button",{className:"btn ".concat("dark"===s?"btn-outline-danger":"btn-secondary"),onClick:e=>{e.stopPropagation(),D(!0)},disabled:T,children:T?"Deleting...":"Delete"}),(0,o.jsx)("button",{className:"btn ".concat("dark"===s?"btn-outline-light":"btn-dark"),onClick:e=>{e.stopPropagation(),(async()=>{if(!p.trim()||!k.trim())return;if(E(!0),!(p!==t.title||k!==t.description||f!==t.status||y!==t.deadline||JSON.stringify(S)!==JSON.stringify(t.reminders))&&!l)return u(!1),void E(!1);const e=new Date,s=y?new Date(y):null,n=s&&s>e?(s-e)/36e5:0,o=n>0?(e=>{const s=e.some((e=>"daily"===e.type)),t=e.some((e=>"weekly"===e.type));let a=e.filter((e=>("one-time"===e.type||!e.type)&&e.remindBefore<=n));if(s&&n>0){const e=Math.floor(n/24);for(let s=1;s<=e;s++)a.push({remindBefore:24*s,sent:!1,type:"daily",dayNumber:s})}if(t&&n>0){const e=Math.floor(n/168);for(let s=1;s<=e;s++)a.push({remindBefore:24*s*7,sent:!1,type:"weekly",weekNumber:s})}return a})(S):[],d={title:p.trim(),description:k.trim(),status:f,deadline:y?s.toISOString():null,reminders:o};try{if(l)c((0,a.A)((0,a.A)({},t),d));else{const e=await(0,i.lC)(t.id,d);r((s=>s.map((s=>s.id===e.data.id?e.data:s)))),u(!1)}}catch(m){console.error("Error updating task:",m)}finally{E(!1)}})()},disabled:!p.trim()||!k.trim()||T,children:T?"Saving...":"Save"})]}),!m&&O&&(0,o.jsxs)("div",{className:"reminder-indicator",title:"Reminders: ".concat(O),children:[(0,o.jsx)("i",{className:"bi bi-clock"}),(0,o.jsx)("small",{children:O})]})]})]}),(0,o.jsx)(h.A,{theme:s,show:A,title:"Delete Task",message:"Are you sure you want to delete this task? This action cannot be undone.",onConfirm:async()=>{E(!0);try{await(0,i.vq)(t.id),r((e=>e.filter((e=>e.id!==t.id)))),D(!1)}catch(e){console.error("Error deleting task:",e)}finally{E(!1),D(!1)}},onCancel:()=>D(!1)})]})},j=g.d5.AI_CHAT_HISTORY,k=e=>{let{setError:s,theme:t,refreshTasks:r}=e;const{user:c}=(0,l.A)(),[d,h]=(0,n.useState)((()=>{try{const e=localStorage.getItem(j);return e?JSON.parse(e):[]}catch(e){return console.error("Error loading chat history:",e),[]}})),[x,b]=(0,n.useState)(""),[g,k]=(0,n.useState)(!1),[N,f]=(0,n.useState)(null),v=(0,n.useRef)(null),y=(0,n.useRef)(null);(0,n.useEffect)((()=>{y.current&&y.current.focus()}),[]),(0,n.useEffect)((()=>{var e;null===(e=v.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[d,N]),(0,n.useEffect)((()=>{try{localStorage.setItem(j,JSON.stringify(d))}catch(e){console.error("Error saving chat history:",e)}}),[d]);const w=async()=>{if(!x.trim())return;const e={role:"user",content:x.trim(),timestamp:(new Date).toISOString()};h((s=>[...s,e])),b(""),k(!0),s(null);const t=d.map((e=>({role:e.role,content:e.content}))),n=await(0,i.gQ)(e.content,t);if(k(!1),!n.success)return void s(n.error);const{reply:r,previewUpdate:l}=n.data;l&&l.reminders&&(l.reminders=(0,m.ZW)(l.reminders,l.deadline)),h((e=>[...e,{role:"assistant",content:r,timestamp:(new Date).toISOString()}])),l&&f((0,a.A)((0,a.A)({},l),{},{_aiSuggested:!0,isUpdate:"update"===l.action||"delete"===l.action,isNewTask:"create"===l.action||l.isNewTask,createdAt:l.createdAt||(new Date).toISOString(),updatedAt:(new Date).toISOString()}))},S=async e=>{try{if(!e)return;k(!0),s(null);const t=(0,m.ZW)(e.reminders||[],e.deadline);let a="";"delete"===e.action?(await(0,i.vq)(e.id),a='\ud83d\uddd1\ufe0f Deleted task "'.concat(e.title,'".')):"create"===e.action?(await(0,i.UT)({title:e.title,description:e.description,status:e.status,deadline:e.deadline,reminders:t}),a='\u2728 Created new task "'.concat(e.title,'".')):(await(0,i.lC)(e.id,{title:e.title,description:e.description,status:e.status,deadline:e.deadline,reminders:t}),a='\u2705 Updated task "'.concat(e.title,'".')),await r(),f(null),h((e=>[...e,{role:"assistant",content:a,timestamp:(new Date).toISOString()}]))}catch(t){console.error("Error applying AI update:",t),s("Failed to apply update.")}finally{k(!1)}},C=()=>f(null);return(0,o.jsxs)("div",{className:"chat-mode",children:[(0,o.jsxs)("div",{className:"chat-messages",children:[0!==d.length||N?d.map(((e,s)=>(0,o.jsx)(u,{msg:e,user:c,theme:t},s))):(0,o.jsxs)("div",{className:"chat-empty-state",children:[(0,o.jsx)("i",{className:"bi bi-chat-heart"}),(0,o.jsx)("p",{children:"Start a conversation with AI"}),(0,o.jsx)("small",{children:"Ask questions or describe your task step by step"})]}),N&&(0,o.jsxs)("div",{className:"chat-message assistant",children:[(0,o.jsx)("div",{className:"message-avatar",children:(0,o.jsx)("i",{className:"bi bi-robot"})}),(0,o.jsx)("div",{className:"message-content w-100",children:"delete"===N.action?(0,o.jsxs)("div",{className:"ai-delete-preview p-3 rounded ".concat("dark"===t?"bg-dark text-light":"bg-light text-dark"),children:[(0,o.jsxs)("h6",{className:"mb-2",children:["\ud83d\uddd1\ufe0f Confirm delete: ",(0,o.jsx)("strong",{children:N.title}),"?"]}),(0,o.jsxs)("div",{className:"d-flex gap-2",children:[(0,o.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>S(N),disabled:g,children:g?"Deleting...":"Delete"}),(0,o.jsx)("button",{className:"btn btn-secondary btn-sm",onClick:C,disabled:g,children:"Cancel"})]})]}):(0,o.jsx)(p,{theme:t,task:(0,a.A)((0,a.A)({},N),{},{title:N.title||"",description:N.description||"",reminders:Array.isArray(N.reminders)?N.reminders:[]}),isNewTask:!0,onSave:S,onCancel:C})})]}),g&&(0,o.jsxs)("div",{className:"chat-message assistant",children:[(0,o.jsx)("div",{className:"message-avatar",children:(0,o.jsx)("i",{className:"bi bi-robot"})}),(0,o.jsx)("div",{className:"message-content",children:(0,o.jsxs)("div",{className:"typing-indicator",children:[(0,o.jsx)("span",{}),(0,o.jsx)("span",{}),(0,o.jsx)("span",{})]})})]}),(0,o.jsx)("div",{ref:v})]}),(0,o.jsxs)("div",{className:"chat-input-container",children:[(0,o.jsx)("input",{ref:y,type:"text",className:"form-control",value:x,onChange:e=>b(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),w())},placeholder:"Type your message...",disabled:g}),(0,o.jsx)("button",{className:"send-button",onClick:w,disabled:!x.trim()||g,children:(0,o.jsx)("i",{className:"bi bi-send-fill"})})]}),(0,o.jsxs)("div",{className:"chat-actions",children:[(0,o.jsxs)("button",{className:"btn btn-sm btn-outline-secondary",onClick:()=>{h([]),s(null),f(null);try{localStorage.removeItem(j)}catch(e){console.error("Error clearing chat history:",e)}},disabled:g||0===d.length,children:[(0,o.jsx)("i",{className:"bi bi-arrow-clockwise me-1"})," Clear Chat"]}),(0,o.jsxs)("button",{className:"btn btn-sm btn-primary",onClick:async()=>{if(0===d.length)return void s("No conversation found to generate task from");k(!0),s(null);const e=d.map((e=>"".concat("user"===e.role?"User":"Assistant",": ").concat(e.content))).join("\n"),t="Based on this conversation, create a task:\n\n".concat(e,"\n\nCreate a detailed task with appropriate deadline and reminders."),n=await(0,i.Pr)(t);if(k(!1),!n.success)return void s(n.error);const r=n.data;f((0,a.A)((0,a.A)({},r),{},{id:"temp-".concat(Date.now()),status:r.status||"not-started",createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),priority:1,_aiSuggested:!0,isNewTask:!0,action:"create"}))},disabled:g||0===d.length,children:[(0,o.jsx)("i",{className:"bi bi-magic me-1"})," Generate Task"]})]})]})},N=e=>{let{theme:s,task:t,onClose:a,onSave:n}=e;return(0,o.jsx)("div",{className:"ai-preview-overlay",onClick:a,children:(0,o.jsxs)("div",{className:"ai-preview-modal",onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("h5",{className:"mb-3",children:[(0,o.jsx)("i",{className:"bi bi-eye"})," Task Preview"]}),(0,o.jsx)(p,{theme:s,task:t,isNewTask:!0,onSave:n,onCancel:a}),(0,o.jsx)("div",{className:"text-end mt-2",children:(0,o.jsx)("button",{className:"btn btn-secondary",onClick:a,children:"Cancel"})})]})})},f=e=>{let{show:s,onClose:t,onTaskGenerated:a,theme:r,refreshTasks:i}=e;const[l,c]=(0,n.useState)("quick"),[m,u]=(0,n.useState)(null),[h,x]=(0,n.useState)(null),[b,g]=(0,n.useState)(!1);(0,n.useEffect)((()=>{try{const e=localStorage.getItem("ai_chat_mode");!e||"quick"!==e&&"chat"!==e||c(e)}catch(h){console.error("Error loading chat mode:",h)}}),[]),(0,n.useEffect)((()=>{try{localStorage.setItem("ai_chat_mode",l)}catch(h){console.error("Error saving chat mode:",h)}}),[l]);const p=(0,n.useCallback)((()=>{g(!0),setTimeout((()=>{g(!1),x(null),t()}),250)}),[t]);(0,n.useEffect)((()=>{const e=e=>{"Escape"===e.key&&s&&!m&&p()};return s&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}}),[s,m,p]);return s||b?(0,o.jsxs)("div",{className:"ai-modal-overlay ".concat(b?"closing":""),onClick:e=>{e.target!==e.currentTarget||m||p()},children:[(0,o.jsxs)("div",{className:"ai-modal-content ".concat("dark"===r?"dark-mode":""," ").concat(b?"closing":""),onClick:e=>e.stopPropagation(),children:[(0,o.jsxs)("div",{className:"ai-modal-header",children:[(0,o.jsxs)("h3",{children:[(0,o.jsx)("i",{className:"bi bi-robot"})," AI Task Assistant"]}),(0,o.jsx)("button",{className:"close-button",onClick:p,"aria-label":"Close AI Assistant",children:(0,o.jsx)("i",{className:"bi bi-x-lg"})})]}),(0,o.jsxs)("div",{className:"ai-mode-selector",children:[(0,o.jsxs)("button",{className:"mode-button ".concat("quick"===l?"active":""),onClick:()=>c("quick"),"aria-pressed":"quick"===l,children:[(0,o.jsx)("i",{className:"bi bi-lightning-charge"})," Quick"]}),(0,o.jsxs)("button",{className:"mode-button ".concat("chat"===l?"active":""),onClick:()=>c("chat"),"aria-pressed":"chat"===l,children:[(0,o.jsx)("i",{className:"bi bi-chat-dots"})," Chat"]})]}),h&&(0,o.jsxs)("div",{className:"error-banner",children:[(0,o.jsx)("i",{className:"bi bi-exclamation-triangle"})," ",h,(0,o.jsx)("button",{onClick:()=>x(null),style:{marginLeft:"auto",background:"none",border:"none",color:"inherit",cursor:"pointer",padding:"0 4px"},"aria-label":"Dismiss error",children:(0,o.jsx)("i",{className:"bi bi-x-lg"})})]}),"quick"===l?(0,o.jsx)(d,{setError:x,setPreviewTask:u,onTaskGenerated:a,onClose:p,theme:r}):(0,o.jsx)(k,{setError:x,theme:r,refreshTasks:i,onClose:p})]}),m&&(0,o.jsx)(N,{theme:r,task:m,onClose:()=>u(null),onSave:e=>{a(e),u(null),p()}})]}):null};var v=t(3585),y=t(1648),w=t(1024);const S=e=>{let{task:s,theme:t}=e;const{attributes:n,listeners:r,setNodeRef:i,transform:l,transition:d,isDragging:m}=(0,y.gl)({id:s.id,transition:{duration:250,easing:"cubic-bezier(0.25, 0.8, 0.25, 1)"}}),u={transform:w.Ks.Transform.toString(l),transition:d||"transform 250ms cubic-bezier(0.25, 0.8, 0.25, 1)",opacity:m?0:1,cursor:"grab",touchAction:"manipulation"};return(0,o.jsx)("div",(0,a.A)((0,a.A)((0,a.A)({ref:i,style:u},n),r),{},{children:(0,o.jsx)(c.A,{theme:t,task:s})}))},C=e=>{let{theme:s}=e;const t=(0,r.Zp)(),{user:d,logout:m}=(0,l.A)(),[u,h]=(0,n.useState)(null),[x,b]=(0,n.useState)(!1),[g,p]=(0,n.useState)(null),j=(0,v.FR)((0,v.MS)(v.cA,{activationConstraint:{distance:10}}),(0,v.MS)(v.IG,{activationConstraint:{delay:200,tolerance:5}}),(0,v.MS)(v.AN,{activationConstraint:{distance:10}})),k=(0,n.useCallback)((async()=>{if(d)try{const e=await(0,i.j)();h(e.data.tasks||e.data)}catch(e){console.error("Error loading tasks:",e),e.response&&403===e.response.status&&m()}}),[d,m]);(0,n.useEffect)((()=>{k()}),[k]);if(!u)return(0,o.jsx)("div",{className:"container mt-5",children:(0,o.jsx)("div",{className:"task-container",children:(0,o.jsxs)("div",{className:"card-body p-3",children:[(0,o.jsxs)("div",{className:"d-flex flex-row justify-content-between align-items-center mb-3 header-container",children:[(0,o.jsx)("h2",{className:"card-title mb-0",children:"Your Tasks"}),(0,o.jsxs)("div",{className:"d-flex gap-2 button-group",children:[(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===s?"light":"dark"," ai-button"),disabled:!0,children:[(0,o.jsx)("i",{className:"bi bi-robot me-2"}),(0,o.jsx)("span",{className:"button-text",children:"AI Assistant"})]}),(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===s?"light":"dark"," d-flex align-items-center gap-2"),disabled:!0,children:[(0,o.jsx)("i",{className:"bi bi-plus-circle"}),(0,o.jsx)("span",{className:"button-text",children:"New Task"})]})]})]}),(0,o.jsx)("div",{className:"shimmer-list",children:Array.from({length:5}).map(((e,s)=>(0,o.jsxs)("div",{className:"shimmer-task-item",children:[(0,o.jsx)("div",{className:"shimmer-task-header"}),(0,o.jsx)("div",{className:"shimmer-task-body"})]},s)))})]})})});const N=[...u].sort(((e,s)=>e.priority-s.priority)),w=g?u.find((e=>e.id===g)):null;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"container mt-5",children:(0,o.jsx)("div",{className:"task-container",children:(0,o.jsxs)("div",{className:"card-body p-3",children:[(0,o.jsxs)("div",{className:"d-flex flex-row justify-content-between align-items-center mb-3 header-container",children:[(0,o.jsx)("h2",{className:"card-title mb-0",children:"Your Tasks"}),(0,o.jsxs)("div",{className:"d-flex gap-2 button-group",children:[(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===s?"light":"dark"," ai-button"),onClick:()=>b(!0),children:[(0,o.jsx)("i",{className:"bi bi-robot me-2"}),(0,o.jsx)("span",{className:"button-text",children:"AI Assistant"})]}),(0,o.jsxs)("button",{className:"btn btn-outline-".concat("dark"===s?"light":"dark"," d-flex align-items-center gap-2"),onClick:()=>{t("/tasks/new/edit")},children:[(0,o.jsx)("i",{className:"bi bi-plus-circle"}),(0,o.jsx)("span",{className:"button-text",children:"New Task"})]})]})]}),0===u.length?(0,o.jsxs)("div",{className:"empty-state",children:[(0,o.jsx)("i",{className:"bi bi-clipboard-check empty-state-icon"}),(0,o.jsx)("p",{className:"text-".concat("dark"===s?"light":"muted"," mb-2"),children:"No tasks yet"}),(0,o.jsx)("small",{className:"text-muted",children:"Create your first task or use AI Assistant to get started"})]}):(0,o.jsxs)(v.Mp,{sensors:j,collisionDetection:v.fp,onDragStart:e=>{p(e.active.id)},onDragEnd:async e=>{const{active:s,over:t}=e;p(null),t&&s.id!==t.id&&h((e=>{const n=e.findIndex((e=>e.id===s.id)),r=e.findIndex((e=>e.id===t.id));if(-1===n||-1===r)return e;const l=(0,y.be)(e,n,r),c=l.map(((e,s)=>{const t=s+1;return e.priority!==t?(0,i.vF)(e.id,t).catch((s=>{console.error("Error updating priority for task ".concat(e.id,":"),s)})):Promise.resolve()}));return Promise.all(c),l.map(((e,s)=>(0,a.A)((0,a.A)({},e),{},{priority:s+1})))}))},onDragCancel:()=>{p(null)},children:[(0,o.jsx)(y.gB,{items:N.map((e=>e.id)),strategy:y.kL,children:(0,o.jsx)("div",{className:"task-list",children:N.map((e=>(0,o.jsx)(S,{task:e,theme:s},e.id)))})}),(0,o.jsx)(v.Hd,{adjustScale:!1,dropAnimation:{duration:300,easing:"cubic-bezier(0.25, 0.8, 0.25, 1)"},style:{cursor:"grabbing"},children:w?(0,o.jsx)("div",{style:{transform:"scale(1.03) rotate(2deg)",cursor:"grabbing",boxShadow:"0 12px 24px rgba(0, 0, 0, 0.25), 0 4px 8px rgba(0, 0, 0, 0.15)",borderRadius:"10px",transition:"all 150ms cubic-bezier(0.25, 0.8, 0.25, 1)"},children:(0,o.jsx)(c.A,{theme:s,task:w})}):null})]})]})})}),(0,o.jsx)(f,{show:x,onClose:()=>b(!1),onTaskGenerated:e=>{t("/tasks/new/edit",{state:{task:e}})},theme:s,refreshTasks:async()=>{try{const e=await(0,i.j)(),s=e.data.tasks||e.data;return h(s),s}catch(e){console.error("Error refreshing tasks:",e)}}})]})}},774:(e,s,t)=>{t.d(s,{A:()=>c});t(5043);var a=t(3216),n=t(1291),r=t(2437),i=t(7081),l=t(579);const c=e=>{let{theme:s,task:t,demoMode:c=!1}=e;const o=(0,a.Zp)(),d=(0,r.qY)(t.status),m=(0,i.NF)(t.reminders);return(0,l.jsxs)("div",{className:"task-card ".concat("dark"===s?"dark":""),onClick:()=>{c||o("/tasks/".concat(t.id,"/edit"))},children:[(0,l.jsx)("div",{className:"task-strip",style:{backgroundColor:d}}),(0,l.jsxs)("div",{className:"task-card-content",children:[(0,l.jsx)("i",{className:"bi ".concat("completed"===t.status?"bi-check-circle":"in-progress"===t.status?"bi-hourglass":"bi-ban"," status-icon"),style:{color:d}}),(0,l.jsx)("h5",{className:"task-title",style:{color:d},children:t.title}),(0,l.jsx)("p",{className:"task-description",children:t.description}),(0,l.jsxs)("div",{className:"task-metadata",children:[(0,l.jsxs)("div",{className:"task-metadata-item",children:[(0,l.jsx)("strong",{children:"Created"}),(0,l.jsx)("span",{children:(0,n.fw)(t.createdAt)})]}),(0,l.jsxs)("div",{className:"task-metadata-item",children:[(0,l.jsx)("strong",{children:"Deadline"}),(0,l.jsx)("span",{children:t.deadline?(0,n.fw)(t.deadline):"No deadline set"})]})]}),m&&(0,l.jsxs)("div",{className:"reminder-indicator",title:"Reminders: ".concat(m),children:[(0,l.jsx)("i",{className:"bi bi-clock"}),(0,l.jsx)("small",{children:m})]})]})]})}}}]);
//# sourceMappingURL=793.795ee5f2.chunk.js.map