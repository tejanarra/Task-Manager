"use strict";(self.webpackChunktask_manager_frontend=self.webpackChunktask_manager_frontend||[]).push([[326],{6800:(e,s,a)=>{a.r(s),a.d(s,{default:()=>u});var t=a(2555),r=a(5043),l=a(3216),i=a(4505),n=a(6196),o=a(5090),c=a(1291),d=a(2532),m=a(579);const u=e=>{let{theme:s}=e;const a=(0,l.Zp)(),{taskId:u}=(0,l.g)(),h="new"===u,[b,p]=(0,r.useState)(""),[x,j]=(0,r.useState)(""),[N,k]=(0,r.useState)("not-started"),[f,v]=(0,r.useState)(null),[g,y]=(0,r.useState)([]),[w,C]=(0,r.useState)(!1),[S,T]=(0,r.useState)(!1),[A,D]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{if(!h)try{C(!0);const e=(await(0,i.iV)(u)).data;e?(p(e.title),j(e.description),k(e.status),v(e.deadline||null),y(Array.isArray(e.reminders)?e.reminders:[])):(D("Task not found"),setTimeout(()=>a("/tasks"),2e3))}catch(e){console.error("Error loading task:",e),D("Failed to load task")}finally{C(!1)}})()},[u,h,a]),(0,r.useEffect)(()=>{var e;const s=null===(e=window.history.state)||void 0===e?void 0:e.usr;if(null!==s&&void 0!==s&&s.task){const e=s.task;p(e.title||""),j(e.description||""),k(e.status||"not-started"),v(e.deadline||null),y(Array.isArray(e.reminders)?e.reminders:[])}},[]);const E=()=>{a("/tasks")},F=()=>{switch(N){case"completed":return"#007a00";case"in-progress":return"#daa520";default:return"#a00000"}},q=f&&new Date(f)>new Date;return w&&!h?(0,m.jsx)("div",{className:"container mt-5",children:(0,m.jsxs)("div",{className:"task-editor-container",style:{position:"relative"},children:[(0,m.jsx)("div",{className:"editor-spine"}),(0,m.jsxs)("div",{className:"loading-state",children:[(0,m.jsx)("div",{className:"spinner-border",role:"status",children:(0,m.jsx)("span",{className:"visually-hidden",children:"Loading..."})}),(0,m.jsx)("p",{children:"Loading task..."})]})]})}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:"container mt-5",children:(0,m.jsxs)("div",{className:"task-editor-container ".concat("dark"===s?"dark":""),style:{position:"relative"},children:[(0,m.jsx)("div",{className:"editor-spine",style:{backgroundColor:F()}}),(0,m.jsxs)("div",{className:"editor-header",children:[(0,m.jsx)("button",{className:"back-button",onClick:E,disabled:w,"aria-label":"Go back to task list",children:(0,m.jsx)("i",{className:"bi bi-arrow-left","aria-hidden":"true"})}),(0,m.jsx)("h2",{children:h?"Create New Task":"Edit Task"}),(0,m.jsx)("i",{className:"bi ".concat("completed"===N?"bi-check-circle-fill":"in-progress"===N?"bi-hourglass-split":"bi-circle"," status-icon-header"),style:{color:F()}})]}),A&&(0,m.jsxs)("div",{className:"alert alert-danger",role:"alert",children:[(0,m.jsx)("i",{className:"bi bi-exclamation-triangle me-2"}),A]}),(0,m.jsxs)("div",{className:"editor-form",children:[(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsxs)("label",{className:"form-label",children:[(0,m.jsx)("i",{className:"bi bi-pencil-square me-1"}),"Title ",(0,m.jsx)("span",{className:"required",children:"*"})]}),(0,m.jsx)("input",{type:"text",className:"form-control",value:b,onChange:e=>p(e.target.value),placeholder:"Enter task title...",disabled:w})]}),(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsxs)("label",{className:"form-label",children:[(0,m.jsx)("i",{className:"bi bi-text-paragraph me-1"}),"Description ",(0,m.jsx)("span",{className:"required",children:"*"})]}),(0,m.jsx)("textarea",{className:"form-control",rows:5,value:x,onChange:e=>j(e.target.value),placeholder:"Enter task description...",disabled:w})]}),(0,m.jsxs)("div",{className:"form-row",children:[(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsxs)("label",{className:"form-label",children:[(0,m.jsx)("i",{className:"bi bi-flag me-1"}),"Status"]}),(0,m.jsxs)("select",{className:"form-select",value:N,onChange:e=>k(e.target.value),disabled:w,style:{color:F()},children:[(0,m.jsx)("option",{value:"not-started",children:"Not Started"}),(0,m.jsx)("option",{value:"in-progress",children:"In Progress"}),(0,m.jsx)("option",{value:"completed",children:"Completed"})]})]}),(0,m.jsxs)("div",{className:"form-group",children:[(0,m.jsxs)("label",{className:"form-label",children:[(0,m.jsx)("i",{className:"bi bi-calendar-event me-1"}),"Deadline"]}),(0,m.jsx)("input",{type:"datetime-local",className:"form-control",value:f?(0,c.wM)(f):"",onChange:e=>v(e.target.value),disabled:w})]})]}),q&&(0,m.jsxs)("div",{className:"form-group reminders-section",children:[(0,m.jsxs)("label",{className:"form-label",children:[(0,m.jsx)("i",{className:"bi bi-clock-history me-1"}),"Reminders"]}),(0,m.jsx)(n.A,{tempDeadline:f,tempReminders:g,setTempReminders:y,theme:s,ALL_INTERVALS:d.Ym})]})]}),(0,m.jsxs)("div",{className:"editor-actions",children:[!h&&(0,m.jsxs)("button",{className:"btn btn-danger",onClick:()=>T(!0),disabled:w,children:[(0,m.jsx)("i",{className:"bi bi-trash me-2"}),"Delete Task"]}),(0,m.jsxs)("div",{className:"action-group",children:[(0,m.jsx)("button",{className:"btn btn-secondary",onClick:E,disabled:w,children:"Cancel"}),(0,m.jsx)("button",{className:"btn btn-primary",onClick:async()=>{if(!b.trim()||!x.trim())return void D("Title and description are required");C(!0),D(null);const e=new Date,s=f?new Date(f):null,r=s&&s>e?(s-e)/36e5:0,l=r>0?(e=>{const s=e.some(e=>"daily"===e.type),a=e.some(e=>"weekly"===e.type);let t=e.filter(e=>("one-time"===e.type||!e.type)&&e.remindBefore<=r);if(s&&r>0){const e=Math.floor(r/24);for(let s=1;s<=e;s++)t.push({remindBefore:24*s,sent:!1,type:"daily",dayNumber:s})}if(a&&r>0){const e=Math.floor(r/168);for(let s=1;s<=e;s++)t.push({remindBefore:24*s*7,sent:!1,type:"weekly",weekNumber:s})}return t})(g):[],n={title:b.trim(),description:x.trim(),status:N,deadline:f?s.toISOString():null,reminders:l};try{h?await(0,i.UT)((0,t.A)((0,t.A)({},n),{},{priority:1})):await(0,i.lC)(u,n),a("/tasks")}catch(A){console.error("Error saving task:",A),D("Failed to save task. Please try again.")}finally{C(!1)}},disabled:!b.trim()||!x.trim()||w,children:w?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("span",{className:"spinner-border spinner-border-sm me-2"}),"Saving..."]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("i",{className:"bi bi-check-lg me-2"}),h?"Create Task":"Save Changes"]})})]})]})]})}),(0,m.jsx)(o.A,{theme:s,show:S,title:"Delete Task",message:"Are you sure you want to delete this task? This action cannot be undone.",onConfirm:async()=>{C(!0);try{await(0,i.vq)(u),a("/tasks")}catch(A){console.error("Error deleting task:",A),D("Failed to delete task"),C(!1),T(!1)}},onCancel:()=>T(!1)})]})}},8421:()=>{}}]);
//# sourceMappingURL=326.3ab46d97.chunk.js.map